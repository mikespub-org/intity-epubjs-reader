{"version":3,"file":"js/epubreader.min.js","mappings":"uDAEA,IAAIA,EAAkB,EAAQ,KAC1BC,EAAkB,EAAQ,KAC1BC,EAAkB,EAAQ,KAC1BC,EAAkB,EAAQ,KAC1BC,EAAkB,EAAQ,MAErBC,EAAOC,QAAU,SAAUC,EAAMC,GACzC,IAAIC,EAAGC,EAAGC,EAAGC,EAASC,EAkBtB,OAjBIC,UAAUC,OAAS,GAAqB,iBAATR,GAClCK,EAAUJ,EACVA,EAAQD,EACRA,EAAO,MAEPK,EAAUE,UAAU,GAEjBd,EAAQO,IACXE,EAAIL,EAASY,KAAKT,EAAM,KACxBG,EAAIN,EAASY,KAAKT,EAAM,KACxBI,EAAIP,EAASY,KAAKT,EAAM,OAExBE,EAAIE,GAAI,EACRD,GAAI,GAGLG,EAAO,CAAEL,MAAOA,EAAOS,aAAcR,EAAGS,WAAYR,EAAGS,SAAUR,GACzDC,EAAiBV,EAAOC,EAAcS,GAAUC,GAAtCA,CACnB,GAEEO,GAAK,SAAUb,EAAMc,EAAKC,GAC3B,IAAIb,EAAGC,EAAGE,EAASC,EA6BnB,MA5BoB,iBAATN,GACVK,EAAUU,EACVA,EAAMD,EACNA,EAAMd,EACNA,EAAO,MAEPK,EAAUE,UAAU,GAEhBd,EAAQqB,GAEDpB,EAAgBoB,GAGhBrB,EAAQsB,GAERrB,EAAgBqB,KAC3BV,EAAUU,EACVA,OAAMC,GAHND,OAAMC,GAHNX,EAAUS,EACVA,EAAMC,OAAMC,GAHZF,OAAME,EAUHvB,EAAQO,IACXE,EAAIL,EAASY,KAAKT,EAAM,KACxBG,EAAIN,EAASY,KAAKT,EAAM,OAExBE,GAAI,EACJC,GAAI,GAGLG,EAAO,CAAEQ,IAAKA,EAAKC,IAAKA,EAAKL,aAAcR,EAAGS,WAAYR,GAClDE,EAAiBV,EAAOC,EAAcS,GAAUC,GAAtCA,CACnB,C,SC1DAR,EAAOC,QAAU,WAAa,C,gBCD9BD,EAAOC,QAAU,EAAQ,IAAR,GAAgCkB,OAAOtB,OAAS,EAAQ,I,UCAzEG,EAAOC,QAAU,WAChB,IAA4BmB,EAAxBvB,EAASsB,OAAOtB,OACpB,MAAsB,mBAAXA,IAEXA,EADAuB,EAAM,CAAEC,IAAK,OACD,CAAEC,IAAK,OAAS,CAAEC,KAAM,SAC7BH,EAAIC,IAAMD,EAAIE,IAAMF,EAAIG,OAAS,aACzC,C,gBCNA,IAAIC,EAAQ,EAAQ,IAChBrB,EAAQ,EAAQ,KAChBsB,EAAQC,KAAKD,IAEjBzB,EAAOC,QAAU,SAAU0B,EAAMC,GAChC,IAAIC,EAAOC,EAAsCjC,EAAnCa,EAASe,EAAIhB,UAAUC,OAAQ,GAS7C,IARAiB,EAAOR,OAAOhB,EAAMwB,IACpB9B,EAAS,SAAUkC,GAClB,IACCJ,EAAKI,GAAOH,EAAIG,EACjB,CAAE,MAAO1B,GACHwB,IAAOA,EAAQxB,EACrB,CACD,EACKyB,EAAI,EAAGA,EAAIpB,IAAUoB,EAEzBN,EADAI,EAAMnB,UAAUqB,IACNE,QAAQnC,GAEnB,QAAcqB,IAAVW,EAAqB,MAAMA,EAC/B,OAAOF,CACR,C,gBCpBA,IAAIM,EAAa,EAAQ,GAAR,GAEjBjC,EAAOC,QAAU,SAAUiC,GAAO,OAAOA,IAAQD,GAAsB,OAARC,CAAc,C,eCF7ElC,EAAOC,QAAU,EAAQ,IAAR,GAAgCkB,OAAOK,KAAO,EAAQ,I,UCAvExB,EAAOC,QAAU,WAChB,IAEC,OADAkB,OAAOK,KAAK,cACL,CACR,CAAE,MAAOnB,GACR,OAAO,CACR,CACD,C,gBCPA,IAAIV,EAAU,EAAQ,KAElB6B,EAAOL,OAAOK,KAElBxB,EAAOC,QAAU,SAAUkC,GAAU,OAAOX,EAAK7B,EAAQwC,GAAUhB,OAAOgB,GAAUA,EAAS,C,gBCJ7F,IAAIxC,EAAU,EAAQ,KAElBqC,EAAUI,MAAMC,UAAUL,QAASM,EAASnB,OAAOmB,OAQvDtC,EAAOC,QAAU,SAAUsC,GAC1B,IAAIC,EAASF,EAAO,MAKpB,OAJAN,EAAQrB,KAAKF,WAAW,SAAUF,GAC5BZ,EAAQY,IATD,SAAUqB,EAAKR,GAC5B,IAAIW,EACJ,IAAKA,KAAOH,EAAKR,EAAIW,GAAOH,EAAIG,EACjC,CAOEU,CAAQtB,OAAOZ,GAAUiC,EAC1B,IACOA,CACR,C,UCjBAxC,EAAOC,QAAU,SAAUyC,GAC1B,GAAkB,mBAAPA,EAAmB,MAAM,IAAIC,UAAUD,EAAK,sBACvD,OAAOA,CACR,C,gBCHA,IAAI/C,EAAU,EAAQ,KAEtBK,EAAOC,QAAU,SAAUE,GAC1B,IAAKR,EAAQQ,GAAQ,MAAM,IAAIwC,UAAU,gCACzC,OAAOxC,CACR,C,gBCLAH,EAAOC,QAAU,EAAQ,IAAR,GAAgC2C,OAAOP,UAAUtC,SAAW,EAAQ,I,UCArF,IAAI8C,EAAM,aAEV7C,EAAOC,QAAU,WAChB,MAA4B,mBAAjB4C,EAAI9C,WACgB,IAAxB8C,EAAI9C,SAAS,SAA2C,IAAxB8C,EAAI9C,SAAS,MACrD,C,UCLA,IAAI+C,EAAUF,OAAOP,UAAUS,QAE/B9C,EAAOC,QAAU,SAAU8C,GAC1B,OAAOD,EAAQnC,KAAKqC,KAAMD,EAActC,UAAU,KAAO,CAC1D,C,eCJA,IASIwC,EAAIC,EAAMC,EAAKC,EAAMC,EAASC,EAAaC,EAT3CC,EAAW,EAAQ,KACnBC,EAAW,EAAQ,KAEnBC,EAAQC,SAAStB,UAAUqB,MAAO/C,EAAOgD,SAAStB,UAAU1B,KAC5D2B,EAASnB,OAAOmB,OAAQsB,EAAiBzC,OAAOyC,eAChDC,EAAmB1C,OAAO0C,iBAC1BC,EAAiB3C,OAAOkB,UAAUyB,eAClCC,EAAa,CAAEnD,cAAc,EAAMC,YAAY,EAAOC,UAAU,GAuBpEoC,EAAO,SAAUc,EAAMC,GACtB,IAAIf,EAAMgB,EAUV,OARAT,EAASQ,GACTC,EAAOlB,KACPC,EAAGtC,KAAKqC,KAAMgB,EAAMd,EAAO,WAC1BC,EAAIxC,KAAKuD,EAAMF,EAAMd,GACrBQ,EAAM/C,KAAKsD,EAAUjB,KAAMvC,UAC5B,GAEAyC,EAAKiB,mBAAqBF,EACnBjB,IACR,EAoEAK,EAAU,CACTJ,GApGDA,EAAK,SAAUe,EAAMC,GACpB,IAAIG,EAeJ,OAbAX,EAASQ,GAEJH,EAAenD,KAAKqC,KAAM,UAK9BoB,EAAOpB,KAAKqB,QAJZD,EAAOL,EAAW5D,MAAQmC,EAAO,MACjCsB,EAAeZ,KAAM,SAAUe,GAC/BA,EAAW5D,MAAQ,MAIfiE,EAAKJ,GACqB,iBAAfI,EAAKJ,GAAoBI,EAAKJ,GAAMM,KAAKL,GACpDG,EAAKJ,GAAQ,CAACI,EAAKJ,GAAOC,GAFdG,EAAKJ,GAAQC,EAIvBjB,IACR,EAoFCE,KAAMA,EACNC,IArEDA,EAAM,SAAUa,EAAMC,GACrB,IAAIG,EAAMG,EAAWC,EAAW1C,EAIhC,GAFA2B,EAASQ,IAEJH,EAAenD,KAAKqC,KAAM,UAAW,OAAOA,KAEjD,KADAoB,EAAOpB,KAAKqB,QACFL,GAAO,OAAOhB,KAGxB,GAAyB,iBAFzBuB,EAAYH,EAAKJ,IAGhB,IAAKlC,EAAI,EAAI0C,EAAYD,EAAUzC,KAAOA,EACpC0C,IAAcP,GAChBO,EAAUL,qBAAuBF,IACV,IAArBM,EAAU7D,OAAc0D,EAAKJ,GAAQO,EAAUzC,EAAI,EAAI,GACtDyC,EAAUE,OAAO3C,EAAG,SAItByC,IAAcN,GAChBM,EAAUJ,qBAAuBF,UAC5BG,EAAKJ,GAId,OAAOhB,IACR,EA4CCI,KA1CDA,EAAO,SAAUY,GAChB,IAAIlC,EAAG4C,EAAGT,EAAUM,EAAWI,EAE/B,GAAKb,EAAenD,KAAKqC,KAAM,YAC/BuB,EAAYvB,KAAKqB,OAAOL,IAGxB,GAAyB,iBAAdO,EAAwB,CAGlC,IAFAG,EAAIjE,UAAUC,OACdiE,EAAO,IAAIvC,MAAMsC,EAAI,GAChB5C,EAAI,EAAGA,EAAI4C,IAAK5C,EAAG6C,EAAK7C,EAAI,GAAKrB,UAAUqB,GAGhD,IADAyC,EAAYA,EAAUK,QACjB9C,EAAI,EAAImC,EAAWM,EAAUzC,KAAOA,EACxC4B,EAAM/C,KAAKsD,EAAUjB,KAAM2B,EAE7B,MACC,OAAQlE,UAAUC,QAClB,KAAK,EACJC,EAAKA,KAAK4D,EAAWvB,MACrB,MACD,KAAK,EACJrC,EAAKA,KAAK4D,EAAWvB,KAAMvC,UAAU,IACrC,MACD,KAAK,EACJE,EAAKA,KAAK4D,EAAWvB,KAAMvC,UAAU,GAAIA,UAAU,IACnD,MACD,QAGC,IAFAiE,EAAIjE,UAAUC,OACdiE,EAAO,IAAIvC,MAAMsC,EAAI,GAChB5C,EAAI,EAAGA,EAAI4C,IAAK5C,EACpB6C,EAAK7C,EAAI,GAAKrB,UAAUqB,GAEzB4B,EAAM/C,KAAK4D,EAAWvB,KAAM2B,GAG/B,GASArB,EAAc,CACbL,GAAIO,EAAEP,GACNC,KAAMM,EAAEN,GACRC,IAAKK,EAAEL,GACPC,KAAMI,EAAEJ,IAGTG,EAAOM,EAAiB,CAAC,EAAGP,GAE5BtD,EAAOC,QAAUA,EAAU,SAAU4E,GACpC,OAAa,MAALA,EAAavC,EAAOiB,GAAQM,EAAiB1C,OAAO0D,GAAIvB,EACjE,EACArD,EAAQoD,QAAUA,C,eCjIlB,IAAIyB,EAAc,EAAQ,KAE1B9E,EAAOC,QAAU,SAAUE,GAC1B,GAAqB,mBAAVA,EAAsB,OAAO,EAExC,IAAK2D,eAAenD,KAAKR,EAAO,UAAW,OAAO,EAElD,IACC,GAA4B,iBAAjBA,EAAMO,OAAqB,OAAO,EAC7C,GAA0B,mBAAfP,EAAMQ,KAAqB,OAAO,EAC7C,GAA2B,mBAAhBR,EAAMuD,MAAsB,OAAO,CAC/C,CAAE,MAAO7B,GACR,OAAO,CACR,CAEA,OAAQiD,EAAY3E,EACrB,C,gBChBA,IAAIR,EAAU,EAAQ,KAGlBoF,EAAgB,CAAE,QAAU,EAAM,UAAY,EAAM,WAAa,GAErE/E,EAAOC,QAAU,SAAUE,GAC1B,QAAKR,EAAQQ,IACN2D,eAAenD,KAAKoE,SAAsB5E,EAClD,C,gBCRA,IAAI6E,EAAa,EAAQ,IAErBC,EAAU,mBAAoBC,EAAmBvB,SAAStB,UAAU8C,SAExEnF,EAAOC,QAAU,SAAUE,GAC1B,QAAK6E,EAAW7E,KACZ8E,EAAQG,KAAKF,EAAiBvE,KAAKR,GAExC,C,gBCRA,IAAIkF,EAAW,EAAQ,KAEvBrF,EAAOC,QAAU,SAAUE,GAC1B,IAAKkF,EAASlF,GAAQ,OAAO,EAC7B,IACC,QAAKA,EAAMmF,aACJnF,EAAMmF,YAAYjD,YAAclC,CACxC,CAAE,MAAO0B,GACR,OAAO,CACR,CACD,C,UCPA7B,EAAOC,QAAU,SAAUE,GAAS,OAAOA,OAAwC,C,GCJ/EoF,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBvE,IAAjBwE,EACH,OAAOA,EAAazF,QAGrB,IAAID,EAASuF,EAAyBE,GAAY,CAGjDxF,QAAS,CAAC,GAOX,OAHA0F,EAAoBF,GAAUzF,EAAQA,EAAOC,QAASuF,GAG/CxF,EAAOC,OACf,CCrBAuF,EAAoBI,EAAK5F,IACxB,IAAI6F,EAAS7F,GAAUA,EAAO8F,WAC7B,IAAO9F,EAAiB,QACxB,IAAM,EAEP,OADAwF,EAAoBhC,EAAEqC,EAAQ,CAAEE,EAAGF,IAC5BA,CAAM,ECLdL,EAAoBhC,EAAI,CAACvD,EAAS+F,KACjC,IAAI,IAAIjE,KAAOiE,EACXR,EAAoBX,EAAEmB,EAAYjE,KAASyD,EAAoBX,EAAE5E,EAAS8B,IAC5EZ,OAAOyC,eAAe3D,EAAS8B,EAAK,CAAElB,YAAY,EAAMG,IAAKgF,EAAWjE,IAE1E,ECNDyD,EAAoBX,EAAI,CAACzD,EAAK6E,IAAU9E,OAAOkB,UAAUyB,eAAenD,KAAKS,EAAK6E,GCClFT,EAAoBU,EAAKjG,IACH,oBAAXkG,QAA0BA,OAAOC,aAC1CjF,OAAOyC,eAAe3D,EAASkG,OAAOC,YAAa,CAAEjG,MAAO,WAE7DgB,OAAOyC,eAAe3D,EAAS,aAAc,CAAEE,OAAO,GAAO,E,+DCL9D,MAAMqD,EAAI,CAACpC,EAAK6E,IAAS7E,EAAMA,EAAI6E,QAAQ/E,EAErCmF,EAAI,CAACzE,EAAK0E,EAAKC,EAAKN,KACtB,IAAI/D,EACJ,GAAyB,kBAAdoE,EAAIL,GACX,OAAQA,GACJ,IAAK,cACL,IAAK,YACD/D,EAAMoE,EAAIL,GAAQrE,EAAIqE,GAAQK,EAAIL,GAClC,MACJ,QACI/D,EAAMoE,EAAIL,QAIlB/D,EADgB,WAAT+D,EACDK,EAAIL,QAEa/E,IAAjBsC,EAAE+C,EAAKN,GAAsBrE,EAAIqE,GAAQK,EAAIL,GAEvD,OAAO/D,GAGEsE,EAAS,CAAC5E,EAAK0E,EAAKC,KAC7B,IAAK,IAAIN,KAAQrE,EACA,aAATqE,IAEOK,EAAIL,aAAiB7D,MAC5BkE,EAAIL,GAAQM,EAAO3E,EAAIqE,GAAQrE,EAAIqE,GAAQK,EAAIL,GAASrE,EAAIqE,GACrDK,EAAIL,aAAiB9E,OAC5BqF,EAAO5E,EAAIqE,GAAOK,EAAIL,GAAOzC,EAAE+C,EAAKN,IAEpCK,EAAIL,GAAQM,EAAMF,EAAEzE,EAAK0E,EAAKC,EAAKN,GAAQrE,EAAIqE,GAEvD,EAGSQ,EAAO,KAChB,IAAIjD,GAAI,IAAIkD,MAAOC,UAMnB,MALa,uCAAuCC,QAAQ,SAAUxG,IAClE,IAAI8F,GAAK1C,EAAoB,GAAhB9B,KAAKmF,UAAiB,GAAK,EAExC,OADArD,EAAI9B,KAAKoF,MAAMtD,EAAI,KACL,MAANpD,EAAY8F,EAAS,EAAJA,EAAU,GAAMf,SAAS,GAAE,GAEjDsB,EC3CJ,MAAMM,EAEZ,WAAAzB,CAAY0B,GAEXhE,KAAKiE,SAAWD,EAAOE,SAASD,UAAY,KAC5CjE,KAAKmE,OAAS,CACbC,GAAI,CACH,kBAAmB,UACnB,eAAgB,gBAChB,eAAgB,YAChB,mBAAoB,YACpB,yBAA0B,+HAC1B,mBAAoB,6BACpB,qBAAsB,aAEtB,gBAAiB,gBACjB,mBAAoB,WACpB,oBAAqB,YACrB,wBAAyB,MACzB,2BAA4B,SAC5B,0BAA2B,QAC3B,sBAAuB,cACvB,0BAA2B,MAC3B,6BAA8B,SAC9B,4BAA6B,QAC7B,6BAA8B,SAC9B,6BAA8B,SAC9B,iBAAkB,SAClB,6BAA8B,SAC9B,mBAAoB,WACpB,4BAA6B,WAC7B,4BAA6B,gBAC7B,0BAA2B,SAC3B,8BAA+B,CAAC,aAAc,uBAC9C,0BAA2B,SAC3B,mCAAoC,uBACpC,mBAAoB,WACpB,2BAA4B,UAC5B,+BAAgC,cAChC,8BAA+B,aAC/B,4BAA6B,WAC7B,2BAA4B,UAC5B,6BAA8B,YAC9B,yBAA0B,QAE1B,gBAAiB,OACjB,cAAe,OAEhBC,GAAI,CACH,kBAAmB,iBACnB,eAAgB,MAChB,eAAgB,MAChB,mBAAoB,wBACpB,yBAA0B,wJAC1B,mBAAoB,6BACpB,qBAAsB,cAEtB,gBAAiB,MACjB,mBAAoB,WACpB,oBAAqB,eACrB,wBAAyB,UACzB,2BAA4B,UAC5B,0BAA2B,eAC3B,sBAAuB,cACvB,0BAA2B,UAC3B,6BAA8B,UAC9B,4BAA6B,eAC7B,6BAA8B,QAC9B,6BAA8B,UAC9B,iBAAkB,aAClB,6BAA8B,aAC9B,mBAAoB,WACpB,4BAA6B,SAC7B,4BAA6B,MAC7B,0BAA2B,MAC3B,8BAA+B,CAAC,aAAc,0BAC9C,0BAA2B,MAC3B,mCAAoC,MACpC,mBAAoB,MACpB,2BAA4B,MAC5B,+BAAgC,MAChC,8BAA+B,MAC/B,4BAA6B,SAC7B,2BAA4B,MAC5B,6BAA8B,MAC9B,yBAA0B,MAE1B,gBAAiB,MACjB,cAAe,WAEhBC,GAAI,CACH,kBAAmB,QACnB,eAAgB,MAChB,eAAgB,MAChB,mBAAoB,OACpB,yBAA0B,kFAC1B,mBAAoB,eACpB,qBAAsB,UAEtB,gBAAiB,MACjB,mBAAoB,KACpB,oBAAqB,IACrB,wBAAyB,KACzB,2BAA4B,KAC5B,0BAA2B,MAC3B,sBAAuB,KACvB,0BAA2B,KAC3B,2BAA4B,KAC5B,4BAA6B,MAC7B,6BAA8B,OAC9B,6BAA8B,QAC9B,iBAAkB,KAClB,6BAA8B,KAC9B,mBAAoB,KACpB,4BAA6B,OAC7B,4BAA6B,MAC7B,0BAA2B,MAC3B,8BAA+B,CAAC,WAAY,mBAC5C,0BAA2B,MAC3B,mCAAoC,MACpC,mBAAoB,MACpB,2BAA4B,MAC5B,+BAAgC,MAChC,8BAA+B,MAC/B,4BAA6B,OAC7B,2BAA4B,MAC5B,6BAA8B,MAC9B,yBAA0B,MAE1B,gBAAiB,MACjB,cAAe,MAEhBC,GAAI,CACH,kBAAmB,iBACnB,eAAgB,sBAChB,eAAgB,oBAChB,mBAAoB,gBACpB,yBAA0B,8IAC1B,mBAAoB,mCACpB,qBAAsB,sBAEtB,gBAAiB,yBACjB,mBAAoB,aACpB,oBAAqB,WACrB,wBAAyB,WACzB,2BAA4B,UAC5B,0BAA2B,WAC3B,sBAAuB,YACvB,0BAA2B,WAC3B,6BAA8B,UAC9B,4BAA6B,WAC7B,6BAA8B,QAC9B,6BAA8B,SAC9B,iBAAkB,QAClB,6BAA8B,QAC9B,mBAAoB,YACpB,4BAA6B,OAC7B,4BAA6B,gBAC7B,0BAA2B,QAC3B,8BAA+B,CAAC,oBAAqB,kCACrD,0BAA2B,WAC3B,mCAAoC,sBACpC,mBAAoB,aACpB,2BAA4B,QAC5B,+BAAgC,WAChC,8BAA+B,gBAC/B,4BAA6B,OAC7B,2BAA4B,kBAC5B,6BAA8B,WAC9B,yBAA0B,YAE1B,gBAAiB,UACjB,cAAe,aAIjBP,EAAO/D,GAAG,mBAAoB9C,IAC7B6C,KAAKiE,SAAW9G,CAAK,GAEvB,CAEA,GAAAa,CAAIe,GAAO,OAAOiB,KAAKmE,OAAOnE,KAAKiE,UAAUlF,IAAQ,KAAO,ECjL7D,MAAMyF,EAAY,mCAMX,MAAMC,EAEZ,WAAAnC,CAAYoC,GAEX1E,KAAK2E,IAAMC,SAASC,cAAcH,EACnC,CAEA,GAAAI,GAEC,IAAK,IAAIhG,EAAI,EAAGA,EAAIrB,UAAUC,OAAQoB,IAAK,CAE1C,MAAMiG,EAAWtH,UAAUqB,GAE3B,GAAIiG,aAAoBN,EAEvBzE,KAAK2E,IAAIK,YAAYD,EAASJ,UAExB,GAAIvF,MAAM6F,QAAQF,GAExB,IAAK,IAAIG,EAAI,EAAGA,EAAIH,EAASrH,OAAQwH,IAAK,CAEzC,MAAMC,EAAUJ,EAASG,GAErBC,aAAmBV,EAEtBzE,KAAK2E,IAAIK,YAAYG,EAAQR,KAG7BS,QAAQvG,MAAM,aAAcsG,EAASX,EAEvC,MAGAY,QAAQvG,MAAM,aAAckG,EAAUP,EAExC,CACA,OAAOxE,IACR,CAEA,MAAAqF,GAEC,IAAK,IAAIvG,EAAI,EAAGA,EAAIrB,UAAUC,OAAQoB,IAAK,CAE1C,MAAMiG,EAAWtH,UAAUqB,GAEvBiG,aAAoBN,EAEvBzE,KAAK2E,IAAIW,YAAYP,EAASJ,KAEpBY,OAAOC,UAAUT,GAE3B/E,KAAK2E,IAAIW,YAAYtF,KAAK2E,IAAIc,WAAWV,IAGzCK,QAAQvG,MAAM,aAAckG,EAAUP,EAExC,CACA,OAAOxE,IACR,CAEA,KAAA0F,GAEC,KAAO1F,KAAK2E,IAAIgB,SAASjI,QAExBsC,KAAK2E,IAAIW,YAAYtF,KAAK2E,IAAIiB,WAE/B,OAAO5F,IACR,CAEA,KAAA6F,CAAMC,GAGL,OADA9F,KAAK2E,IAAImB,GAAKA,EACP9F,IACR,CAEA,KAAA+F,GAEC,OAAO/F,KAAK2E,IAAImB,EACjB,CAEA,eAAAE,CAAgBC,GAGf,OADAjG,KAAK2E,IAAIqB,gBAAgBC,GAClBjG,IACR,CAEA,QAAAkG,CAASD,GAGR,OADAjG,KAAK2E,IAAIwB,UAAYF,EACdjG,IACR,CAEA,QAAAoG,CAASH,GAGR,OADAjG,KAAK2E,IAAI0B,UAAUvB,IAAImB,GAChBjG,IACR,CAEA,WAAAsG,CAAYL,GAGX,OADAjG,KAAK2E,IAAI0B,UAAUhB,OAAOY,GACnBjG,IACR,CAEA,QAAAuG,CAASxH,EAAK5B,GAGb,OADA6C,KAAK2E,IAAI6B,MAAMzH,GAAO5B,EACf6C,IACR,CAEA,QAAAyG,GAEC,OAAOzG,KAAK2E,IAAI+B,KACjB,CAEA,QAAAC,CAASD,GAIR,OAFI1G,KAAK2E,IAAI+B,QAAUA,GAASA,IAC/B1G,KAAK2E,IAAI+B,MAAQA,GACX1G,IACR,CAEA,cAAA4G,GAEC,OAAO5G,KAAK2E,IAAIkC,WACjB,CAEA,cAAAC,CAAeC,GAId,OAFI/G,KAAK2E,IAAIkC,cAAgBE,GAAQA,IACpC/G,KAAK2E,IAAIkC,YAAcE,GACjB/G,IACR,CAEA,qBAAAgH,GAEC,OAAOhH,KAAK2E,IAAIqC,uBACjB,EAOM,MAAMC,UAAexC,EAE3B,WAAAnC,CAAYyE,GAEXG,MAAM,QACNlH,KAAK8G,eAAeC,EACrB,EAMM,MAAMI,UAAc1C,EAE1B,WAAAnC,GAEC4E,MAAM,MACP,EAMM,MAAME,UAAcD,EAE1B,WAAA7E,GAEC4E,QAEAlH,KAAK2E,IAAIwB,UAAY,KACtB,EAMM,MAAMkB,UAAgBF,EAE5B,WAAA7E,GAEC4E,QAEAlH,KAAK2E,IAAIwB,UAAY,OACtB,EAQM,MAAMmB,UAAgB7C,EAE5B,WAAAnC,CAAYyE,EAAMjB,GAEjBoB,MAAM,SAENlH,KAAK2E,IAAIkC,YAAcE,EACnBjB,IAAI9F,KAAK2E,IAAI4C,QAAUzB,EAC5B,EAQM,MAAM0B,UAAe/C,EAE3B,WAAAnC,CAAYmF,EAAMV,GAEjBG,MAAM,KAENlH,KAAK2E,IAAI8C,KAAOA,GAAQ,IACxBzH,KAAK2E,IAAIkC,YAAcE,GAAQ,EAChC,CAEA,OAAAW,CAAQC,GAGP,OADA3H,KAAK2E,IAAI8C,KAAOE,EACT3H,IACR,EAOM,MAAM4H,UAAeX,EAE3B,WAAA3E,CAAYyE,GAEXG,QAEAlH,KAAK2E,IAAIkC,YAAcE,CACxB,CAEA,QAAAc,GAEC,OAAO7H,KAAK2E,IAAIkC,WACjB,CAEA,QAAAiB,CAASf,GAGR,OADA/G,KAAK2E,IAAIkC,YAAcE,EAChB/G,IACR,EAkCM,MAAM+H,UAAiBtD,EAE7B,WAAAnC,GAEC4E,MAAM,SACP,CAEA,WAAAc,CAAYC,GAGX,OADAjI,KAAK2E,IAAIuD,SAAWD,IAAW,EACxBjI,IACR,CAEA,UAAAmI,CAAW5K,GAEV,MAAM6K,EAAWpI,KAAK2E,IAAIxH,MAC1B6C,KAAK0F,QAEL,IAAK,MAAM3G,KAAOxB,EAAS,CAE1B,MAAM8K,EAASzD,SAASC,cAAc,UACtCwD,EAAOlL,MAAQ4B,EACfsJ,EAAOtB,KAAOxJ,EAAQwB,GACtBiB,KAAK2E,IAAIK,YAAYqD,EACtB,CAEA,OADArI,KAAK2E,IAAIxH,MAAQiL,EACVpI,IACR,CAEA,QAAA6H,GAEC,OAAO7H,KAAK2E,IAAIxH,KACjB,CAEA,QAAA2K,CAAS3K,GAMR,OAJAA,EAAQyC,OAAOzC,GAEX6C,KAAK2E,IAAIxH,QAAUA,IACtB6C,KAAK2E,IAAIxH,MAAQA,GACX6C,IACR,EASM,MAAMsI,UAAgB7D,EAE5B,WAAAnC,CAAYtB,EAAM7D,EAAOuJ,GAExBQ,MAAM,SAENlH,KAAK2E,IAAI3D,KAAOA,EAChBhB,KAAK2E,IAAI4D,UAAalL,IAErBA,EAAEmL,iBAAiB,EAEpBxI,KAAK8H,SAAS3K,GACd6C,KAAK2G,SAASD,EACf,CAEA,OAAA+B,GAEC,OAAOzI,KAAK2E,IAAIsB,IACjB,CAEA,OAAAyC,CAAQzC,GAGP,OADAjG,KAAK2E,IAAIsB,KAAOA,EACTjG,IACR,CAEA,OAAA2I,GAEC,OAAO3I,KAAK2E,IAAI3D,IACjB,CAEA,OAAA4H,CAAQ5H,GAGP,OADAhB,KAAK2E,IAAI3D,KAAOA,EACThB,IACR,CAEA,QAAA6H,GAEC,OAAO7H,KAAK2E,IAAIxH,KACjB,CAEA,QAAA2K,CAAS3K,GAIR,OAFI6C,KAAK2E,IAAIxH,QAAUA,QAAmBe,IAAVf,IAC/B6C,KAAK2E,IAAIxH,MAAQA,GACX6C,IACR,EAsDM,MAAM6I,UAAiBpE,EAE7B,WAAAnC,CAAYnF,EAAO2L,EAAMC,EAAKtK,EAAKuK,GAElC9B,MAAM,SAENlH,KAAK2E,IAAI3D,KAAO,SAChBhB,KAAK2E,IAAImE,KAAOA,GAAQ,EACxB9I,KAAK2E,IAAI4D,UAAalL,IAErBA,EAAEmL,iBAAiB,EAEpBxI,KAAK7C,MAAQA,GAAS,EACtB6C,KAAK+I,IAAMA,IAAO,IAClB/I,KAAKvB,IAAMA,GAAO,IAClBuB,KAAKgJ,UAAYA,GAAa,EAC9BhJ,KAAK8H,SAAS3K,GACd6C,KAAK2E,IAAIsE,SAAY5L,IAEpB2C,KAAK8H,SAAS9H,KAAK7C,MAAM,CAE3B,CAEA,OAAAsL,GAEC,OAAOzI,KAAK2E,IAAIsB,IACjB,CAEA,OAAAyC,CAAQzC,GAGP,OADAjG,KAAK2E,IAAIsB,KAAOA,EACTjG,IACR,CAEA,YAAAkJ,CAAaF,GAIZ,OAFAhJ,KAAKgJ,UAAYA,EACjBhJ,KAAK8H,SAAS9H,KAAK7C,OACZ6C,IACR,CAEA,QAAAmJ,CAASJ,EAAKtK,GAMb,OAJAuB,KAAK+I,IAAMA,EACX/I,KAAKvB,IAAMA,EACXuB,KAAK2E,IAAIoE,IAAMA,EACf/I,KAAK2E,IAAIlG,IAAMA,EACRuB,IACR,CAEA,OAAAoJ,CAAQN,GAGP,OADA9I,KAAK2E,IAAImE,KAAOA,EACT9I,IACR,CAEA,QAAA6H,GAEC,OAAOwB,WAAWrJ,KAAK2E,IAAIxH,MAC5B,CAEA,QAAA2K,CAAS3K,GAaR,YAXce,IAAVf,KACHA,EAAQkM,WAAWlM,IAEP6C,KAAK+I,MAChB5L,EAAQ6C,KAAK+I,KACV5L,EAAQ6C,KAAKvB,MAChBtB,EAAQ6C,KAAKvB,KAEduB,KAAK7C,MAAQA,EACb6C,KAAK2E,IAAIxH,MAAQA,EAAMmM,QAAQtJ,KAAKgJ,YAE9BhJ,IACR,EAiDM,MAAMuJ,UAAsBpC,EAElC,WAAA7E,CAAYkH,GAEXtC,QAEAlH,KAAKwJ,MAAQA,GAAS,aACtBxJ,KAAKyJ,KAAO,GACZzJ,KAAK0J,OAAS,GACd1J,KAAK2J,UAAW,IAAI1C,GAASf,SAAS,gBACtClG,KAAK4J,SAAU,IAAIzC,GAAQjB,SAAS,QACpClG,KAAK6J,SAAU,IAAI1C,GAAQjB,SAAS,QACpClG,KAAK6J,QAAQ/E,IAAI9E,KAAK2J,UACtB3J,KAAK8J,WAAY,IAAI3C,GAAQjB,SAAS,UACtClG,KAAKoI,SAAW,GAChBpI,KAAK8E,IAAI9E,KAAK4J,SACd5J,KAAK8E,IAAI9E,KAAK6J,SACd7J,KAAK8E,IAAI9E,KAAK8J,UACf,CAEA,OAAAC,CAAQC,GACPhK,KAAK4J,QAAQ9E,IAAIkF,EAClB,CAEA,MAAAC,CAAOnE,EAAIoE,EAAOF,GAEjB,MAAMG,EAAM,IAAIC,EAAMF,EAAOlK,MAC7BmK,EAAItE,MAAMC,GACVqE,EAAIjE,SAAS,OACblG,KAAKyJ,KAAKnI,KAAK6I,GACfnK,KAAK6J,QAAQ/E,IAAIqF,GAEjB,MAAME,EAAQ,IAAIlD,EAClBkD,EAAMxE,MAAMC,GACZuE,EAAMvF,IAAIkF,GACVhK,KAAK0J,OAAOpI,KAAK+I,GACjBrK,KAAK8J,UAAUhF,IAAIuF,GACnBrK,KAAKsK,OAAOxE,EACb,CAEA,MAAAwE,CAAOxE,GAEN,IAAK,IAAIqE,KAAOnK,KAAKyJ,KAChBU,EAAIxF,IAAImB,KAAOA,GAClBqE,EAAI/D,SAAS,YACbpG,KAAKuK,kBAAkBJ,IACbA,EAAIxF,IAAImB,KAAO9F,KAAKoI,UAC9B+B,EAAI7D,YAAY,YAIlB,IAAK,IAAI+D,KAASrK,KAAK0J,OAClBW,EAAM1F,IAAImB,KAAOA,EACpBuE,EAAM1F,IAAI6B,MAAMgE,QAAU,QAChBH,EAAM1F,IAAImB,KAAO9F,KAAKoI,WAChCiC,EAAM1F,IAAI6B,MAAMgE,QAAU,QAK5B,OADAxK,KAAKoI,SAAWtC,EACT9F,IACR,CAEA,QAAAyK,CAAS3E,EAAIiB,GAEZ,IAAK,IAAIoD,KAAOnK,KAAKyJ,KACpB,GAAIU,EAAIxF,IAAImB,KAAOA,EAAI,CACtBqE,EAAIxD,SAASI,GACb,KACD,CAEF,CAEA,iBAAAwD,CAAkBJ,GAEjB,IAAIO,EACJ,MAAMC,EAAOR,EAAInD,wBACE,eAAfhH,KAAKwJ,OACRkB,EAAOC,EAAKC,MAAQ5K,KAAKyJ,KAAK3J,QAAQqK,GACtCnK,KAAK2J,SAAShF,IAAI6B,MAAMqE,UAAY,cAAcH,SAElDA,EAAOC,EAAKG,OAAS9K,KAAKyJ,KAAK3J,QAAQqK,GACvCnK,KAAK2J,SAAShF,IAAI6B,MAAMqE,UAAY,cAAcH,OAEpD,EAQM,MAAMN,UAAcjD,EAE1B,WAAA7E,CAAYyE,EAAMgE,GAEjB7D,QACAlH,KAAKgL,OAAS,IAAI1C,EAAQ,UAC1BtI,KAAKgL,OAAOrG,IAAI+B,MAAQK,EACxB/G,KAAK2E,IAAIsG,QAAW5N,IAEnB0N,EAAOT,OAAOtK,KAAK2E,IAAImB,IACvBzI,EAAE6N,gBAAgB,EAEnBlL,KAAK8E,IAAI9E,KAAKgL,OACf,EAOM,MAAMG,UAAe1G,EAE3B,WAAAnC,CAAYyI,GAEX7D,MAAM,MACNlH,KAAK+K,OAASA,GAAUA,EAAOA,OAC/B/K,KAAKoL,UAAW,CACjB,CAEA,MAAAC,GAMC,OAJArL,KAAKoL,UAAW,EAChBpL,KAAK2E,IAAI6B,MAAMgE,QAAU,QACrBxK,KAAK+K,QACR/K,KAAK+K,OAAOM,SACNrL,IACR,CAEA,OAAAsL,GAIC,OAFAtL,KAAKoL,UAAW,EAChBpL,KAAK2E,IAAI6B,MAAMgE,QAAU,OAClBxK,IACR,EAOM,MAAMuL,UAAe9G,EAE3B,WAAAnC,CAAYyI,GAEX7D,MAAM,MACNlH,KAAK+K,OAASA,EACd/K,KAAKoI,UAAW,CACjB,CAEA,MAAAkC,GAIC,OAFAtK,KAAKoI,UAAW,EAChBpI,KAAKkG,SAAS,YACPlG,IACR,CAEA,QAAAwL,GAIC,OAFAxL,KAAKoI,UAAW,EAChBpI,KAAKgG,gBAAgB,SACdhG,IACR,EAOM,MAAMyL,UAAchH,EAE1B,WAAAnC,CAAY0H,GAEX9C,MAAM,OACNlH,KAAKkG,SAAS,OACdlG,KAAK8E,IAAIkF,EACV,ECxuBM,MAAM0B,EAEZ,WAAApJ,CAAY0B,GAEX,MAAM2H,EAAU3H,EAAO2H,QACjBzH,EAAWF,EAAOE,SAElB0H,GAAY,IAAIzE,GAAQtB,MAAM,WAC9BrH,EAAO,CACZ,kBACA,eACA,eACA,mBACA,yBACA,mBACA,sBAEKqN,GAAQ,IAAI1E,GAAQjB,SAAS,UAC7B4F,GAAY,IAAI3E,GAAQtB,MAAM,SAASK,SAAS,OAChD6F,EAAY,IAAIzD,EAAQ,UAU9B,IAAI0D,EAASC,EACTC,EAASC,EAVbJ,EAAUpH,IAAI+B,MAAQiF,EAAQ3N,IAAIQ,EAAK,IACvCuN,EAAUpH,IAAIsG,QAAW5N,IAExB2G,EAAO5D,KAAK,iBAAiB,GAC7B/C,EAAE6N,gBAAgB,EAEnBY,EAAUhH,IAAIiH,GACdF,EAAM/G,IAAIgH,GAIc,YAApB5H,EAASkI,SACZJ,GAAU,IAAI7E,GAAQtB,MAAM,SAASK,SAAS,OAC9C+F,EAAU,IAAI3D,EAAQ,UACtB2D,EAAQtF,SAASgF,EAAQ3N,IAAIQ,EAAK,KAClCyN,EAAQtH,IAAIsG,QAAW5N,IAEtB2G,EAAO5D,KAAK,QACZ/C,EAAE6N,iBACFe,EAAQtH,IAAI0H,MAAM,EAEnBL,EAAQlH,IAAImH,GACZJ,EAAM/G,IAAIkH,GAEVE,GAAU,IAAI/E,GAAQtB,MAAM,SAASK,SAAS,OAC9CiG,EAAU,IAAI7D,EAAQ,UACtB6D,EAAQxH,IAAI+B,MAAQiF,EAAQ3N,IAAIQ,EAAK,IACrC2N,EAAQxH,IAAIsG,QAAW5N,IAEtB2G,EAAO5D,KAAK,QACZ/C,EAAE6N,iBACFiB,EAAQxH,IAAI0H,MAAM,EAEnBH,EAAQpH,IAAIqH,GACZN,EAAM/G,IAAIoH,IAGX,MAAMI,GAAQ,IAAInF,GAAQjB,SAAS,UACnC,IAAIqG,EA4CAC,EAAaC,EAiBbC,EA5DJ,GAAIxI,EAASyI,SAAU,CACtB,MAAMC,EAAUvP,IAEfwP,EAAQnH,QACRmH,EAAQ5O,IAAIZ,EAAEyP,OAAOtN,QAAQ,KAC5BwE,EAAO+I,SACP/I,EAAOgJ,KAAK3P,EAAEyP,OAAOtN,OAAQ,CAAEyN,SAAS,IACxC,MAAMtF,EAAM,IAAIuF,IAAIC,OAAOC,SAASC,QACpCF,OAAOG,QAAQC,UAAU,CAAC,EAAG,GAAI5F,EAAI,GACpC,EAEG6F,EAAWnQ,IAChB+H,QAAQvG,MAAMxB,EAAE,EAEXwP,EAAUM,OAAON,QACjBY,GAAc,IAAItG,GAAQtB,MAAM,SAASK,SAAS,OACxDqG,EAAc,IAAIjE,EAAQ,QAC1BiE,EAAY5H,IAAI+B,MAAQiF,EAAQ3N,IAAIQ,EAAK,IACzC+N,EAAY5H,IAAI+I,OAAS,uBACzBnB,EAAY5H,IAAIsE,SAAY5L,IAE3B,GAA8B,IAA1BA,EAAEyP,OAAOa,MAAMjQ,OAGnB,GAAIyP,OAAOS,WAAY,CAEtB,MAAMvJ,EAAK,IAAIuJ,WACfvJ,EAAGuI,OAASA,EACZvI,EAAGwJ,kBAAkBxQ,EAAEyP,OAAOa,MAAM,IACpCtJ,EAAGmJ,QAAUA,CACd,MACCM,MAAMnC,EAAQ3N,IAAIQ,EAAK,IACxB,EAGD+N,EAAY5H,IAAIsG,QAAW5N,IAE1BkP,EAAY5H,IAAI0H,MAAM,EAEvBoB,EAAY3I,IAAIyH,GAChBD,EAAMxH,IAAI2I,EACX,CAoBA,GAjBIvJ,EAAS6J,YACZvB,GAAc,IAAIrF,GAAQtB,MAAM,SAASK,SAAS,OAClDuG,EAAc,IAAInE,EAAQ,UAC1BmE,EAAY9F,SAASgF,EAAQ3N,IAAIQ,EAAK,KACtCiO,EAAY9H,IAAIsG,QAAW5N,IAE1B,MAAM2Q,EAAMhO,KAAKiO,YACX/O,GAAoC,IAA9B8E,EAAOkK,aAAaF,GAChChK,EAAO5D,KAAK,aAAclB,GAC1B7B,EAAE6N,iBACFuB,EAAY9H,IAAI0H,MAAM,EAEvBG,EAAY1H,IAAI2H,GAChBH,EAAMxH,IAAI0H,IAIPtI,EAASiK,WAAY,CAExB,MAAMC,GAAgB,IAAIjH,GAAQtB,MAAM,SAASK,SAAS,OAC1DwG,EAAgB,IAAIpE,EAAQ,UAC5BoE,EAAc/F,SAASgF,EAAQ3N,IAAIQ,EAAK,KACxCkO,EAAc/H,IAAIsG,QAAW5N,IAE5B2C,KAAKqO,mBACLhR,EAAE6N,gBAAgB,EAGnBtG,SAAS2D,UAAalL,IAEP,QAAVA,EAAE0B,MACL1B,EAAE6N,iBACFlL,KAAKqO,mBACN,EAGDzJ,SAAS0J,mBAAsBjR,IAE9B,MAAMC,EAAI6P,OAAOoB,OAAO3D,QAAUvN,EAAEyP,OAAO0B,YACrCC,EAAItB,OAAOoB,OAAOzD,SAAWzN,EAAEyP,OAAO4B,aAExCpR,GAAKmR,EACRL,EAAchI,SAAS,gBAEvBgI,EAAc9H,YAAY,eAC3B,EAED8H,EAActJ,IAAI4H,GAClBJ,EAAMxH,IAAIsJ,EACX,CAEAxC,EAAU9G,IAAI,CAAC+G,EAAOS,IACtB1H,SAAS+J,KAAK3J,YAAY4G,EAAUjH,KAIpCX,EAAO/D,GAAG,aAAcmN,IAEvB,GAAIlJ,EAAS6J,UAAW,CACvB,MAAMC,EAAMZ,EAASwB,MAAMZ,KACe,IAA9BhK,EAAOkK,aAAaF,GAE/BxB,EAAYlG,YAAY,cAExBkG,EAAYpG,SAAS,cAEtBpG,KAAKiO,YAAcD,CACpB,CACwB,YAApB9J,EAASkI,SACZJ,EAAQrH,IAAI6B,MAAMgE,QAAU4C,EAASyB,QAAU,OAAS,QACxD3C,EAAQvH,IAAI6B,MAAMgE,QAAU4C,EAAS0B,MAAQ,OAAS,QACvD,IAGD9K,EAAO/D,GAAG,cAAegI,IAEpBA,EACHuE,EAAYpG,SAAS,cAErBoG,EAAYlG,YAAY,aACzB,IAGDtC,EAAO/D,GAAG,mBAAoB9C,IAE7B4O,EAAUpF,SAASgF,EAAQ3N,IAAIQ,EAAK,KAEZ,YAApB0F,EAASkI,SACZH,EAAQtF,SAASgF,EAAQ3N,IAAIQ,EAAK,KAClC2N,EAAQxF,SAASgF,EAAQ3N,IAAIQ,EAAK,MAE/B0F,EAASyI,UACZJ,EAAY5F,SAASgF,EAAQ3N,IAAIQ,EAAK,KAEnC0F,EAAS6J,WACZtB,EAAY9F,SAASgF,EAAQ3N,IAAIQ,EAAK,KAEnC0F,EAASiK,YACZzB,EAAc/F,SAASgF,EAAQ3N,IAAIQ,EAAK,IACzC,GAEF,CAEA,gBAAA6P,GAECzJ,SAASmK,cAAc1C,OAEY,OAA/BzH,SAASoK,kBACZpK,SAASqK,gBAAgBC,oBACftK,SAASuK,gBACnBvK,SAASuK,gBAEX,ECvNM,MAAMC,EAEZ,WAAA9M,CAAY0B,GAEX,MAAME,EAAWF,EAAOE,SAClB0H,GAAY,IAAIzE,GAAQtB,MAAM,WAEpC,IAAIwJ,EACoB,YAApBnL,EAASkI,SAEZiD,GAAO,IAAIlI,GAAQtB,MAAM,QAAQK,SAAS,SAC1CmJ,EAAK1K,IAAIsG,QAAW5N,IAEnB2G,EAAO5D,KAAK,QACZ/C,EAAE6N,gBAAgB,EAEnBmE,EAAKvK,IAAI,IAAImC,EAAO,MACpB2E,EAAU9G,IAAIuK,IAGf,MAAMC,GAAS,IAAInI,GAAQtB,MAAM,UAGjC,IAAI0J,EAFJ3D,EAAU9G,IAAIwK,GAGU,YAApBpL,EAASkI,SACZmD,GAAO,IAAIpI,GAAQtB,MAAM,QAAQK,SAAS,SAC1CqJ,EAAK5K,IAAIsG,QAAW5N,IAEnB2G,EAAO5D,KAAK,QACZ/C,EAAE6N,gBAAgB,EAEnBqE,EAAKzK,IAAI,IAAImC,EAAO,MACpB2E,EAAU9G,IAAIyK,IAGf,MAAMC,GAAS,IAAIrI,GAAQtB,MAAM,UAC3B4J,GAAU,IAAItI,GAAQtB,MAAM,WAElC+F,EAAU9G,IAAI,CAAC2K,EAASD,IACxB5K,SAAS+J,KAAK3J,YAAY4G,EAAUjH,KAIpCX,EAAO/D,GAAG,aAAcyP,IAEvBJ,EAAOpJ,SAASwJ,EAAIC,MACpBH,EAAO7K,IAAI6B,MAAMgE,QAAU,OAAO,IAGnCxG,EAAO/D,GAAG,cAAc,KAEvBuP,EAAO7K,IAAI6B,MAAMgE,QAAU,MAAM,IAGlCxG,EAAO/D,GAAG,UAAW2P,IAEhBA,EAAMC,QAAUD,EAAMhF,MAAQgF,EAAME,YACvCL,EAAQ9K,IAAI6B,MAAMgE,QAAU,QAE5BiF,EAAQ9K,IAAI6B,MAAMgE,QAAU,MAC7B,IAGDxG,EAAO/D,GAAG,eAAgB9C,IAEzBmS,EAAOpJ,SAAS/I,EAAM,IAGvB6G,EAAO/D,GAAG,aAAcmN,IAEC,YAApBlJ,EAASkI,SACRgB,EAASyB,QACZQ,EAAKjJ,SAAS,YAEdiJ,EAAK/I,YAAY,YAEd8G,EAAS0B,MACZS,EAAKnJ,SAAS,YAEdmJ,EAAKjJ,YAAY,YAEnB,IAGDtC,EAAO/D,GAAG,QAAQ,KAEO,YAApBiE,EAASkI,SACZiD,EAAKjJ,SAAS,UACd2J,YAAW,KAAQV,EAAK/I,YAAY,SAAS,GAAK,KACnD,IAGDtC,EAAO/D,GAAG,QAAQ,KAEO,YAApBiE,EAASkI,SACZmD,EAAKnJ,SAAS,UACd2J,YAAW,KAAQR,EAAKjJ,YAAY,SAAS,GAAK,KACnD,IAGDtC,EAAO/D,GAAG,iBAAiB,KAE1BqP,EAAO5J,OAAO,GAEhB,ECxGM,MAAMsK,UAAiB3I,EAE7B,WAAA/E,CAAY0B,GAEXkD,QACA,MAAM0E,GAAY,IAAIzE,GAAQjB,SAAS,kBACjCyF,EAAU3H,EAAO2H,QACjBnN,EAAO,CACZ,oBAEK0L,EAAQ,IAAItC,EAAO+D,EAAQ3N,IAAIQ,EAAK,KAAK0H,SAAS,SACxDlG,KAAKgE,OAASA,EACdhE,KAAK2J,cAAWzL,EAChB8B,KAAK6F,MAAM,YACX7F,KAAK8E,IAAI,IAAI2G,EAAMvB,GAAO9D,SAAS,WAInCpC,EAAO/D,GAAG,cAAegQ,IAExBrE,EAAUlG,QACVkG,EAAU9G,IAAI9E,KAAKkQ,YAAYD,IAC/BjQ,KAAK8E,IAAI8G,EAAU,IAGpB5H,EAAO/D,GAAG,mBAAoB9C,IAE7B+M,EAAMpC,SAAS6D,EAAQ3N,IAAIQ,EAAK,IAAI,GAEtC,CAEA,WAAA0R,CAAYD,EAAKlF,GAEhB,MAAMoF,EAAO,IAAIhF,EAAOJ,GAqDxB,OAnDAkF,EAAIjR,SAASoR,IAEZ,MAAMC,EAAO,IAAI7I,EAAO4I,EAAQ3I,KAAM2I,EAAQlG,OACxCoG,EAAO,IAAI/E,EAAO4E,GAAMtK,MAAMuK,EAAQtK,IACtCyK,GAAO,IAAIpJ,GAAQtB,MAAM,YAyB/B,GAvBAwK,EAAK1L,IAAIsG,QAAW5N,IAEf2C,KAAK2J,UAAY3J,KAAK2J,WAAa2G,GACtCtQ,KAAK2J,SAAS6B,WAEf8E,EAAKhG,SACLtK,KAAK2J,SAAW2G,EAChBtQ,KAAKgE,OAAOE,SAASsM,UAAYJ,EAAQtK,GACzC9F,KAAKgE,OAAOyM,UAAUjG,QAAQ4F,EAAQ3I,MACtCpK,EAAE6N,gBAAgB,EAEnBoF,EAAKxL,IAAI,CAACyL,EAAMF,IAChBrQ,KAAKgE,OAAO0M,SAASN,EAAQ3I,MAAQ,CACpC3B,GAAIsK,EAAQtK,GACZoE,MAAOkG,EAAQlG,OAGZlK,KAAKgE,OAAOE,SAASsM,YAAcJ,EAAQtK,KAC9CqK,EAAK9E,SACLiF,EAAKhG,SACLtK,KAAK2J,SAAW2G,GAGbF,EAAQO,UAAYP,EAAQO,SAASjT,OAAS,EAAG,CAEpD,MAAMkT,EAAW5Q,KAAKkQ,YAAYE,EAAQO,SAAUL,GAC9CO,GAAO,IAAI5J,GAASf,SAAS,oBACnC2K,EAAKlM,IAAIsG,QAAU,KAEd2F,EAASxF,UACZwF,EAAStF,UACTuF,EAAK3K,SAAS,sBAEd0K,EAASvF,SACTwF,EAAK3K,SAAS,qBAER,GAERqK,EAAKzL,IAAI+L,GACTP,EAAKxL,IAAI8L,EACV,CAEAT,EAAKrL,IAAIwL,EAAK,IAGRH,CACR,ECvFM,MAAMW,UAAuBzJ,EAEnC,WAAA/E,CAAY0B,GAEXkD,QACA,MAAM0E,GAAY,IAAIzE,GAAQjB,SAAS,kBACjCyF,EAAU3H,EAAO2H,QACjBnN,EAAO,CACZ,oBACA,2BAEKuS,EAAc,IAAInJ,EAAO+D,EAAQ3N,IAAIQ,EAAK,KAAK0H,SAAS,SACxD8K,EAAW,IAAI1I,EAAQ,SAAUqD,EAAQ3N,IAAIQ,EAAK,KACxDwS,EAASrM,IAAIsG,QAAW5N,IAEvB2C,KAAKiR,iBACLjN,EAAO5D,KAAK,cAAc,GAC1B/C,EAAE6N,gBAAgB,EAEnBlL,KAAK8E,IAAI,IAAI2G,EAAM,CAACsF,EAAaC,IAAW5K,SAAS,WACrDpG,KAAK2J,cAAWzL,EAChB8B,KAAK+N,UAAY,IAAI5C,EACrBS,EAAU9G,IAAI9E,KAAK+N,WACnB/N,KAAK6F,MAAM,aACX7F,KAAK8E,IAAI8G,GACT5L,KAAKgE,OAASA,EAEd,MAAMkN,EAAS,KAEdF,EAASrM,IAAIwM,SAAgD,IAArCnN,EAAOE,SAAS6J,UAAUrQ,MAAY,EAK/DsG,EAAO/D,GAAG,aAAa,CAACmR,EAAU1B,KAEjCA,EAAI3B,UAAU/O,SAASgP,IAEtBhO,KAAKqR,YAAYrD,EAAI,IAEtBkD,GAAQ,IAGTlN,EAAO/D,GAAG,aAAcmN,IAEvBpN,KAAKiO,YAAcb,EAASwB,MAAMZ,GAAG,IAGtChK,EAAO/D,GAAG,cAAc,CAACgI,EAAS+F,KAE7B/F,EACHjI,KAAKsR,iBAELtR,KAAKuR,eAAevD,GAErBkD,GAAQ,IAGTlN,EAAO/D,GAAG,mBAAoB9C,IAE7B4T,EAAYjJ,SAAS6D,EAAQ3N,IAAIQ,EAAK,KACtCwS,EAASlJ,SAAS6D,EAAQ3N,IAAIQ,EAAK,IAAI,GAEzC,CAEA,cAAA8S,GAEC,MAAMtD,EAAMhO,KAAKiO,YACbjO,KAAKgE,OAAOkK,aAAaF,IAAQ,IAGrChO,KAAKqR,YAAYrD,GACjBhO,KAAKgE,OAAOE,SAAS6J,UAAUzM,KAAK0M,GACrC,CAEA,cAAAuD,CAAevD,GAEd,MAAMwD,EAAOxD,GAAOhO,KAAKiO,YACnBwD,EAAQzR,KAAKgE,OAAOkK,aAAasD,IACxB,IAAXC,IAGJzR,KAAK+N,UAAU1I,OAAOoM,GACtBzR,KAAKgE,OAAOE,SAAS6J,UAAUtM,OAAOgQ,EAAO,GAC9C,CAEA,cAAAR,GAECjR,KAAK+N,UAAUrI,QACf1F,KAAKgE,OAAOE,SAAS6J,UAAY,EAClC,CAEA,WAAAsD,CAAYrD,GAEX,MAAMqC,EAAO,IAAI7I,EACX8I,EAAO,IAAI/E,EACXmG,GAAO,IAAIzK,GAASf,SAAS,cAC7ByL,EAAU3R,KAAKgE,OAAO4N,eAAe5D,GAC3C,IAAI6D,EACA3H,EAEJ,QAAgBhM,IAAZyT,EAAuB,CAC1B,MAAMG,EAAY9R,KAAKgE,OAAO+N,KAAKC,MAAMhU,IAAIgQ,GAC7C6D,EAAQC,EAAUD,MAClB3H,EAAQ4H,EAAUD,KACnB,MACCA,EAAQF,EAAQ7L,GAChBoE,EAAQyH,EAAQzH,MAGjBmG,EAAK3I,QAAQ,IAAMsG,GACnBqC,EAAK1L,IAAIsG,QAAW5N,IAEf2C,KAAK2J,UAAY3J,KAAK2J,WAAa2G,GACtCtQ,KAAK2J,SAAS6B,WAEf8E,EAAKhG,SACLtK,KAAK2J,SAAW2G,EAChBtQ,KAAKgE,OAAOyM,UAAUjG,QAAQwD,GAC9B3Q,EAAE6N,gBAAgB,EAEnBmF,EAAKvJ,eAAeoD,GAEpBwH,EAAK/M,IAAIsG,QAAW5N,IAEnB2C,KAAKgE,OAAO5D,KAAK,cAAc,EAAO4N,GACtC3Q,EAAE6N,gBAAgB,EAGnBoF,EAAKxL,IAAI,CAACuL,EAAMqB,IAChBpB,EAAKzK,MAAMgM,GACX7R,KAAK+N,UAAUjJ,IAAIwL,EACpB,ECpIM,MAAM2B,UAAyB5K,EAErC,WAAA/E,CAAY0B,GAEXkD,QACA,MAAM0E,GAAY,IAAIzE,GAAQjB,SAAS,kBACjCyF,EAAU3H,EAAO2H,QACjBnN,EAAO,CACZ,sBACA,6BAEKuS,EAAc,IAAInJ,EAAO+D,EAAQ3N,IAAIQ,EAAK,KAAK0H,SAAS,SACxD8K,EAAW,IAAI1I,EAAQ,SAAUqD,EAAQ3N,IAAIQ,EAAK,KACxDwS,EAASrM,IAAIsG,QAAW5N,IAEvB2C,KAAKkS,aACL7U,EAAE6N,gBAAgB,EAEnBlL,KAAK8E,IAAI,IAAI2G,EAAM,CAACsF,EAAaC,IAAW5K,SAAS,WACrDpG,KAAK2J,cAAWzL,EAChB8B,KAAKmS,MAAQ,IAAIhH,EACjBS,EAAU9G,IAAI9E,KAAKmS,OACnBnS,KAAK6F,MAAM,eACX7F,KAAK8E,IAAI8G,GACT5L,KAAKgE,OAASA,EACdhE,KAAKkR,OAAS,KAEbF,EAASrM,IAAIwM,SAAkD,IAAvCnN,EAAOE,SAASkO,YAAY1U,MAAY,EAKjEsG,EAAO/D,GAAG,aAAcyP,IAEvBA,EAAI0C,YAAYpT,SAASqT,IAExBrS,KAAK/B,IAAIoU,EAAK,IAEfrS,KAAKkR,QAAQ,IAGdlN,EAAO/D,GAAG,aAAcoS,IAEvBrS,KAAK/B,IAAIoU,GACTrS,KAAKkR,QAAQ,IAGdlN,EAAO/D,GAAG,mBAAoB9C,IAE7B4T,EAAYjJ,SAAS6D,EAAQ3N,IAAIQ,EAAK,KACtCwS,EAASlJ,SAAS6D,EAAQ3N,IAAIQ,EAAK,IAAI,GAEzC,CAEA,GAAAP,CAAIoU,GAEH,MAAMhC,EAAO,IAAI7I,EAAO,IAAM6K,EAAKrE,IAAKqE,EAAKtL,MACvCuJ,GAAO,IAAI/E,GAAS1F,MAAM,QAAUwM,EAAK5O,MACzCiO,GAAO,IAAIzK,GAASf,SAAS,cAGnCmK,EAAK1L,IAAIsG,QAAW5N,IAEf2C,KAAK2J,UAAY3J,KAAK2J,WAAa2G,GACtCtQ,KAAK2J,SAAS6B,WAEf8E,EAAKhG,SACLtK,KAAK2J,SAAW2G,EAChBtQ,KAAKgE,OAAOyM,UAAUjG,QAAQ6H,EAAKrE,KACnC3Q,EAAE6N,gBAAgB,EAGnBwG,EAAK/M,IAAIsG,QAAW5N,IAEnB2C,KAAKsS,WAAWD,GAChBhV,EAAE6N,gBAAgB,EAGnBoF,EAAKxL,IAAI,CAACuL,EAAMqB,IAChB1R,KAAKmS,MAAMrN,IAAIwL,GACftQ,KAAKgE,OAAOyM,UAAU2B,YAAYtN,IACjC,YAAauN,EAAKrE,IAAK,CAAC,GAtBZ,QAsBqB,iBAAkB,CAAC,GACrDhO,KAAKkR,QACN,CAEA,UAAAoB,CAAWD,GAEV,MAAMZ,EAAQzR,KAAKgE,OAAOE,SAASkO,YAAYtS,QAAQuS,IACxC,IAAXZ,IAGJzR,KAAKmS,MAAM9M,OAAOoM,GAClBzR,KAAKgE,OAAOE,SAASkO,YAAY3Q,OAAOgQ,EAAO,GAC/CzR,KAAKgE,OAAOyM,UAAU2B,YAAY/M,OAAOgN,EAAKrE,IAAK,aACnDhO,KAAKkR,SACN,CAEA,UAAAgB,GAEClS,KAAKgE,OAAOE,SAASkO,YAAYpT,SAAQqT,IACxCrS,KAAKgE,OAAOyM,UAAU2B,YAAY/M,OAAOgN,EAAKrE,IAAK,YAAY,IAEhEhO,KAAKmS,MAAMzM,QACX1F,KAAKgE,OAAOE,SAASkO,YAAc,GACnCpS,KAAKkR,QACN,ECzGM,MAAMqB,UAAoBlL,EAEhC,WAAA/E,CAAY0B,GAEXkD,QACA,MAAM0E,GAAY,IAAIzE,GAAQjB,SAAS,kBACjCyF,EAAU3H,EAAO2H,QAEvB,IAAI6G,EACJ,MAAMC,EAAS,IAAInK,EAAQ,UAAUzC,MAAM,SAC3C4M,EAAO9N,IAAI+N,YAAc/G,EAAQ3N,IAAI,8BACrCyU,EAAO9N,IAAIgO,SAAW,KAErB,MAAMxV,EAAQsV,EAAO5K,WAEA,IAAjB1K,EAAMO,OACTsC,KAAKgK,MAAMtE,QACD8M,IAAgBrV,IAC1B6C,KAAKgK,MAAMtE,QACX1F,KAAK4S,SAASzV,GAAO0V,MAAKC,IAEzBA,EAAQ9T,SAAQoC,IACfpB,KAAK/B,IAAImD,EAAK,GACb,KAGJoR,EAAcrV,CAAK,EAGpB6C,KAAK6F,MAAM,UACX7F,KAAKgK,MAAQ,IAAImB,EACjBS,EAAU9G,IAAI9E,KAAKgK,OACnBhK,KAAK8E,IAAI,CAAC,IAAI2G,EAAMgH,GAAS7G,IAC7B5L,KAAKgE,OAASA,CAIf,CAOA,cAAM4O,CAASvP,GAEd,MAAM0O,EAAO/R,KAAKgE,OAAO+N,KACnBe,QAAgBC,QAAQC,IAC7BjB,EAAKC,MAAMiB,WAAWC,KAAI5C,GAAQA,EAAK6C,KAAKpB,EAAKoB,KAAKC,KAAKrB,IACzDc,KAAKvC,EAAK+C,KAAKD,KAAK9C,EAAMjN,IAAIiQ,QAAQhD,EAAKvD,OAAOqG,KAAK9C,OAC1D,aAAayC,QAAQQ,QAAQ,GAAGC,OAAO9S,MAAM,GAAIoS,GAClD,CAEA,GAAA7U,CAAImD,GAEH,MAAMiP,EAAO,IAAI7I,EAAO,IAAMpG,EAAK4M,IAAK5M,EAAKqS,SACvCnD,EAAO,IAAI/E,EACjB8E,EAAK1L,IAAIsG,QAAU,KAElBjL,KAAKgE,OAAOyM,UAAUjG,QAAQpJ,EAAK4M,MAC5B,GAERsC,EAAKxL,IAAIuL,GACTrQ,KAAKgK,MAAMlF,IAAIwL,EAChB,EChEM,MAAMoD,UAAsBrM,EAElC,WAAA/E,CAAY0B,GAEXkD,QACAA,MAAMrB,MAAM,YAEZ,MAAM8F,EAAU3H,EAAO2H,QACjBnN,EAAO,CACZ,mBACA,4BACA,4BACA,0BACA,0BACA,oCAEKuS,EAAc,IAAInJ,EAAO+D,EAAQ3N,IAAIQ,EAAK,KAAK0H,SAAS,SAC9DlG,KAAK8E,IAAI,IAAI2G,EAAMsF,GAAa3K,SAAS,WAEzC,MAAMuN,EAAgB,IAAIrM,EAAQqE,EAAQ3N,IAAIQ,EAAK,IAAK,eAClDoV,EAAc,IAAIxM,EAClBnD,GAAW,IAAI8D,GAAWI,WAAW,CAC1C/D,GAAI,UACJC,GAAI,SACJC,GAAI,WACJC,GAAI,YAELN,EAASU,IAAIsE,SAAY5L,IAExB2G,EAAO5D,KAAK,kBAAmB/C,EAAEyP,OAAO3P,MAAM,EAE/C8G,EAAS4B,MAAM,eACf+N,EAAY9O,IAAI6O,GAChBC,EAAY9O,IAAIb,GAEhB,MAAM4P,EAAgB,IAAIvM,EAAQqE,EAAQ3N,IAAIQ,EAAK,IAAK,YAClDsV,EAAc,IAAI1M,EAClB2M,EAAW,IAAIlL,EAAS,IAAK,GACnCkL,EAASpP,IAAIsE,SAAY5L,IAExB2G,EAAO5D,KAAK,gBAAiB,CAC5B2T,SAAUC,SAAS3W,EAAEyP,OAAO3P,QAC3B,EAEH4W,EAASlO,MAAM,YACfiO,EAAYhP,IAAI+O,GAChBC,EAAYhP,IAAIiP,GAIhB,MAAME,EAAc,IAAI3M,EAAQqE,EAAQ3N,IAAIQ,EAAK,IAAK,UAChD0V,EAAY,IAAI9M,EAChB+M,GAAS,IAAIpM,GAAWI,WAAW,CACxCiM,UAAW,YACXC,SAAU,aAEXF,EAAOxP,IAAIsE,SAAY5L,IAEtB2G,EAAO5D,KAAK,cAAe/C,EAAEyP,OAAO3P,OAEb,aAAnBE,EAAEyP,OAAO3P,MACZ6G,EAAO5D,KAAK,gBAAiB,CAC5BkU,IAAK,OACLvL,SAAK7K,IAGN8F,EAAO5D,KAAK,gBAAiB,CAC5BkU,SAAKpW,EACL6K,SAAK7K,GAEP,EAEDiW,EAAOtO,MAAM,UACbqO,EAAUpP,IAAImP,GACdC,EAAUpP,IAAIqP,GAId,MAAMI,EAAiB,IAAI1L,EAAS,IAAK,GACnC2L,EAAc,IAAIlN,EAAQqE,EAAQ3N,IAAIQ,EAAK,IAAK,UAChDiW,EAAY,IAAIrN,EAChByI,GAAS,IAAI9H,GAAWI,WAAW,CACxCuM,KAAM,OACNC,KAAM,SAEP9E,EAAOlL,IAAIsE,SAAY5L,IAEtB2G,EAAO5D,KAAK,gBAAiB,CAC5BkU,IAAKjX,EAAEyP,OAAO3P,MACd4L,SAAK7K,IAENqW,EAAe5P,IAAIwM,SAA8B,SAAnB9T,EAAEyP,OAAO3P,KAAgB,EAExD0S,EAAOhK,MAAM,UAEb4O,EAAU3P,IAAI0P,GACdC,EAAU3P,IAAI+K,GAEd,MAAM+E,EAAsB,IAAItN,EAAQqE,EAAQ3N,IAAIQ,EAAK,IAAK,oBACxDqW,EAAoB,IAAIzN,EAC9BmN,EAAe5P,IAAIsE,SAAY5L,IAE9B2G,EAAO5D,KAAK,gBAAiB,CAC5BkU,SAAKpW,EACL6K,IAAKiL,SAAS3W,EAAEyP,OAAO3P,QACtB,EAEHoX,EAAe1O,MAAM,oBACrBgP,EAAkB/P,IAAI8P,GACtBC,EAAkB/P,IAAIyP,GAItB,MAAMO,EAAgBnJ,EAAQ3N,IAAI,+BAC5B+W,EAAgB,IAAI3N,EACpB4N,EAAa,IAAI1M,EAAQ,YAAY,EAAOwM,EAAc,IAChEE,EAAWnP,MAAM,cACjBmP,EAAWrQ,IAAIsG,QAAW5N,IAAD,EAKzB0X,EAAcjQ,IAAI,IAAIwC,EAAQwN,EAAc,GAAI,eAChDC,EAAcjQ,IAAIkQ,GAElBhV,KAAK8E,IAAI,IAAI2G,EAAM,CAClBmI,EACAE,EACAI,EACAO,EACAI,KAMD7Q,EAAO/D,GAAG,aAAcyP,IAEvBzL,EAAS6D,SAAS4H,EAAIzL,UACtB8P,EAASjM,SAAS4H,EAAIuF,OAAOlB,UAC7BI,EAAOrM,SAAS4H,EAAIC,MACpBE,EAAO/H,SAAS4H,EAAIG,OAAOyE,KAC3BC,EAAezM,SAAS4H,EAAIG,OAAO9G,KACnCwL,EAAe5P,IAAIwM,SAA8B,SAAnBzB,EAAIG,OAAOyE,GAAc,IAGxDtQ,EAAO/D,GAAG,UAAW2P,IAED,aAAfA,EAAMD,MACTE,EAAO/H,SAAS,QAChB+H,EAAOlL,IAAIwM,UAAW,EACtBoD,EAAe5P,IAAIwM,UAAW,GAE9BtB,EAAOlL,IAAIwM,UAAW,CACvB,IAGDnN,EAAO/D,GAAG,mBAAoB9C,IAE7B4T,EAAYjK,eAAe6E,EAAQ3N,IAAIQ,EAAK,KAC5CmV,EAAc7M,eAAe6E,EAAQ3N,IAAIQ,EAAK,KAC9CqV,EAAc/M,eAAe6E,EAAQ3N,IAAIQ,EAAK,KAC9CyV,EAAYnN,eAAe6E,EAAQ3N,IAAIQ,EAAK,KAC5CgW,EAAY1N,eAAe6E,EAAQ3N,IAAIQ,EAAK,KAC5CoW,EAAoB9N,eAAe6E,EAAQ3N,IAAIQ,EAAK,IAAI,GAE1D,ECtKM,MAAM0W,UAAsB7N,EAElC,WAAA/E,CAAY0B,GAEXkD,QACA,MAAMyE,EAAU3H,EAAO2H,QACjBnN,EAAO,CACZ,mBACA,2BACA,+BACA,8BACA,4BACA,2BACA,6BACA,0BAEKuS,EAAc,IAAInJ,EAAO+D,EAAQ3N,IAAIQ,EAAK,KAAK0H,SAAS,SAC9DlG,KAAK8E,IAAI,IAAI2G,EAAMsF,GAAa3K,SAAS,WAEzC,MAAM+O,EAAe,IAAIvN,EAAO+D,EAAQ3N,IAAIQ,EAAK,KAAK0H,SAAS,SACzDkP,GAAe,IAAIxN,GAAS1B,SAAS,SACrCmP,EAAa,IAAIjO,EACvBiO,EAAWvQ,IAAI,CAACqQ,EAAcC,IAE9B,MAAME,EAAmB,IAAI1N,EAAO+D,EAAQ3N,IAAIQ,EAAK,KAAK0H,SAAS,SAC7DqP,GAAmB,IAAI3N,GAAS1B,SAAS,SACzCsP,EAAiB,IAAIpO,EAC3BoO,EAAe1Q,IAAI,CAACwQ,EAAkBC,IAEtC,MAAME,EAAkB,IAAI7N,EAAO+D,EAAQ3N,IAAIQ,EAAK,KAAK0H,SAAS,SAC5DwP,GAAkB,IAAI9N,GAAS1B,SAAS,SACxCyP,EAAgB,IAAIvO,EAC1BuO,EAAc7Q,IAAI,CAAC2Q,EAAiBC,IAEpC,MAAM/B,EAAgB,IAAI/L,EAAO+D,EAAQ3N,IAAIQ,EAAK,KAAK0H,SAAS,SAC1D0P,GAAgB,IAAIhO,GAAS1B,SAAS,SACtC0N,EAAc,IAAIxM,EACxBwM,EAAY9O,IAAI,CAAC6O,EAAeiC,IAEhC,MAAMC,EAAe,IAAIjO,EAAO+D,EAAQ3N,IAAIQ,EAAK,KAAK0H,SAAS,SACzD4P,GAAe,IAAIlO,GAAS1B,SAAS,SACrC6P,EAAa,IAAI3O,EACvB2O,EAAWjR,IAAI,CAAC+Q,EAAcC,IAE9B,MAAME,EAAiB,IAAIpO,EAAO+D,EAAQ3N,IAAIQ,EAAK,KAAK0H,SAAS,SAC3D+P,GAAiB,IAAIrO,GAAS1B,SAAS,SACvCgQ,EAAe,IAAI9O,EACzB8O,EAAapR,IAAI,CAACkR,EAAgBC,IAElC,MAAME,EAAa,IAAIvO,EAAO+D,EAAQ3N,IAAIQ,EAAK,KAAK0H,SAAS,SACvDkQ,GAAa,IAAIxO,GAAS1B,SAAS,SACnCmQ,EAAW,IAAIjP,EACrBiP,EAASvR,IAAI,CAACqR,EAAYC,IAE1BpW,KAAK6F,MAAM,YACX7F,KAAK8E,IAAI,IAAI2G,EAAM,CAClB4J,EACAG,EACAG,EACA/B,EACAmC,EACAG,EACAG,KAKDrS,EAAO/D,GAAG,YAAaqW,IAEtB1R,SAAS8B,MAAQ4P,EAAK5P,MAElB4P,EAAKC,SACRnB,EAAatN,SAASwO,EAAKC,SAC3BnB,EAAazQ,IAAI+B,MAAQ4P,EAAKC,SAE9BnB,EAAatN,SAAS,KAGnBwO,EAAKE,aACRjB,EAAiBzN,SAASwO,EAAKE,aAC/BjB,EAAiB5Q,IAAI+B,MAAQ4P,EAAKE,aAElCjB,EAAiBzN,SAAS,KAGvBwO,EAAKG,YACRf,EAAgB5N,SAASwO,EAAKG,YAC9Bf,EAAgB/Q,IAAI+B,MAAQ4P,EAAKG,YAEjCf,EAAgB5N,SAAS,KAGtBwO,EAAKrS,UACR2R,EAAc9N,SAASwO,EAAKrS,UAC5B2R,EAAcjR,IAAI+B,MAAQ4P,EAAKrS,UAE/B2R,EAAc9N,SAAS,KAGpBwO,EAAKI,SACRZ,EAAahO,SAASwO,EAAKI,SAC3BZ,EAAanR,IAAI+B,MAAQ4P,EAAKI,SAE9BZ,EAAahO,SAAS,KAGnBwO,EAAKK,WACRV,EAAenO,SAASwO,EAAKK,WAC7BV,EAAetR,IAAI+B,MAAQ4P,EAAKK,WAEhCV,EAAenO,SAAS,KAGrBwO,EAAK5P,OACR0P,EAAWtO,SAASwO,EAAK5P,OACzB0P,EAAWzR,IAAI+B,MAAQ4P,EAAK5P,OAE5B0P,EAAWtO,SAAS,IACrB,IAGD9D,EAAO/D,GAAG,mBAAoB9C,IAE7B4T,EAAYjJ,SAAS6D,EAAQ3N,IAAIQ,EAAK,KACtC2W,EAAarN,SAAS6D,EAAQ3N,IAAIQ,EAAK,KACvC8W,EAAiBxN,SAAS6D,EAAQ3N,IAAIQ,EAAK,KAC3CiX,EAAgB3N,SAAS6D,EAAQ3N,IAAIQ,EAAK,KAC1CmV,EAAc7L,SAAS6D,EAAQ3N,IAAIQ,EAAK,KACxCqX,EAAa/N,SAAS6D,EAAQ3N,IAAIQ,EAAK,KACvCwX,EAAelO,SAAS6D,EAAQ3N,IAAIQ,EAAK,KACzC2X,EAAWrO,SAAS6D,EAAQ3N,IAAIQ,EAAK,IAAI,GAE3C,EC9HM,MAAMoY,EAEZ,WAAAtU,CAAY0B,GAEX,MAAM2H,EAAU3H,EAAO2H,QACjBkL,EAAW7S,EAAOE,SAClB1F,EAAO,CACZ,gBACA,mBACA,oBACA,sBACA,iBACA,mBACA,oBAGKoN,EAAY,IAAIrC,EAAc,YAAY1D,MAAM,WAEhDiG,GAAY,IAAI3E,GAAQtB,MAAM,SAASO,SAAS,OAChD2F,EAAY,IAAIzD,EAAQ,UAC9ByD,EAAUpF,SAASgF,EAAQ3N,IAAIQ,EAAK,KACpCuN,EAAUpH,IAAIsG,QAAW5N,IAExB2G,EAAO5D,KAAK,iBAAiB,GAC7B/C,EAAE6N,iBACFa,EAAUpH,IAAI0H,MAAM,EAErBP,EAAUhH,IAAIiH,GACdH,EAAU7B,QAAQ+B,GAElBF,EAAU3B,OAAO,QAAS0B,EAAQ3N,IAAIQ,EAAK,IAAK,IAAIwR,EAAShM,IACzD6S,EAAS9I,WACZnC,EAAU3B,OAAO,QAAS0B,EAAQ3N,IAAIQ,EAAK,IAAK,IAAIsS,EAAe9M,IAEhE6S,EAASzE,aACZxG,EAAU3B,OAAO,QAAS0B,EAAQ3N,IAAIQ,EAAK,IAAK,IAAIyT,EAAiBjO,IAEtE4H,EAAU3B,OAAO,QAAS0B,EAAQ3N,IAAIQ,EAAK,IAAK,IAAI+T,EAAYvO,IAChE4H,EAAU3B,OAAO,QAAS0B,EAAQ3N,IAAIQ,EAAK,IAAK,IAAIkV,EAAc1P,IAClE4H,EAAU3B,OAAO,QAAS0B,EAAQ3N,IAAIQ,EAAK,IAAK,IAAI0W,EAAclR,IAClE4H,EAAUtB,OAAO,SAEjB1F,SAAS+J,KAAK3J,YAAY4G,EAAUjH,KAIpCX,EAAO/D,GAAG,iBAAkB9C,IAEvBA,EACHyO,EAAU1F,SAAS,QAEnB0F,EAAU5F,gBAAgB,QAC3B,IAGDhC,EAAO/D,GAAG,mBAAoB9C,IAE7B4O,EAAUpF,SAASgF,EAAQ3N,IAAIQ,EAAK,KACpCoN,EAAUnB,SAAS,QAASkB,EAAQ3N,IAAIQ,EAAK,KACzCqY,EAAS9I,WACZnC,EAAUnB,SAAS,QAASkB,EAAQ3N,IAAIQ,EAAK,KAE1CqY,EAASzE,aACZxG,EAAUnB,SAAS,QAASkB,EAAQ3N,IAAIQ,EAAK,KAE9CoN,EAAUnB,SAAS,QAASkB,EAAQ3N,IAAIQ,EAAK,KAC7CoN,EAAUnB,SAAS,QAASkB,EAAQ3N,IAAIQ,EAAK,KAC7CoN,EAAUnB,SAAS,QAASkB,EAAQ3N,IAAIQ,EAAK,IAAI,GAEnD,EC1EM,MAAMsY,EAET,WAAAxU,CAAY0B,GAER,MAAM4H,GAAY,IAAIzE,GAAQtB,MAAM,WAC9B8F,EAAU3H,EAAO2H,QACjBnN,EAAO,CACT,gBACA,eAEE0L,EAAQ,IAAI5C,EAAQqE,EAAQ3N,IAAIQ,EAAK,IAAK,cAC1CuY,EAAU,IAAIzO,EAAQ,OAAQ,IAAIzC,MAAM,cAC9CkR,EAAQpS,IAAIqS,QAAW3Z,IAEnB2C,KAAKkR,SACL7T,EAAE6N,gBAAgB,EAGtB,MAAM+L,EAAS,IAAI3O,EAAQ,SAAUqD,EAAQ3N,IAAIQ,EAAK,KACtDyY,EAAOtS,IAAIwM,UAAW,EACtB8F,EAAOtS,IAAIsG,QAAW5N,IAElB,MAAMgV,EAAO,CACTrE,IAAKhO,KAAKgO,IACVkJ,KAAM,IAAIxT,KACVqD,KAAMgQ,EAAQlP,WACdpE,KAAMA,KAEVzD,KAAKmX,WAAQjZ,EACb8F,EAAOE,SAASkO,YAAY9Q,KAAK+Q,GACjCrO,EAAO5D,KAAK,YAAaiS,GACzBzG,EAAU5F,gBAAgB,SAC1B3I,EAAE6N,iBACF+L,EAAOtS,IAAI0H,MAAM,EAGrBrM,KAAKkR,OAAS,KAEV+F,EAAOtS,IAAIwM,WAAanR,KAAKmX,OAASJ,EAAQlP,WAAWnK,OAAS,EAAE,EAGxEkO,EAAU9G,IAAI,IAAI2G,EAAM,CAACvB,EAAO6M,EAASE,IAAS7Q,SAAS,YAC3DxB,SAAS+J,KAAK3J,YAAY4G,EAAUjH,KAIpCX,EAAO/D,GAAG,YAAY,CAAC+N,EAAKoJ,KAExBpX,KAAKgO,IAAMA,EACXhO,KAAKmX,MAAQC,EAASD,MAAMnJ,GAC5BhO,KAAKkR,SACLtF,EAAU1F,SAAS,QACnB6Q,EAAQjP,SAAS,GAAG,IAGxB9D,EAAO/D,GAAG,cAAc,KAEpBD,KAAKmX,WAAQjZ,EACb8B,KAAKkR,SACLtF,EAAU5F,gBAAgB,QAAQ,IAGtChC,EAAO/D,GAAG,mBAAoB9C,IAE1B+M,EAAMpD,eAAe6E,EAAQ3N,IAAIQ,EAAK,KACtCyY,EAAOnP,SAAS6D,EAAQ3N,IAAIQ,EAAK,IAAI,GAE7C,EC7DG,MAAM6Y,EAEZ,WAAA/U,CAAYgV,EAAUpT,GAErBlE,KAAKkE,cAAWhG,EAChB8B,KAAKuX,SbiCa,CACZ,WACA,cACA,UACA,QACA,QACA,iBACA,UAEWC,MAAM1Y,GAAM2Y,UAAUC,UAAUC,MAAM7Y,KazCvDkB,KAAK4X,QAAQN,EAAUpT,GAEvBlE,KAAK2L,QAAU,IAAI5H,EAAQ/D,MAC3BA,KAAK6X,QAAU,IAAInM,EAAQ1L,MAC3BA,KAAK8X,QAAU,IAAI1I,EAAQpP,MAC3BA,KAAK+X,QAAU,IAAInB,EAAQ5W,MACvBA,KAAKkE,SAASkO,cACjBpS,KAAKgY,QAAU,IAAIlB,EAAQ9W,OAG5BA,KAAK+R,UAAO7T,EACZ8B,KAAKyQ,eAAYvS,EACjB8B,KAAKiY,eAAY/Z,EAEjB8B,KAAKgN,OAELG,OAAO+K,eAAiBlY,KAAK+M,OAAOqG,KAAKpT,MACzCmN,OAAOgL,aAAenY,KAAKoY,YAAYhF,KAAKpT,MAC5CmN,OAAO5E,UAAYvI,KAAKqY,gBAAgBjF,KAAKpT,MAC7CmN,OAAOmL,QAAWjb,IACbA,EAAEkb,SACLlb,EAAE6N,gBACH,CAEF,CAOA,IAAA8B,CAAKsK,EAAUpT,GAEdlE,KAAKI,KAAK,iBACVJ,KAAK0Q,SAAW,CAAC,EAEbjT,UAAUC,OAAS,GAEtBsC,KAAK4X,QAAQN,EAAUpT,GAGxBlE,KAAK+R,KAAOyG,KAAKxY,KAAKkE,SAASoT,UAC/BtX,KAAKyQ,UAAYzQ,KAAK+R,KAAK0G,SAAS,SAAU,CAC7CC,QAAS1Y,KAAKuX,SAAW,aAAe,UACxC5H,KAAM3P,KAAKkE,SAASyL,KACpBE,OAAQ7P,KAAKkE,SAAS2L,OAAOyE,IAC7BC,eAAgBvU,KAAKkE,SAAS2L,OAAO9G,IACrC6B,MAAO,OACPE,OAAQ,OACR6N,MAAM,IAGP,MAAM3K,EAAMhO,KAAKkE,SAAS0U,oBAEzB5Y,KAAKiY,UADFjK,EACchO,KAAKyQ,UAAUjG,QAAQwD,GAEvBhO,KAAKyQ,UAAUjG,UAGjCxK,KAAKiY,UAAUpF,MAAMzB,IACpBpR,KAAKI,KAAK,YAAagR,EAAUpR,KAAKkE,SAAS,IAGhDlE,KAAK+R,KAAK8G,MAAMhG,MAAK,KACpB7S,KAAKI,KAAK,YAAaJ,KAAKkE,SAAS,IACnC2O,MAAK,KACP7S,KAAKI,KAAK,aAAa,IAGxBJ,KAAK+R,KAAK+G,OAAOC,SAASlG,MAAMyD,IAC/BtW,KAAKI,KAAK,WAAYkW,EAAK,IAG5BtW,KAAK+R,KAAK+G,OAAOE,WAAWnG,MAAM5C,IACjCjQ,KAAKI,KAAK,aAAc6P,EAAI,IAG7BjQ,KAAKyQ,UAAUxQ,GAAG,SAAU5C,IAEJ,UADLA,EAAE4b,KAAKrU,SAASsU,eACpBlY,MACbhB,KAAKI,KAAK,aACX,IAGDJ,KAAKyQ,UAAUxQ,GAAG,UAAW2P,IAC5B5P,KAAKI,KAAK,SAAUwP,EAAM,IAG3B5P,KAAKyQ,UAAUxQ,GAAG,YAAY,CAACkZ,EAAU/B,KACxCpX,KAAKoZ,YAAYD,GACjBnZ,KAAKI,KAAK,WAAY+Y,EAAU/B,EAAS,IAG1CpX,KAAKyQ,UAAUxQ,GAAG,aAAcmN,IAC/BpN,KAAKoZ,YAAYhM,EAASwB,MAAMZ,KAChChO,KAAKI,KAAK,YAAagN,EAAS,IAGjCpN,KAAKyQ,UAAUxQ,GAAG,UAAWD,KAAKqY,gBAAgBjF,KAAKpT,OAEvDA,KAAKC,GAAG,QAAQ,KAC8B,QAAzCD,KAAK+R,KAAKsH,QAAQN,SAASO,UAC9BtZ,KAAKyQ,UAAUlB,OAEfvP,KAAKyQ,UAAUpB,MAChB,IAGDrP,KAAKC,GAAG,QAAQ,KAC8B,QAAzCD,KAAK+R,KAAKsH,QAAQN,SAASO,UAC9BtZ,KAAKyQ,UAAUpB,OAEfrP,KAAKyQ,UAAUlB,MAChB,IAGDvP,KAAKC,GAAG,mBAAoB9C,IAC3B6C,KAAKkE,SAASD,SAAW9G,CAAK,IAG/B6C,KAAKC,GAAG,eAAgB9C,IACvB6C,KAAKkE,SAASyL,KAAOxS,EACrB6C,KAAKyQ,UAAUd,KAAKxS,EAAM,IAG3B6C,KAAKC,GAAG,iBAAkB9C,IACzB,MAAMmX,EAAMnX,EAAMmX,KAAOtU,KAAKkE,SAAS2L,OAAOyE,IACxCvL,EAAM5L,EAAM4L,KAAO/I,KAAKkE,SAAS2L,OAAO9G,IAC9C/I,KAAKkE,SAAS2L,OAAOyE,IAAMA,EAC3BtU,KAAKkE,SAAS2L,OAAO9G,IAAMA,EAC3B/I,KAAKyQ,UAAUZ,OAAOyE,EAAKvL,EAAI,IAGhC/I,KAAKC,GAAG,iBAAkB9C,IACzB,MAAM4W,EAAW5W,EAAM4W,SACvB/T,KAAKkE,SAAS+Q,OAAOlB,SAAWA,EAChC/T,KAAKyQ,UAAU8I,OAAOxF,SAASA,EAAW,IAAI,GAEhD,CAIA,cAAAnC,CAAe5D,GAEd,MACM6D,EADQ7R,KAAKyQ,UAAU+I,SAASxL,GAClByL,eAAeC,WAAW5T,GAExC2B,EADWzH,KAAKyQ,UAAUkJ,kBACV/K,MAAMnH,KAC5B,OAAOzH,KAAK0Q,SAASjJ,EAAO,IAAMoK,IAAU7R,KAAK0Q,SAASjJ,EAC3D,CASA,YAAAyG,CAAaF,GAEZ,OAAOhO,KAAKkE,SAAS6J,UAAUjO,QAAQkO,EACxC,CAIA,WAAA4L,CAAYvH,GAEX,OAAOrS,KAAKkE,SAASkO,YAAYtS,QAAQuS,EAC1C,CASA,OAAAuF,CAAQN,EAAUpT,GAEjBlE,KAAK6Z,SAAWC,IAAIxC,GAAUnV,WAC9BnC,KAAKkE,SAAW,CACfoT,SAAUA,EACVlL,OAAQpM,KAAKuX,SAAW,OAAS,UACjCtK,SAAS,EACTK,SAAS,EACTX,UAAU,EACV1I,SAAU,KACVuM,eAAWtS,EACX6P,UAAW,GACXqE,YAAa,GACbzC,KAAM,YACNE,OAAQ,CACPyE,IAAK,OACLvL,IAAK,KAENkM,OAAQ,CACPlB,SAAU,KAEXiB,gBAAY9W,EACZiQ,WAAYvJ,SAASmV,mBAGtBvW,EAAOU,GAAY,CAAC,EAAGlE,KAAKkE,UAExBlE,KAAKkE,SAAS+I,QACjBjN,KAAKga,mBAAmB9V,GAAY,CAAC,GAErClE,KAAKia,qBAEP,CAMA,OAAAC,GAEC,OAAOC,cAAwD,OAAxCA,aAAaC,QAAQpa,KAAK6Z,SAClD,CAOA,mBAAAI,GAEC,QAAKja,KAAKka,YAGVC,aAAaE,WAAWra,KAAK6Z,WACtB,EACR,CAOA,kBAAAG,CAAmBM,GAElB,IAAKta,KAAKka,UACT,OAAO,EAER,IAAIK,EACJ,IACCA,EAASC,KAAKC,MAAMN,aAAaC,QAAQpa,KAAK6Z,UAC/C,CAAE,MAAOxc,GACR+H,QAAQsV,UAAUrd,EACnB,CAEA,QAAIkd,IACH/W,EAAO+W,EAAQva,KAAKkE,SAAUoW,IACvB,EAIT,CAKA,YAAAK,GAEC3a,KAAKkE,SAAS0U,oBAAsB5Y,KAAKyQ,UAAUrD,SAASwB,MAAMZ,IAClE,MAAM0B,EAAMvR,OAAOtB,OAAO,CAAC,EAAGmD,KAAKkE,iBAC5BwL,EAAItD,cACJsD,EAAIpC,eACJoC,EAAIzC,eACJyC,EAAI/C,gBACJ+C,EAAIsF,kBACJtF,EAAIvB,WACXgM,aAAaS,QAAQ5a,KAAK6Z,SAAUW,KAAKK,UAAUnL,GACpD,CAEA,WAAA0J,CAAYpL,GAEX,MAAM8M,EAAU9a,KAAK+R,KAAKgJ,cAAW7c,EAAY8B,KAAK+R,KAAKpK,IACrDA,EAAM,IAAIuF,IAAIC,OAAOC,SAAU0N,GACrCnT,EAAIqT,KAAO,IAAMhN,EAGbhO,KAAKkE,SAASoJ,SAAWH,OAAOC,SAAS4N,OAASrT,EAAIqT,OAEzD7N,OAAOG,QAAQC,UAAU,CAAC,EAAG,GAAI5F,GACjC3H,KAAKib,mBAAqBjN,EAE5B,CAIA,MAAAjB,GAEK/M,KAAKkE,SAAS+I,SAAWkN,cAC5Bna,KAAK2a,cAEP,CAEA,WAAAvC,GAEC,MAAM4C,EAAO7N,OAAOC,SAAS4N,KAAKpZ,MAAM,GACxC5B,KAAKyQ,UAAUjG,QAAQwQ,EACxB,CAEA,eAAA3C,CAAgBhb,GAGf,IAAIF,EAAQ6C,KAAKkE,SAAS+Q,OAAOlB,SAEjC,OAAQ1W,EAAE0B,KAET,IAAK,IACL,IAAK,IACJ5B,GAPW,EAQX6C,KAAKI,KAAK,gBAAiB,CAAE2T,SAAU5W,IACvC,MACD,IAAK,IACJA,GAXW,EAYX6C,KAAKI,KAAK,gBAAiB,CAAE2T,SAAU5W,IACvC,MACD,IAAK,IACJA,EAAQ,IACR6C,KAAKI,KAAK,gBAAiB,CAAE2T,SAAU5W,IACvC,MACD,IAAK,YACJ6C,KAAKI,KAAK,QACV,MACD,IAAK,aACJJ,KAAKI,KAAK,QAGb,EAGD,IAAaiX,EAAOhY,WC7Vb,MAAM6b,EAEZ,WAAA5Y,GAECtC,KAAKiG,KAAO,gBACZjG,KAAKmb,QAAU,EACfnb,KAAKob,SACLpb,KAAKqb,UAAYlO,OAAOkO,WACvBlO,OAAOmO,iBACPnO,OAAOoO,cACPpO,OAAOqO,YACPrO,OAAOsO,iBAEevd,IAAnB8B,KAAKqb,WAERvN,MAAM,mDAER,CAEA,IAAAd,CAAK0O,GAEJ,QAAuBxd,IAAnB8B,KAAKqb,UAER,YADAK,IAID,MAAMC,EAAQ3b,KACR4b,EAAUP,UAAUQ,KAAK7b,KAAKiG,KAAMjG,KAAKmb,SAC/CS,EAAQE,gBAAkB,SAAUC,GAEnC,MAAMC,EAAKD,EAAMjP,OAAOtN,QACwB,IAA5Cwc,EAAGC,iBAAiBlf,SAAS,YAEhCif,EAAGE,kBAAkB,UAEvB,EAEAN,EAAQO,UAAY,SAAUJ,GAE7BJ,EAAMP,SAAWW,EAAMjP,OAAOtN,OAC9Bmc,EAAMP,SAAS5N,QAAU,SAAUuO,GAElC3W,QAAQvG,MAAM,YAAakd,EAC5B,EACAL,GACD,EAEAE,EAAQpO,QAAU,SAAUuO,GAE3B3W,QAAQvG,MAAM,YAAakd,EAC5B,CACD,CAEA,GAAA/d,CAAI0d,QAEmBxd,IAAlB8B,KAAKob,SAKWpb,KAAKob,SAASgB,YAAY,CAAC,WAAY,aAC3BC,YAAY,WAChBre,IAAI,GACxBme,UAAY,SAAUJ,GAE7BL,EAASK,EAAMjP,OAAOtN,QACtB4F,QAAQkX,IAAI,cACb,EAXCZ,GAYF,CAEA,GAAAzd,CAAImD,EAAMsa,QAEaxd,IAAlB8B,KAAKob,SAKWpb,KAAKob,SAASgB,YAAY,CAAC,WAAY,aAC3BC,YAAY,WAChBE,IAAInb,EAAM,GAC9B+a,UAAY,WAEnBT,IACAtW,QAAQkX,IAAI,cACb,EAXCZ,GAYF,CAEA,KAAAhW,QAEuBxH,IAAlB8B,KAAKob,WAGWpb,KAAKob,SAASgB,YAAY,CAAC,WAAY,aAC3BC,YAAY,WAChB3W,QACpByW,UAAY,WAEnB/W,QAAQkX,IAAI,gBACb,EACD,EC9FDnP,OAAOqP,oBAAiBte,EACxBiP,OAAOP,OAAS,WAEf,MAAMC,EAAU,IAAIqO,EACdvT,EAAM,IAAIuF,IAAIC,OAAOC,UACrBqP,OAA4Bve,IAApBiP,OAAOmK,SAClBnK,OAAOmK,SACL3P,EAAI8K,OAAO/U,OAAS,EAAKiK,EAAI+U,aAAa1e,IAAI,YAAc,sCAEjE6O,EAAQG,MAAK,WAEZH,EAAQ7O,KAAI,SAAUoD,QAERlD,IAATkD,GAA4C,IAAtBuG,EAAI8K,OAAO/U,OAEpCyP,OAAOnJ,OAAS,IAAIqT,EAAOjW,GAI3B+L,OAAOnJ,OAAS,IAAIqT,EAAOoF,EAE7B,GACD,IAEAtP,OAAON,QAAUA,CAClB,EAEO,MAAM8P,EAAO,CAACF,EAAMlf,IAAY,IAAI8Z,EAAOoF,EAAMlf,GAAW,CAAC,E","sources":["webpack://epubreader/./node_modules/d/index.js","webpack://epubreader/./node_modules/es5-ext/function/noop.js","webpack://epubreader/./node_modules/es5-ext/object/assign/index.js","webpack://epubreader/./node_modules/es5-ext/object/assign/is-implemented.js","webpack://epubreader/./node_modules/es5-ext/object/assign/shim.js","webpack://epubreader/./node_modules/es5-ext/object/is-value.js","webpack://epubreader/./node_modules/es5-ext/object/keys/index.js","webpack://epubreader/./node_modules/es5-ext/object/keys/is-implemented.js","webpack://epubreader/./node_modules/es5-ext/object/keys/shim.js","webpack://epubreader/./node_modules/es5-ext/object/normalize-options.js","webpack://epubreader/./node_modules/es5-ext/object/valid-callable.js","webpack://epubreader/./node_modules/es5-ext/object/valid-value.js","webpack://epubreader/./node_modules/es5-ext/string/\u0000#/contains/index.js","webpack://epubreader/./node_modules/es5-ext/string/\u0000#/contains/is-implemented.js","webpack://epubreader/./node_modules/es5-ext/string/\u0000#/contains/shim.js","webpack://epubreader/./node_modules/event-emitter/index.js","webpack://epubreader/./node_modules/type/function/is.js","webpack://epubreader/./node_modules/type/object/is.js","webpack://epubreader/./node_modules/type/plain-function/is.js","webpack://epubreader/./node_modules/type/prototype/is.js","webpack://epubreader/./node_modules/type/value/is.js","webpack://epubreader/webpack/bootstrap","webpack://epubreader/webpack/runtime/compat get default export","webpack://epubreader/webpack/runtime/define property getters","webpack://epubreader/webpack/runtime/hasOwnProperty shorthand","webpack://epubreader/webpack/runtime/make namespace object","webpack://epubreader/./src/utils.js","webpack://epubreader/./src/strings.js","webpack://epubreader/./src/ui.js","webpack://epubreader/./src/toolbar.js","webpack://epubreader/./src/content.js","webpack://epubreader/./src/sidebar/toc.js","webpack://epubreader/./src/sidebar/bookmarks.js","webpack://epubreader/./src/sidebar/annotations.js","webpack://epubreader/./src/sidebar/search.js","webpack://epubreader/./src/sidebar/settings.js","webpack://epubreader/./src/sidebar/metadata.js","webpack://epubreader/./src/sidebar.js","webpack://epubreader/./src/notedlg.js","webpack://epubreader/./src/reader.js","webpack://epubreader/./src/storage.js","webpack://epubreader/./src/main.js"],"sourcesContent":["\"use strict\";\n\nvar isValue         = require(\"type/value/is\")\n  , isPlainFunction = require(\"type/plain-function/is\")\n  , assign          = require(\"es5-ext/object/assign\")\n  , normalizeOpts   = require(\"es5-ext/object/normalize-options\")\n  , contains        = require(\"es5-ext/string/#/contains\");\n\nvar d = (module.exports = function (dscr, value/*, options*/) {\n\tvar c, e, w, options, desc;\n\tif (arguments.length < 2 || typeof dscr !== \"string\") {\n\t\toptions = value;\n\t\tvalue = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[2];\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t\tw = contains.call(dscr, \"w\");\n\t} else {\n\t\tc = w = true;\n\t\te = false;\n\t}\n\n\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n});\n\nd.gs = function (dscr, get, set/*, options*/) {\n\tvar c, e, options, desc;\n\tif (typeof dscr !== \"string\") {\n\t\toptions = set;\n\t\tset = get;\n\t\tget = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[3];\n\t}\n\tif (!isValue(get)) {\n\t\tget = undefined;\n\t} else if (!isPlainFunction(get)) {\n\t\toptions = get;\n\t\tget = set = undefined;\n\t} else if (!isValue(set)) {\n\t\tset = undefined;\n\t} else if (!isPlainFunction(set)) {\n\t\toptions = set;\n\t\tset = undefined;\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t} else {\n\t\tc = true;\n\t\te = false;\n\t}\n\n\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n","\"use strict\";\n\n// eslint-disable-next-line no-empty-function\nmodule.exports = function () {};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.assign : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar assign = Object.assign, obj;\n\tif (typeof assign !== \"function\") return false;\n\tobj = { foo: \"raz\" };\n\tassign(obj, { bar: \"dwa\" }, { trzy: \"trzy\" });\n\treturn obj.foo + obj.bar + obj.trzy === \"razdwatrzy\";\n};\n","\"use strict\";\n\nvar keys  = require(\"../keys\")\n  , value = require(\"../valid-value\")\n  , max   = Math.max;\n\nmodule.exports = function (dest, src /*, …srcn*/) {\n\tvar error, i, length = max(arguments.length, 2), assign;\n\tdest = Object(value(dest));\n\tassign = function (key) {\n\t\ttry {\n\t\t\tdest[key] = src[key];\n\t\t} catch (e) {\n\t\t\tif (!error) error = e;\n\t\t}\n\t};\n\tfor (i = 1; i < length; ++i) {\n\t\tsrc = arguments[i];\n\t\tkeys(src).forEach(assign);\n\t}\n\tif (error !== undefined) throw error;\n\treturn dest;\n};\n","\"use strict\";\n\nvar _undefined = require(\"../function/noop\")(); // Support ES3 engines\n\nmodule.exports = function (val) { return val !== _undefined && val !== null; };\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.keys : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\ttry {\n\t\tObject.keys(\"primitive\");\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isValue = require(\"../is-value\");\n\nvar keys = Object.keys;\n\nmodule.exports = function (object) { return keys(isValue(object) ? Object(object) : object); };\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nvar forEach = Array.prototype.forEach, create = Object.create;\n\nvar process = function (src, obj) {\n\tvar key;\n\tfor (key in src) obj[key] = src[key];\n};\n\n// eslint-disable-next-line no-unused-vars\nmodule.exports = function (opts1 /*, …options*/) {\n\tvar result = create(null);\n\tforEach.call(arguments, function (options) {\n\t\tif (!isValue(options)) return;\n\t\tprocess(Object(options), result);\n\t});\n\treturn result;\n};\n","\"use strict\";\n\nmodule.exports = function (fn) {\n\tif (typeof fn !== \"function\") throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) throw new TypeError(\"Cannot use null or undefined\");\n\treturn value;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? String.prototype.contains : require(\"./shim\");\n","\"use strict\";\n\nvar str = \"razdwatrzy\";\n\nmodule.exports = function () {\n\tif (typeof str.contains !== \"function\") return false;\n\treturn str.contains(\"dwa\") === true && str.contains(\"foo\") === false;\n};\n","\"use strict\";\n\nvar indexOf = String.prototype.indexOf;\n\nmodule.exports = function (searchString /*, position*/) {\n\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n};\n","'use strict';\n\nvar d        = require('d')\n  , callable = require('es5-ext/object/valid-callable')\n\n  , apply = Function.prototype.apply, call = Function.prototype.call\n  , create = Object.create, defineProperty = Object.defineProperty\n  , defineProperties = Object.defineProperties\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , descriptor = { configurable: true, enumerable: false, writable: true }\n\n  , on, once, off, emit, methods, descriptors, base;\n\non = function (type, listener) {\n\tvar data;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) {\n\t\tdata = descriptor.value = create(null);\n\t\tdefineProperty(this, '__ee__', descriptor);\n\t\tdescriptor.value = null;\n\t} else {\n\t\tdata = this.__ee__;\n\t}\n\tif (!data[type]) data[type] = listener;\n\telse if (typeof data[type] === 'object') data[type].push(listener);\n\telse data[type] = [data[type], listener];\n\n\treturn this;\n};\n\nonce = function (type, listener) {\n\tvar once, self;\n\n\tcallable(listener);\n\tself = this;\n\ton.call(this, type, once = function () {\n\t\toff.call(self, type, once);\n\t\tapply.call(listener, this, arguments);\n\t});\n\n\tonce.__eeOnceListener__ = listener;\n\treturn this;\n};\n\noff = function (type, listener) {\n\tvar data, listeners, candidate, i;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return this;\n\tdata = this.__ee__;\n\tif (!data[type]) return this;\n\tlisteners = data[type];\n\n\tif (typeof listeners === 'object') {\n\t\tfor (i = 0; (candidate = listeners[i]); ++i) {\n\t\t\tif ((candidate === listener) ||\n\t\t\t\t\t(candidate.__eeOnceListener__ === listener)) {\n\t\t\t\tif (listeners.length === 2) data[type] = listeners[i ? 0 : 1];\n\t\t\t\telse listeners.splice(i, 1);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ((listeners === listener) ||\n\t\t\t\t(listeners.__eeOnceListener__ === listener)) {\n\t\t\tdelete data[type];\n\t\t}\n\t}\n\n\treturn this;\n};\n\nemit = function (type) {\n\tvar i, l, listener, listeners, args;\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return;\n\tlisteners = this.__ee__[type];\n\tif (!listeners) return;\n\n\tif (typeof listeners === 'object') {\n\t\tl = arguments.length;\n\t\targs = new Array(l - 1);\n\t\tfor (i = 1; i < l; ++i) args[i - 1] = arguments[i];\n\n\t\tlisteners = listeners.slice();\n\t\tfor (i = 0; (listener = listeners[i]); ++i) {\n\t\t\tapply.call(listener, this, args);\n\t\t}\n\t} else {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tcall.call(listeners, this);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcall.call(listeners, this, arguments[1]);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tcall.call(listeners, this, arguments[1], arguments[2]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tl = arguments.length;\n\t\t\targs = new Array(l - 1);\n\t\t\tfor (i = 1; i < l; ++i) {\n\t\t\t\targs[i - 1] = arguments[i];\n\t\t\t}\n\t\t\tapply.call(listeners, this, args);\n\t\t}\n\t}\n};\n\nmethods = {\n\ton: on,\n\tonce: once,\n\toff: off,\n\temit: emit\n};\n\ndescriptors = {\n\ton: d(on),\n\tonce: d(once),\n\toff: d(off),\n\temit: d(emit)\n};\n\nbase = defineProperties({}, descriptors);\n\nmodule.exports = exports = function (o) {\n\treturn (o == null) ? create(base) : defineProperties(Object(o), descriptors);\n};\nexports.methods = methods;\n","\"use strict\";\n\nvar isPrototype = require(\"../prototype/is\");\n\nmodule.exports = function (value) {\n\tif (typeof value !== \"function\") return false;\n\n\tif (!hasOwnProperty.call(value, \"length\")) return false;\n\n\ttry {\n\t\tif (typeof value.length !== \"number\") return false;\n\t\tif (typeof value.call !== \"function\") return false;\n\t\tif (typeof value.apply !== \"function\") return false;\n\t} catch (error) {\n\t\treturn false;\n\t}\n\n\treturn !isPrototype(value);\n};\n","\"use strict\";\n\nvar isValue = require(\"../value/is\");\n\n// prettier-ignore\nvar possibleTypes = { \"object\": true, \"function\": true, \"undefined\": true /* document.all */ };\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) return false;\n\treturn hasOwnProperty.call(possibleTypes, typeof value);\n};\n","\"use strict\";\n\nvar isFunction = require(\"../function/is\");\n\nvar classRe = /^\\s*class[\\s{/}]/, functionToString = Function.prototype.toString;\n\nmodule.exports = function (value) {\n\tif (!isFunction(value)) return false;\n\tif (classRe.test(functionToString.call(value))) return false;\n\treturn true;\n};\n","\"use strict\";\n\nvar isObject = require(\"../object/is\");\n\nmodule.exports = function (value) {\n\tif (!isObject(value)) return false;\n\ttry {\n\t\tif (!value.constructor) return false;\n\t\treturn value.constructor.prototype === value;\n\t} catch (error) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\n// ES3 safe\nvar _undefined = void 0;\n\nmodule.exports = function (value) { return value !== _undefined && value !== null; };\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const d = (obj, prop) => obj ? obj[prop] : undefined\n\nconst q = (src, dst, ext, prop) => {\n    let val\n    if (typeof dst[prop] === \"boolean\") {\n        switch (prop) {\n            case \"annotations\":\n            case \"bookmarks\":\n                val = dst[prop] ? src[prop] : dst[prop]\n                break;\n            default:\n                val = dst[prop]\n                break;\n        }\n    } else if (prop === \"arrows\") {\n        val = dst[prop]\n    } else {\n        val = d(ext, prop) === undefined ? src[prop] : dst[prop]\n    }\n    return val\n}\n\nexport const extend = (src, dst, ext) => {\n    for (let prop in src) {\n        if (prop === \"bookPath\") {\n            continue\n        } else if (dst[prop] instanceof Array) {\n            dst[prop] = ext ? (src[prop] ? src[prop] : dst[prop]) : src[prop]\n        } else if (dst[prop] instanceof Object) {\n            extend(src[prop], dst[prop], d(ext, prop)) // recursive call\n        } else {\n            dst[prop] = ext ? q(src, dst, ext, prop) : src[prop]\n        }\n    }\n}\n\nexport const uuid = () => {\n    let d = new Date().getTime()\n    const uuid = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, (c) => {\n        let r = (d + Math.random() * 16) % 16 | 0\n        d = Math.floor(d / 16)\n        return (c === \"x\" ? r : (r & 0x7 | 0x8)).toString(16)\n    })\n    return uuid\n}\n\nexport const detectMobile = () => {\n    const matches = [\n        /Android/i,\n        /BlackBerry/i,\n        /iPhone/i,\n        /iPad/i,\n        /iPod/i,\n        /Windows Phone/i,\n        /webOS/i\n    ]\n    return matches.some((i) => navigator.userAgent.match(i))\n}","export class Strings {\n\n\tconstructor(reader) {\n\n\t\tthis.language = reader.settings.language || \"en\";\n\t\tthis.values = {\n\t\t\ten: {\n\t\t\t\t\"toolbar/sidebar\": \"Sidebar\",\n\t\t\t\t\"toolbar/prev\": \"Previous page\",\n\t\t\t\t\"toolbar/next\": \"Next page\",\n\t\t\t\t\"toolbar/openbook\": \"Open book\",\n\t\t\t\t\"toolbar/openbook/error\": \"Your browser does not support the required features.\\nPlease use a modern browser such as Google Chrome, or Mozilla Firefox.\",\n\t\t\t\t\"toolbar/bookmark\": \"Add this page to bookmarks\",\n\t\t\t\t\"toolbar/fullscreen\": \"Fullscreen\",\n\n\t\t\t\t\"sidebar/close\": \"Close Sidebar\",\n\t\t\t\t\"sidebar/contents\": \"Contents\",\n\t\t\t\t\"sidebar/bookmarks\": \"Bookmarks\",\n\t\t\t\t\"sidebar/bookmarks/add\": \"Add\",\n\t\t\t\t\"sidebar/bookmarks/remove\": \"Remove\",\n\t\t\t\t\"sidebar/bookmarks/clear\": \"Clear\",\n\t\t\t\t\"sidebar/annotations\": \"Annotations\",\n\t\t\t\t\"sidebar/annotations/add\": \"Add\",\n\t\t\t\t\"sidebar/annotations/remove\": \"Remove\",\n\t\t\t\t\"sidebar/annotations/clear\": \"Clear\",\n\t\t\t\t\"sidebar/annotations/anchor\": \"Anchor\",\n\t\t\t\t\"sidebar/annotations/cancel\": \"Cancel\",\n\t\t\t\t\"sidebar/search\": \"Search\",\n\t\t\t\t\"sidebar/search/placeholder\": \"Search\",\n\t\t\t\t\"sidebar/settings\": \"Settings\",\n\t\t\t\t\"sidebar/settings/language\": \"Language\",\n\t\t\t\t\"sidebar/settings/fontsize\": \"Font size (%)\",\n\t\t\t\t\"sidebar/settings/layout\": \"Layout\",\n\t\t\t\t\"sidebar/settings/pagination\": [\"Pagination\", \"Generate pagination\"],\n\t\t\t\t\"sidebar/settings/spread\": \"Spread\",\n\t\t\t\t\"sidebar/settings/spread/minwidth\": \"Minimum spread width\",\n\t\t\t\t\"sidebar/metadata\": \"Metadata\",\n\t\t\t\t\"sidebar/metadata/creator\": \"Creator\",\n\t\t\t\t\"sidebar/metadata/description\": \"Description\",\n\t\t\t\t\"sidebar/metadata/identifier\": \"Identifier\",\n\t\t\t\t\"sidebar/metadata/language\": \"Language\",\n\t\t\t\t\"sidebar/metadata/pubdate\": \"Pubdate\",\n\t\t\t\t\"sidebar/metadata/publisher\": \"Publisher\",\n\t\t\t\t\"sidebar/metadata/title\": \"Title\",\n\n\t\t\t\t\"notedlg/label\": \"Note\",\n\t\t\t\t\"notedlg/add\": \"Add\"\n\t\t\t},\n\t\t\tfr: {\n\t\t\t\t\"toolbar/sidebar\": \"Barre latérale\",\n\t\t\t\t\"toolbar/prev\": \"???\",\n\t\t\t\t\"toolbar/next\": \"???\",\n\t\t\t\t\"toolbar/openbook\": \"Ouvrir un livre local\",\n\t\t\t\t\"toolbar/openbook/error\": \"Votre navigateur ne prend pas en charge les fonctions nécessaires.\\nVeuillez utiliser un navigateur moderne tel que Google Chrome ou Mozilla Firefox.\",\n\t\t\t\t\"toolbar/bookmark\": \"Insérer un marque page ici\",\n\t\t\t\t\"toolbar/fullscreen\": \"Plein écran\",\n\n\t\t\t\t\"sidebar/close\": \"???\",\n\t\t\t\t\"sidebar/contents\": \"Sommaire\",\n\t\t\t\t\"sidebar/bookmarks\": \"Marque-pages\",\n\t\t\t\t\"sidebar/bookmarks/add\": \"Ajouter\",\n\t\t\t\t\"sidebar/bookmarks/remove\": \"Retirer\",\n\t\t\t\t\"sidebar/bookmarks/clear\": \"Tout enlever\",\n\t\t\t\t\"sidebar/annotations\": \"Annotations\",\n\t\t\t\t\"sidebar/annotations/add\": \"Ajouter\",\n\t\t\t\t\"sidebar/annotations/remove\": \"Retirer\",\n\t\t\t\t\"sidebar/annotations/clear\": \"Tout enlever\",\n\t\t\t\t\"sidebar/annotations/anchor\": \"Ancre\",\n\t\t\t\t\"sidebar/annotations/cancel\": \"Annuler\",\n\t\t\t\t\"sidebar/search\": \"Rechercher\",\n\t\t\t\t\"sidebar/search/placeholder\": \"rechercher\",\n\t\t\t\t\"sidebar/settings\": \"Réglages\",\n\t\t\t\t\"sidebar/settings/language\": \"Langue\",\n\t\t\t\t\"sidebar/settings/fontsize\": \"???\",\n\t\t\t\t\"sidebar/settings/layout\": \"???\",\n\t\t\t\t\"sidebar/settings/pagination\": [\"Pagination\", \"Établir une pagination\"],\n\t\t\t\t\"sidebar/settings/spread\": \"???\",\n\t\t\t\t\"sidebar/settings/spread/minwidth\": \"???\",\n\t\t\t\t\"sidebar/metadata\": \"???\",\n\t\t\t\t\"sidebar/metadata/creator\": \"???\",\n\t\t\t\t\"sidebar/metadata/description\": \"???\",\n\t\t\t\t\"sidebar/metadata/identifier\": \"???\",\n\t\t\t\t\"sidebar/metadata/language\": \"Langue\",\n\t\t\t\t\"sidebar/metadata/pubdate\": \"???\",\n\t\t\t\t\"sidebar/metadata/publisher\": \"???\",\n\t\t\t\t\"sidebar/metadata/title\": \"???\",\n\n\t\t\t\t\"notedlg/label\": \"???\",\n\t\t\t\t\"notedlg/add\": \"Ajouter\"\n\t\t\t},\n\t\t\tja: {\n\t\t\t\t\"toolbar/sidebar\": \"サイドバー\",\n\t\t\t\t\"toolbar/prev\": \"???\",\n\t\t\t\t\"toolbar/next\": \"???\",\n\t\t\t\t\"toolbar/openbook\": \"本を開く\",\n\t\t\t\t\"toolbar/openbook/error\": \"ご利用のブラウザは必要な機能をサポートしていません。\\nGoogle Chrome、Mozilla Firefox、その他のモダンなブラウザでご利用ください。\",\n\t\t\t\t\"toolbar/bookmark\": \"このページに栞を設定する\",\n\t\t\t\t\"toolbar/fullscreen\": \"フルスクリーン\",\n\n\t\t\t\t\"sidebar/close\": \"???\",\n\t\t\t\t\"sidebar/contents\": \"目次\",\n\t\t\t\t\"sidebar/bookmarks\": \"栞\",\n\t\t\t\t\"sidebar/bookmarks/add\": \"追加\",\n\t\t\t\t\"sidebar/bookmarks/remove\": \"削除\",\n\t\t\t\t\"sidebar/bookmarks/clear\": \"クリア\",\n\t\t\t\t\"sidebar/annotations\": \"注釈\",\n\t\t\t\t\"sidebar/annotations/add\": \"追加\",\n\t\t\t\t\"sidebar/bookmarks/remove\": \"削除\",\n\t\t\t\t\"sidebar/annotations/clear\": \"クリア\",\n\t\t\t\t\"sidebar/annotations/anchor\": \"アンカー\",\n\t\t\t\t\"sidebar/annotations/cancel\": \"キャンセル\",\n\t\t\t\t\"sidebar/search\": \"検索\",\n\t\t\t\t\"sidebar/search/placeholder\": \"検索\",\n\t\t\t\t\"sidebar/settings\": \"設定\",\n\t\t\t\t\"sidebar/settings/language\": \"表示言語\",\n\t\t\t\t\"sidebar/settings/fontsize\": \"???\",\n\t\t\t\t\"sidebar/settings/layout\": \"???\",\n\t\t\t\t\"sidebar/settings/pagination\": [\"ページネーション\", \"ページネーションを生成します。\"],\n\t\t\t\t\"sidebar/settings/spread\": \"???\",\n\t\t\t\t\"sidebar/settings/spread/minwidth\": \"???\",\n\t\t\t\t\"sidebar/metadata\": \"???\",\n\t\t\t\t\"sidebar/metadata/creator\": \"???\",\n\t\t\t\t\"sidebar/metadata/description\": \"???\",\n\t\t\t\t\"sidebar/metadata/identifier\": \"???\",\n\t\t\t\t\"sidebar/metadata/language\": \"表示言語\",\n\t\t\t\t\"sidebar/metadata/pubdate\": \"???\",\n\t\t\t\t\"sidebar/metadata/publisher\": \"???\",\n\t\t\t\t\"sidebar/metadata/title\": \"???\",\n\n\t\t\t\t\"notedlg/label\": \"???\",\n\t\t\t\t\"notedlg/add\": \"追加\"\n\t\t\t},\n\t\t\tru: {\n\t\t\t\t\"toolbar/sidebar\": \"Боковая панель\",\n\t\t\t\t\"toolbar/prev\": \"Предыдущая страница\",\n\t\t\t\t\"toolbar/next\": \"Следущая страница\",\n\t\t\t\t\"toolbar/openbook\": \"Открыть книгу\",\n\t\t\t\t\"toolbar/openbook/error\": \"Ваш браузер не поддерживает необходимые функции.\\nПожалуйста, используйте современный браузер, такой как Google Chrome или Mozilla Firefox.\",\n\t\t\t\t\"toolbar/bookmark\": \"Добавить эту страницу в закладки\",\n\t\t\t\t\"toolbar/fullscreen\": \"Полноэкранный режим\",\n\n\t\t\t\t\"sidebar/close\": \"Закрыть боковую панель\",\n\t\t\t\t\"sidebar/contents\": \"Содержание\",\n\t\t\t\t\"sidebar/bookmarks\": \"Закладки\",\n\t\t\t\t\"sidebar/bookmarks/add\": \"Добавить\",\n\t\t\t\t\"sidebar/bookmarks/remove\": \"Удалить\",\n\t\t\t\t\"sidebar/bookmarks/clear\": \"Очистить\",\n\t\t\t\t\"sidebar/annotations\": \"Аннотации\",\n\t\t\t\t\"sidebar/annotations/add\": \"Добавить\",\n\t\t\t\t\"sidebar/annotations/remove\": \"Удалить\",\n\t\t\t\t\"sidebar/annotations/clear\": \"Очистить\",\n\t\t\t\t\"sidebar/annotations/anchor\": \"Метка\",\n\t\t\t\t\"sidebar/annotations/cancel\": \"Отмена\",\n\t\t\t\t\"sidebar/search\": \"Поиск\",\n\t\t\t\t\"sidebar/search/placeholder\": \"Поиск\",\n\t\t\t\t\"sidebar/settings\": \"Настройки\",\n\t\t\t\t\"sidebar/settings/language\": \"Язык\",\n\t\t\t\t\"sidebar/settings/fontsize\": \"Размер шрифта\",\n\t\t\t\t\"sidebar/settings/layout\": \"Макет\",\n\t\t\t\t\"sidebar/settings/pagination\": [\"Нумерация страниц\", \"Генерировать нумерацию страниц\"],\n\t\t\t\t\"sidebar/settings/spread\": \"Разворот\",\n\t\t\t\t\"sidebar/settings/spread/minwidth\": \"Мин. ширина колонки\",\n\t\t\t\t\"sidebar/metadata\": \"Метаданные\",\n\t\t\t\t\"sidebar/metadata/creator\": \"Автор\",\n\t\t\t\t\"sidebar/metadata/description\": \"Описание\",\n\t\t\t\t\"sidebar/metadata/identifier\": \"Идентификатор\",\n\t\t\t\t\"sidebar/metadata/language\": \"Язык\",\n\t\t\t\t\"sidebar/metadata/pubdate\": \"Дата публикации\",\n\t\t\t\t\"sidebar/metadata/publisher\": \"Издатель\",\n\t\t\t\t\"sidebar/metadata/title\": \"Заголовок\",\n\n\t\t\t\t\"notedlg/label\": \"Заметка\",\n\t\t\t\t\"notedlg/add\": \"Добавить\"\n\t\t\t}\n\t\t};\n\n\t\treader.on(\"languagechanged\", (value) => {\n\t\t\tthis.language = value;\n\t\t});\n\t}\n\n\tget(key) { return this.values[this.language][key] || \"???\"; }\n}","/**\n * @author mrdoob https://github.com/mrdoob/ui.js\n */\n\nconst ERROR_MSG = \"is not an instance of UIElement.\";\n\n/**\n * UIElement\n * @param {string} tag\n */\nexport class UIElement {\n\t\n\tconstructor(tag) {\n\n\t\tthis.dom = document.createElement(tag); \n\t}\n\n\tadd() {\n\n\t\tfor (let i = 0; i < arguments.length; i++) {\n\n\t\t\tconst argument = arguments[i];\n\n\t\t\tif (argument instanceof UIElement) {\n\n\t\t\t\tthis.dom.appendChild(argument.dom);\n\n\t\t\t} else if (Array.isArray(argument)) {\n\n\t\t\t\tfor (let j = 0; j < argument.length; j++) {\n\n\t\t\t\t\tconst element = argument[j];\n\n\t\t\t\t\tif (element instanceof UIElement) {\n\n\t\t\t\t\t\tthis.dom.appendChild(element.dom);\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.error(\"UIElement:\", element, ERROR_MSG);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\n\t\t\t\tconsole.error(\"UIElement:\", argument, ERROR_MSG);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tremove() {\n\n\t\tfor (let i = 0; i < arguments.length; i++) {\n\n\t\t\tconst argument = arguments[i];\n\n\t\t\tif (argument instanceof UIElement) {\n\n\t\t\t\tthis.dom.removeChild(argument.dom);\n\n\t\t\t} else if (Number.isInteger(argument)) {\n\n\t\t\t\tthis.dom.removeChild(this.dom.childNodes[argument]);\n\t\t\t} else {\n\n\t\t\t\tconsole.error(\"UIElement:\", argument, ERROR_MSG);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tclear() {\n\n\t\twhile (this.dom.children.length) {\n\n\t\t\tthis.dom.removeChild(this.dom.lastChild);\n\t\t}\n\t\treturn this;\n\t}\n\n\tsetId(id) {\n\n\t\tthis.dom.id = id;\n\t\treturn this;\n\t}\n\n\tgetId() {\n\n\t\treturn this.dom.id;\n\t}\n\n\tremoveAttribute(name) {\n\n\t\tthis.dom.removeAttribute(name);\n\t\treturn this;\n\t}\n\n\tsetClass(name) {\n\n\t\tthis.dom.className = name;\n\t\treturn this;\n\t}\n\n\taddClass(name) {\n\n\t\tthis.dom.classList.add(name);\n\t\treturn this;\n\t}\n\n\tremoveClass(name) {\n\n\t\tthis.dom.classList.remove(name);\n\t\treturn this;\n\t}\n\n\tsetStyle(key, value) {\n\n\t\tthis.dom.style[key] = value;\n\t\treturn this;\n\t}\n\n\tgetTitle() {\n\n\t\treturn this.dom.title;\n\t}\n\n\tsetTitle(title) {\n\n\t\tif (this.dom.title !== title && title)\n\t\t\tthis.dom.title = title;\n\t\treturn this;\n\t}\n\n\tgetTextContent() {\n\n\t\treturn this.dom.textContent;\n\t}\n\n\tsetTextContent(text) {\n\n\t\tif (this.dom.textContent !== text && text)\n\t\t\tthis.dom.textContent = text;\n\t\treturn this;\n\t}\n\n\tgetBoundingClientRect() {\n\n\t\treturn this.dom.getBoundingClientRect();\n\t}\n}\n\n/**\n * UISpan\n * @param {string} text\n */\nexport class UISpan extends UIElement {\n\n\tconstructor(text) {\n\n\t\tsuper(\"span\");\n\t\tthis.setTextContent(text);\n\t}\n}\n\n/**\n * UIDiv\n */\nexport class UIDiv extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"div\");\n\t}\n}\n\n/**\n * UIRow\n */\nexport class UIRow extends UIDiv {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.dom.className = \"row\";\n\t}\n}\n\n/**\n * UIPanel\n */\nexport class UIPanel extends UIDiv {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.dom.className = \"panel\";\n\t}\n}\n\n/**\n * UILabel\n * @param {string} text\n * @param {string} id\n */\nexport class UILabel extends UIElement {\n\n\tconstructor(text, id) {\n\n\t\tsuper(\"label\");\n\n\t\tthis.dom.textContent = text;\n\t\tif (id) this.dom.htmlFor = id;\n\t}\n}\n\n/**\n * UILink\n * @param {string} href\n * @param {string} text\n */\nexport class UILink extends UIElement {\n\n\tconstructor(href, text) {\n\n\t\tsuper(\"a\");\n\n\t\tthis.dom.href = href || \"#\";\n\t\tthis.dom.textContent = text || \"\";\n\t}\n\n\tsetHref(url) {\n\n\t\tthis.dom.href = url;\n\t\treturn this;\n\t}\n}\n\n/**\n * UIText\n * @param {string} text\n */\nexport class UIText extends UISpan {\n\n\tconstructor(text) {\n\n\t\tsuper();\n\n\t\tthis.dom.textContent = text;\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.textContent;\n\t}\n\n\tsetValue(text) {\n\n\t\tthis.dom.textContent = text;\n\t\treturn this;\n\t}\n}\n\n/**\n * UITextArea\n */\nexport class UITextArea extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"textarea\");\n\n\t\tthis.dom.spellcheck = false;\n\t\tthis.dom.onkeydown = (e) => {\n\n\t\t\te.stopPropagation();\n\t\t};\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tsetValue(value) {\n\n\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n}\n\n/**\n * UISelect\n */\nexport class UISelect extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"select\");\n\t}\n\n\tsetMultiple(boolean) {\n\n\t\tthis.dom.multiple = boolean || false;\n\t\treturn this;\n\t}\n\n\tsetOptions(options) {\n\n\t\tconst selected = this.dom.value;\n\t\tthis.clear();\n\n\t\tfor (const key in options) {\n\n\t\t\tconst option = document.createElement(\"option\");\n\t\t\toption.value = key;\n\t\t\toption.text = options[key];\n\t\t\tthis.dom.appendChild(option);\n\t\t}\n\t\tthis.dom.value = selected;\n\t\treturn this;\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tsetValue(value) {\n\n\t\tvalue = String(value);\n\n\t\tif (this.dom.value !== value)\n\t\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n}\n\n/**\n * UIInput\n * @param {*} type\n * @param {*} value\n * @param {*} title\n */\nexport class UIInput extends UIElement {\n\n\tconstructor(type, value, title) {\n\n\t\tsuper(\"input\");\n\n\t\tthis.dom.type = type;\n\t\tthis.dom.onkeydown = (e) => {\n\n\t\t\te.stopPropagation();\n\t\t};\n\t\tthis.setValue(value);\n\t\tthis.setTitle(title);\n\t}\n\n\tgetName() {\n\n\t\treturn this.dom.name;\n\t}\n\n\tsetName(name) {\n\n\t\tthis.dom.name = name;\n\t\treturn this;\n\t}\n\n\tgetType() {\n\n\t\treturn this.dom.type;\n\t}\n\n\tsetType(type) {\n\n\t\tthis.dom.type = type;\n\t\treturn this;\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tsetValue(value) {\n\n\t\tif (this.dom.value !== value && value !== undefined)\n\t\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n}\n\n/**\n * UIColor\n */\nexport class UIColor extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"input\");\n\n\t\ttry {\n\n\t\t\tthis.dom.type = \"color\";\n\t\t\tthis.dom.value = \"#ffffff\";\n\n\t\t} catch (e) {\n\n\t\t\tconsole.exception(e);\n\t\t}\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tgetHexValue() {\n\n\t\treturn parseInt(this.dom.value.substr(1), 16);\n\t}\n\n\tsetValue(value) {\n\n\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n\n\tsetHexValue(hex) {\n\n\t\tthis.dom.value = \"#\" + (\"000000\" + hex.toString(16)).slice(-6);\n\t\treturn this;\n\t}\n}\n\n/**\n * UINumber\n * @param {number} value\n * @param {number} step\n * @param {number} min\n * @param {number} max\n * @param {number} precision\n */\nexport class UINumber extends UIElement {\n\n\tconstructor(value, step, min, max, precision) {\n\n\t\tsuper(\"input\");\n\n\t\tthis.dom.type = \"number\";\n\t\tthis.dom.step = step || 1;\n\t\tthis.dom.onkeydown = (e) => {\n\n\t\t\te.stopPropagation();\n\t\t};\n\t\tthis.value = value || 0;\n\t\tthis.min = min || -Infinity;\n\t\tthis.max = max || +Infinity;\n\t\tthis.precision = precision || 0;\n\t\tthis.setValue(value);\n\t\tthis.dom.onchange = (e) => {\n\n\t\t\tthis.setValue(this.value);\n\t\t};\n\t}\n\n\tgetName() {\n\n\t\treturn this.dom.name;\n\t}\n\n\tsetName(name) {\n\n\t\tthis.dom.name = name;\n\t\treturn this;\n\t}\n\n\tsetPrecision(precision) {\n\n\t\tthis.precision = precision;\n\t\tthis.setValue(this.value);\n\t\treturn this;\n\t}\n\n\tsetRange(min, max) {\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\t\tthis.dom.min = min;\n\t\tthis.dom.max = max;\n\t\treturn this;\n\t}\n\n\tsetStep(step) {\n\n\t\tthis.dom.step = step;\n\t\treturn this;\n\t}\n\n\tgetValue() {\n\n\t\treturn parseFloat(this.dom.value);\n\t}\n\n\tsetValue(value) {\n\n\t\tif (value !== undefined) {\n\t\t\tvalue = parseFloat(value);\n\n\t\t\tif (value < this.min)\n\t\t\t\tvalue = this.min;\n\t\t\tif (value > this.max)\n\t\t\t\tvalue = this.max;\n\n\t\t\tthis.value = value;\n\t\t\tthis.dom.value = value.toFixed(this.precision);\n\t\t}\n\t\treturn this;\n\t}\n}\n\n/**\n * UIBreak\n */\nexport class UIBreak extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"br\");\n\t}\n}\n\n/**\n * UIHorizontalRule\n */\nexport class UIHorizontalRule extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"hr\");\n\t}\n}\n\n/**\n * UIProgress\n * @param {*} value\n */\nexport class UIProgress extends UIElement {\n\n\tconstructor(value) {\n\n\t\tsuper(\"progress\");\n\n\t\tthis.dom.value = value;\n\t}\n\n\tsetValue(value) {\n\n\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n}\n\n/**\n * UITabbedPanel\n * @param {string} align (horizontal | vertical)\n */\nexport class UITabbedPanel extends UIDiv {\n\n\tconstructor(align) {\n\n\t\tsuper();\n\n\t\tthis.align = align || \"horizontal\";\n\t\tthis.tabs = [];\n\t\tthis.panels = [];\n\t\tthis.selector = new UISpan().setClass(\"tab-selector\");\n\t\tthis.menuDiv = new UIDiv().setClass(\"menu\");\n\t\tthis.tabsDiv = new UIDiv().setClass(\"tabs\");\n\t\tthis.tabsDiv.add(this.selector);\n\t\tthis.panelsDiv = new UIDiv().setClass(\"panels\");\n\t\tthis.selected = \"\";\n\t\tthis.add(this.menuDiv);\n\t\tthis.add(this.tabsDiv);\n\t\tthis.add(this.panelsDiv);\n\t}\n\n\taddMenu(items) {\n\t\tthis.menuDiv.add(items);\n\t}\n\n\taddTab(id, label, items) {\n\n\t\tconst tab = new UITab(label, this);\n\t\ttab.setId(id);\n\t\ttab.setClass(\"box\");\n\t\tthis.tabs.push(tab);\n\t\tthis.tabsDiv.add(tab);\n\n\t\tconst panel = new UIDiv();\n\t\tpanel.setId(id);\n\t\tpanel.add(items);\n\t\tthis.panels.push(panel);\n\t\tthis.panelsDiv.add(panel);\n\t\tthis.select(id);\n\t}\n\n\tselect(id) {\n\n\t\tfor (let tab of this.tabs) {\n\t\t\tif (tab.dom.id === id) {\n\t\t\t\ttab.addClass(\"selected\");\n\t\t\t\tthis.transformSelector(tab);\n\t\t\t} else if (tab.dom.id === this.selected) {\n\t\t\t\ttab.removeClass(\"selected\");\n\t\t\t}\n\t\t}\n\n\t\tfor (let panel of this.panels) {\n\t\t\tif (panel.dom.id === id) {\n\t\t\t\tpanel.dom.style.display = \"block\";\n\t\t\t} else if (panel.dom.id === this.selected) {\n\t\t\t\tpanel.dom.style.display = \"none\";\n\t\t\t}\n\t\t}\n\n\t\tthis.selected = id;\n\t\treturn this;\n\t}\n\n\tsetLabel(id, text) {\n\n\t\tfor (let tab of this.tabs) {\n\t\t\tif (tab.dom.id === id) {\n\t\t\t\ttab.setTitle(text);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\ttransformSelector(tab) {\n\n\t\tlet size;\n\t\tconst rect = tab.getBoundingClientRect();\n\t\tif (this.align === \"horizontal\") {\n\t\t\tsize = rect.width * this.tabs.indexOf(tab);\n\t\t\tthis.selector.dom.style.transform = `translateX(${size}px)`;\n\t\t} else {\n\t\t\tsize = rect.height * this.tabs.indexOf(tab);\n\t\t\tthis.selector.dom.style.transform = `translateY(${size}px)`;\n\t\t}\n\t}\n}\n\n/**\n * UITab\n * @param {string} text\n * @param {UITabbedPanel} parent\n */\nexport class UITab extends UIDiv {\n\n\tconstructor(text, parent) {\n\n\t\tsuper();\n\t\tthis.button = new UIInput(\"button\");\n\t\tthis.button.dom.title = text;\n\t\tthis.dom.onclick = (e) => {\n\n\t\t\tparent.select(this.dom.id);\n\t\t\te.preventDefault();\n\t\t};\n\t\tthis.add(this.button);\n\t}\n}\n\n/**\n * UIList\n * @param {UIItem} parent\n */\nexport class UIList extends UIElement {\n\n\tconstructor(parent) {\n\n\t\tsuper(\"ul\");\n\t\tthis.parent = parent && parent.parent; // LI->UL\n\t\tthis.expanded = false;\n\t}\n\n\texpand() {\n\n\t\tthis.expanded = true;\n\t\tthis.dom.style.display = \"block\";\n\t\tif (this.parent)\n\t\t\tthis.parent.expand();\n\t\treturn this;\n\t}\n\n\tcollaps() {\n\n\t\tthis.expanded = false;\n\t\tthis.dom.style.display = \"none\";\n\t\treturn this;\n\t}\n}\n\n/**\n * UIItem\n * @param {UIList} parent\n */\nexport class UIItem extends UIElement {\n\n\tconstructor(parent) {\n\n\t\tsuper(\"li\");\n\t\tthis.parent = parent; // UL\n\t\tthis.selected = false;\n\t}\n\n\tselect() {\n\n\t\tthis.selected = true;\n\t\tthis.setClass(\"selected\");\n\t\treturn this;\n\t}\n\n\tunselect() {\n\n\t\tthis.selected = false;\n\t\tthis.removeAttribute(\"class\");\n\t\treturn this;\n\t}\n}\n\n/**\n * UIBox\n * @param {UIElement} items\n */\nexport class UIBox extends UIElement {\n\n\tconstructor(items) {\n\n\t\tsuper(\"div\");\n\t\tthis.setClass(\"box\");\n\t\tthis.add(items);\n\t}\n}","import { UIDiv, UIInput } from \"./ui.js\";\n\nexport class Toolbar {\n\n\tconstructor(reader) {\n\n\t\tconst strings = reader.strings;\n\t\tconst settings = reader.settings;\n\n\t\tconst container = new UIDiv().setId(\"toolbar\");\n\t\tconst keys = [\n\t\t\t\"toolbar/sidebar\",\n\t\t\t\"toolbar/prev\",\n\t\t\t\"toolbar/next\",\n\t\t\t\"toolbar/openbook\",\n\t\t\t\"toolbar/openbook/error\",\n\t\t\t\"toolbar/bookmark\",\n\t\t\t\"toolbar/fullscreen\"\n\t\t];\n\t\tconst menu1 = new UIDiv().setClass(\"menu-1\");\n\t\tconst openerBox = new UIDiv().setId(\"btn-m\").setClass(\"box\");\n\t\tconst openerBtn = new UIInput(\"button\");\n\t\topenerBtn.dom.title = strings.get(keys[0]);\n\t\topenerBtn.dom.onclick = (e) => {\n\n\t\t\treader.emit(\"sidebaropener\", true);\n\t\t\te.preventDefault();\n\t\t};\n\t\topenerBox.add(openerBtn);\n\t\tmenu1.add(openerBox);\n\n\t\tlet prevBox, prevBtn;\n\t\tlet nextBox, nextBtn;\n\t\tif (settings.arrows === \"toolbar\") {\n\t\t\tprevBox = new UIDiv().setId(\"btn-p\").setClass(\"box\");\n\t\t\tprevBtn = new UIInput(\"button\");\n\t\t\tprevBtn.setTitle(strings.get(keys[1]));\n\t\t\tprevBtn.dom.onclick = (e) => {\n\n\t\t\t\treader.emit(\"prev\");\n\t\t\t\te.preventDefault();\n\t\t\t\tprevBtn.dom.blur();\n\t\t\t};\n\t\t\tprevBox.add(prevBtn);\n\t\t\tmenu1.add(prevBox);\n\n\t\t\tnextBox = new UIDiv().setId(\"btn-n\").setClass(\"box\");\n\t\t\tnextBtn = new UIInput(\"button\");\n\t\t\tnextBtn.dom.title = strings.get(keys[2]);\n\t\t\tnextBtn.dom.onclick = (e) => {\n\n\t\t\t\treader.emit(\"next\");\n\t\t\t\te.preventDefault();\n\t\t\t\tnextBtn.dom.blur();\n\t\t\t};\n\t\t\tnextBox.add(nextBtn);\n\t\t\tmenu1.add(nextBox);\n\t\t}\n\n\t\tconst menu2 = new UIDiv().setClass(\"menu-2\");\n\t\tlet openbookBtn;\n\t\tif (settings.openbook) {\n\t\t\tconst onload = (e) => {\n\n\t\t\t\tstorage.clear();\n\t\t\t\tstorage.set(e.target.result, () => {\n\t\t\t\t\treader.unload();\n\t\t\t\t\treader.init(e.target.result, { restore: true });\n\t\t\t\t\tconst url = new URL(window.location.origin);\n\t\t\t\t\twindow.history.pushState({}, \"\", url);\n\t\t\t\t});\n\t\t\t};\n\t\t\tconst onerror = (e) => {\n\t\t\t\tconsole.error(e);\n\t\t\t};\n\t\t\tconst storage = window.storage;\n\t\t\tconst openbookBox = new UIDiv().setId(\"btn-o\").setClass(\"box\");\n\t\t\topenbookBtn = new UIInput(\"file\");\n\t\t\topenbookBtn.dom.title = strings.get(keys[3]);\n\t\t\topenbookBtn.dom.accept = \"application/epub+zip\";\n\t\t\topenbookBtn.dom.onchange = (e) => {\n\n\t\t\t\tif (e.target.files.length === 0)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (window.FileReader) {\n\n\t\t\t\t\tconst fr = new FileReader();\n\t\t\t\t\tfr.onload = onload;\n\t\t\t\t\tfr.readAsArrayBuffer(e.target.files[0]);\n\t\t\t\t\tfr.onerror = onerror;\n\t\t\t\t} else {\n\t\t\t\t\talert(strings.get(keys[4]));\n\t\t\t\t}\n\n\t\t\t};\n\t\t\topenbookBtn.dom.onclick = (e) => {\n\n\t\t\t\topenbookBtn.dom.blur();\n\t\t\t};\n\t\t\topenbookBox.add(openbookBtn);\n\t\t\tmenu2.add(openbookBox);\n\t\t}\n\n\t\tlet bookmarkBox, bookmarkBtn;\n\t\tif (settings.bookmarks) {\n\t\t\tbookmarkBox = new UIDiv().setId(\"btn-b\").setClass(\"box\");\n\t\t\tbookmarkBtn = new UIInput(\"button\");\n\t\t\tbookmarkBtn.setTitle(strings.get(keys[5]));\n\t\t\tbookmarkBtn.dom.onclick = (e) => {\n\n\t\t\t\tconst cfi = this.locationCfi;\n\t\t\t\tconst val = reader.isBookmarked(cfi) === -1;\n\t\t\t\treader.emit(\"bookmarked\", val);\n\t\t\t\te.preventDefault();\n\t\t\t\tbookmarkBtn.dom.blur();\n\t\t\t};\n\t\t\tbookmarkBox.add(bookmarkBtn);\n\t\t\tmenu2.add(bookmarkBox);\n\t\t}\n\n\t\tlet fullscreenBtn;\n\t\tif (settings.fullscreen) {\n\n\t\t\tconst fullscreenBox = new UIDiv().setId(\"btn-f\").setClass(\"box\");\n\t\t\tfullscreenBtn = new UIInput(\"button\");\n\t\t\tfullscreenBtn.setTitle(strings.get(keys[6]));\n\t\t\tfullscreenBtn.dom.onclick = (e) => {\n\n\t\t\t\tthis.toggleFullScreen();\n\t\t\t\te.preventDefault();\n\t\t\t};\n\n\t\t\tdocument.onkeydown = (e) => {\n\n\t\t\t\tif (e.key === \"F11\") {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.toggleFullScreen();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tdocument.onfullscreenchange = (e) => {\n\n\t\t\t\tconst w = window.screen.width === e.target.clientWidth;\n\t\t\t\tconst h = window.screen.height === e.target.clientHeight;\n\n\t\t\t\tif (w && h) {\n\t\t\t\t\tfullscreenBox.addClass(\"resize-small\");\n\t\t\t\t} else {\n\t\t\t\t\tfullscreenBox.removeClass(\"resize-small\");\n\t\t\t\t}\n\t\t\t};\n\t\t\tfullscreenBox.add(fullscreenBtn);\n\t\t\tmenu2.add(fullscreenBox);\n\t\t}\n\n\t\tcontainer.add([menu1, menu2]);\n\t\tdocument.body.appendChild(container.dom);\n\n\t\t//-- events --//\n\n\t\treader.on(\"relocated\", (location) => {\n\n\t\t\tif (settings.bookmarks) {\n\t\t\t\tconst cfi = location.start.cfi;\n\t\t\t\tconst val = reader.isBookmarked(cfi) === -1;\n\t\t\t\tif (val) {\n\t\t\t\t\tbookmarkBox.removeClass(\"bookmarked\");\n\t\t\t\t} else {\n\t\t\t\t\tbookmarkBox.addClass(\"bookmarked\");\n\t\t\t\t}\n\t\t\t\tthis.locationCfi = cfi; // save location cfi\n\t\t\t}\n\t\t\tif (settings.arrows === \"toolbar\") {\n\t\t\t\tprevBox.dom.style.display = location.atStart ? \"none\" : \"block\";\n\t\t\t\tnextBox.dom.style.display = location.atEnd ? \"none\" : \"block\";\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"bookmarked\", (boolean) => {\n\n\t\t\tif (boolean) {\n\t\t\t\tbookmarkBox.addClass(\"bookmarked\");\n\t\t\t} else {\n\t\t\t\tbookmarkBox.removeClass(\"bookmarked\");\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"languagechanged\", (value) => {\n\n\t\t\topenerBtn.setTitle(strings.get(keys[0]));\n\n\t\t\tif (settings.arrows === \"toolbar\") {\n\t\t\t\tprevBtn.setTitle(strings.get(keys[1]));\n\t\t\t\tnextBtn.setTitle(strings.get(keys[2]));\n\t\t\t}\n\t\t\tif (settings.openbook) {\n\t\t\t\topenbookBtn.setTitle(strings.get(keys[3]));\n\t\t\t}\n\t\t\tif (settings.bookmarks) {\n\t\t\t\tbookmarkBtn.setTitle(strings.get(keys[5]));\n\t\t\t}\n\t\t\tif (settings.fullscreen) {\n\t\t\t\tfullscreenBtn.setTitle(strings.get(keys[6]));\n\t\t\t}\n\t\t});\n\t}\n\n\ttoggleFullScreen() {\n\n\t\tdocument.activeElement.blur();\n\n\t\tif (document.fullscreenElement === null) {\n\t\t\tdocument.documentElement.requestFullscreen();\n\t\t} else if (document.exitFullscreen) {\n\t\t\tdocument.exitFullscreen();\n\t\t}\n\t}\n}","import { UIDiv, UISpan } from \"./ui.js\";\n\nexport class Content {\n\n\tconstructor(reader) {\n\n\t\tconst settings = reader.settings;\n\t\tconst container = new UIDiv().setId(\"content\");\n\n\t\tlet prev;\n\t\tif (settings.arrows === \"content\") {\n\n\t\t\tprev = new UIDiv().setId(\"prev\").setClass(\"arrow\");\n\t\t\tprev.dom.onclick = (e) => {\n\n\t\t\t\treader.emit(\"prev\");\n\t\t\t\te.preventDefault();\n\t\t\t};\n\t\t\tprev.add(new UISpan(\"<\"));\n\t\t\tcontainer.add(prev);\n\t\t}\n\n\t\tconst viewer = new UIDiv().setId(\"viewer\");\n\t\tcontainer.add(viewer);\n\n\t\tlet next;\n\t\tif (settings.arrows === \"content\") {\n\t\t\tnext = new UIDiv().setId(\"next\").setClass(\"arrow\");\n\t\t\tnext.dom.onclick = (e) => {\n\n\t\t\t\treader.emit(\"next\");\n\t\t\t\te.preventDefault();\n\t\t\t};\n\t\t\tnext.add(new UISpan(\">\"));\n\t\t\tcontainer.add(next);\n\t\t}\n\n\t\tconst loader = new UIDiv().setId(\"loader\");\n\t\tconst divider = new UIDiv().setId(\"divider\");\n\n\t\tcontainer.add([divider, loader]);\n\t\tdocument.body.appendChild(container.dom);\n\n\t\t//-- events --//\n\n\t\treader.on(\"bookready\", (cfg) => {\n\n\t\t\tviewer.setClass(cfg.flow);\n\t\t\tloader.dom.style.display = \"block\";\n\t\t});\n\n\t\treader.on(\"bookloaded\", () => {\n\n\t\t\tloader.dom.style.display = \"none\";\n\t\t});\n\n\t\treader.on(\"layout\", (props) => {\n\n\t\t\tif (props.spread && props.width > props.spreadWidth) {\n\t\t\t\tdivider.dom.style.display = \"block\";\n\t\t\t} else {\n\t\t\t\tdivider.dom.style.display = \"none\";\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"flowchanged\", (value) => {\n\t\t\t\n\t\t\tviewer.setClass(value);\n\t\t});\n\n\t\treader.on(\"relocated\", (location) => {\n\n\t\t\tif (settings.arrows === \"content\") {\n\t\t\t\tif (location.atStart) {\n\t\t\t\t\tprev.addClass(\"disabled\");\n\t\t\t\t} else {\n\t\t\t\t\tprev.removeClass(\"disabled\");\n\t\t\t\t}\n\t\t\t\tif (location.atEnd) {\n\t\t\t\t\tnext.addClass(\"disabled\");\n\t\t\t\t} else {\n\t\t\t\t\tnext.removeClass(\"disabled\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"prev\", () => {\n\n\t\t\tif (settings.arrows === \"content\") {\n\t\t\t\tprev.addClass(\"active\");\n\t\t\t\tsetTimeout(() => { prev.removeClass(\"active\"); }, 100);\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"next\", () => {\n\n\t\t\tif (settings.arrows === \"content\") {\n\t\t\t\tnext.addClass(\"active\");\n\t\t\t\tsetTimeout(() => { next.removeClass(\"active\"); }, 100);\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"viewercleanup\", () => {\n\n\t\t\tviewer.clear();\n\t\t});\n\t}\n}","import { UIPanel, UIDiv, UIItem, UIList, UILink, UISpan, UIText, UIBox } from \"../ui.js\";\n\nexport class TocPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tconst container = new UIDiv().setClass(\"list-container\");\n\t\tconst strings = reader.strings;\n\t\tconst keys = [\n\t\t\t\"sidebar/contents\"\n\t\t];\n\t\tconst label = new UIText(strings.get(keys[0])).setClass(\"label\");\n\t\tthis.reader = reader;\n\t\tthis.selector = undefined; // save reference to selected tree item\n\t\tthis.setId(\"contents\");\n\t\tthis.add(new UIBox(label).addClass(\"header\"));\n\n\t\t//-- events --//\n\n\t\treader.on(\"navigation\", (toc) => {\n\n\t\t\tcontainer.clear();\n\t\t\tcontainer.add(this.generateToc(toc));\n\t\t\tthis.add(container);\n\t\t});\n\n\t\treader.on(\"languagechanged\", (value) => {\n\n\t\t\tlabel.setValue(strings.get(keys[0]));\n\t\t});\n\t}\n\n\tgenerateToc(toc, parent) {\n\n\t\tconst list = new UIList(parent);\n\n\t\ttoc.forEach((chapter) => {\n\n\t\t\tconst link = new UILink(chapter.href, chapter.label);\n\t\t\tconst item = new UIItem(list).setId(chapter.id);\n\t\t\tconst tbox = new UIDiv().setId(\"expander\");\n\n\t\t\tlink.dom.onclick = (e) => {\n\n\t\t\t\tif (this.selector && this.selector !== item)\n\t\t\t\t\tthis.selector.unselect();\n\n\t\t\t\titem.select();\n\t\t\t\tthis.selector = item;\n\t\t\t\tthis.reader.settings.sectionId = chapter.id;\n\t\t\t\tthis.reader.rendition.display(chapter.href);\n\t\t\t\te.preventDefault();\n\t\t\t};\n\t\t\titem.add([tbox, link]);\n\t\t\tthis.reader.navItems[chapter.href] = {\n\t\t\t\tid: chapter.id,\n\t\t\t\tlabel: chapter.label\n\t\t\t};\n\n\t\t\tif (this.reader.settings.sectionId === chapter.id) {\n\t\t\t\tlist.expand();\n\t\t\t\titem.select();\n\t\t\t\tthis.selector = item;\n\t\t\t}\n\n\t\t\tif (chapter.subitems && chapter.subitems.length > 0) {\n\n\t\t\t\tconst subItems = this.generateToc(chapter.subitems, item);\n\t\t\t\tconst tbtn = new UISpan().setClass(\"toggle-collapsed\");\n\t\t\t\ttbtn.dom.onclick = () => {\n\n\t\t\t\t\tif (subItems.expanded) {\n\t\t\t\t\t\tsubItems.collaps();\n\t\t\t\t\t\ttbtn.setClass(\"toggle-collapsed\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsubItems.expand();\n\t\t\t\t\t\ttbtn.setClass(\"toggle-expanded\");\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\t\t\t\ttbox.add(tbtn);\n\t\t\t\titem.add(subItems);\n\t\t\t}\n\n\t\t\tlist.add(item);\n\t\t});\n\n\t\treturn list;\n\t}\n}","import { UIPanel, UIDiv, UIRow, UIInput, UILink, UIList, UIItem, UIText, UIBox, UISpan } from \"../ui.js\";\n\nexport class BookmarksPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tconst container = new UIDiv().setClass(\"list-container\");\n\t\tconst strings = reader.strings;\n\t\tconst keys = [\n\t\t\t\"sidebar/bookmarks\",\n\t\t\t\"sidebar/bookmarks/clear\"\n\t\t];\n\t\tconst headerLabel = new UIText(strings.get(keys[0])).setClass(\"label\");\n\t\tconst clearBtn = new UIInput(\"button\", strings.get(keys[1]));\n\t\tclearBtn.dom.onclick = (e) => {\n\n\t\t\tthis.clearBookmarks();\n\t\t\treader.emit(\"bookmarked\", false);\n\t\t\te.preventDefault();\n\t\t};\n\t\tthis.add(new UIBox([headerLabel, clearBtn]).addClass(\"header\"));\n\t\tthis.selector = undefined;\n\t\tthis.bookmarks = new UIList();\n\t\tcontainer.add(this.bookmarks);\n\t\tthis.setId(\"bookmarks\");\n\t\tthis.add(container);\n\t\tthis.reader = reader;\n\n\t\tconst update = () => {\n\n\t\t\tclearBtn.dom.disabled = reader.settings.bookmarks.length === 0;\n\t\t};\n\n\t\t//-- events --//\n\n\t\treader.on(\"displayed\", (renderer, cfg) => {\n\n\t\t\tcfg.bookmarks.forEach((cfi) => {\n\n\t\t\t\tthis.setBookmark(cfi);\n\t\t\t});\n\t\t\tupdate();\n\t\t});\n\n\t\treader.on(\"relocated\", (location) => {\n\n\t\t\tthis.locationCfi = location.start.cfi; // save location cfi\n\t\t});\n\n\t\treader.on(\"bookmarked\", (boolean, cfi) => {\n\n\t\t\tif (boolean) {\n\t\t\t\tthis.appendBookmark();\n\t\t\t} else {\n\t\t\t\tthis.removeBookmark(cfi);\n\t\t\t}\n\t\t\tupdate();\n\t\t});\n\n\t\treader.on(\"languagechanged\", (value) => {\n\n\t\t\theaderLabel.setValue(strings.get(keys[0]));\n\t\t\tclearBtn.setValue(strings.get(keys[1]));\n\t\t});\n\t}\n\n\tappendBookmark() {\n\n\t\tconst cfi = this.locationCfi;\n\t\tif (this.reader.isBookmarked(cfi) > -1) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setBookmark(cfi);\n\t\tthis.reader.settings.bookmarks.push(cfi);\n\t}\n\n\tremoveBookmark(cfi) {\n\n\t\tconst _cfi = cfi || this.locationCfi;\n\t\tconst index = this.reader.isBookmarked(_cfi);\n\t\tif (index === -1) {\n\t\t\treturn;\n\t\t}\n\t\tthis.bookmarks.remove(index);\n\t\tthis.reader.settings.bookmarks.splice(index, 1);\n\t}\n\n\tclearBookmarks() {\n\n\t\tthis.bookmarks.clear();\n\t\tthis.reader.settings.bookmarks = [];\n\t}\n\n\tsetBookmark(cfi) {\n\n\t\tconst link = new UILink();\n\t\tconst item = new UIItem();\n\t\tconst btnr = new UISpan().setClass(\"btn-remove\");\n\t\tconst navItem = this.reader.navItemFromCfi(cfi);\n\t\tlet idref;\n\t\tlet label;\n\n\t\tif (navItem === undefined) {\n\t\t\tconst spineItem = this.reader.book.spine.get(cfi);\n\t\t\tidref = spineItem.idref;\n\t\t\tlabel = spineItem.idref\n\t\t} else {\n\t\t\tidref = navItem.id;\n\t\t\tlabel = navItem.label;\n\t\t}\n\n\t\tlink.setHref(\"#\" + cfi);\n\t\tlink.dom.onclick = (e) => {\n\n\t\t\tif (this.selector && this.selector !== item) {\n\t\t\t\tthis.selector.unselect();\n\t\t\t}\n\t\t\titem.select();\n\t\t\tthis.selector = item;\n\t\t\tthis.reader.rendition.display(cfi);\n\t\t\te.preventDefault();\n\t\t};\n\t\tlink.setTextContent(label);\n\n\t\tbtnr.dom.onclick = (e) => {\n\n\t\t\tthis.reader.emit(\"bookmarked\", false, cfi);\n\t\t\te.preventDefault();\n\t\t};\n\n\t\titem.add([link, btnr]);\n\t\titem.setId(idref);\n\t\tthis.bookmarks.add(item);\n\t}\n}","import { UIPanel, UIDiv, UITextArea, UIInput, UILink, UIList, UIItem, UISpan, UIText, UIBox } from \"../ui.js\";\n\nexport class AnnotationsPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tconst container = new UIDiv().setClass(\"list-container\");\n\t\tconst strings = reader.strings;\n\t\tconst keys = [\n\t\t\t\"sidebar/annotations\",\n\t\t\t\"sidebar/annotations/clear\"\n\t\t];\n\t\tconst headerLabel = new UIText(strings.get(keys[0])).setClass(\"label\");\n\t\tconst clearBtn = new UIInput(\"button\", strings.get(keys[1]));\n\t\tclearBtn.dom.onclick = (e) => {\n\n\t\t\tthis.clearNotes();\n\t\t\te.preventDefault();\n\t\t};\n\t\tthis.add(new UIBox([headerLabel, clearBtn]).addClass(\"header\"));\n\t\tthis.selector = undefined;\n\t\tthis.notes = new UIList();\n\t\tcontainer.add(this.notes);\n\t\tthis.setId(\"annotations\");\n\t\tthis.add(container);\n\t\tthis.reader = reader;\n\t\tthis.update = () => {\n\n\t\t\tclearBtn.dom.disabled = reader.settings.annotations.length === 0;\n\t\t};\n\n\t\t//-- events --//\n\n\t\treader.on(\"bookready\", (cfg) => {\n\n\t\t\tcfg.annotations.forEach((note) => {\n\n\t\t\t\tthis.set(note);\n\t\t\t});\n\t\t\tthis.update();\n\t\t});\n\n\t\treader.on(\"noteadded\", (note) => {\n\n\t\t\tthis.set(note);\n\t\t\tthis.update();\n\t\t});\n\n\t\treader.on(\"languagechanged\", (value) => {\n\n\t\t\theaderLabel.setValue(strings.get(keys[0]));\n\t\t\tclearBtn.setValue(strings.get(keys[1]));\n\t\t});\n\t}\n\n\tset(note) {\n\n\t\tconst link = new UILink(\"#\" + note.cfi, note.text);\n\t\tconst item = new UIItem().setId(\"note-\" + note.uuid);\n\t\tconst btnr = new UISpan().setClass(\"btn-remove\");\n\t\tconst call = () => { };\n\n\t\tlink.dom.onclick = (e) => {\n\n\t\t\tif (this.selector && this.selector !== item) {\n\t\t\t\tthis.selector.unselect();\n\t\t\t}\n\t\t\titem.select();\n\t\t\tthis.selector = item;\n\t\t\tthis.reader.rendition.display(note.cfi);\n\t\t\te.preventDefault();\n\t\t};\n\n\t\tbtnr.dom.onclick = (e) => {\n\n\t\t\tthis.removeNote(note);\n\t\t\te.preventDefault();\n\t\t};\n\n\t\titem.add([link, btnr]);\n\t\tthis.notes.add(item);\n\t\tthis.reader.rendition.annotations.add(\n\t\t\t\"highlight\", note.cfi, {}, call, \"note-highlight\", {});\n\t\tthis.update();\n\t}\n\n\tremoveNote(note) {\n\n\t\tconst index = this.reader.settings.annotations.indexOf(note);\n\t\tif (index === -1)\n\t\t\treturn;\n\n\t\tthis.notes.remove(index);\n\t\tthis.reader.settings.annotations.splice(index, 1);\n\t\tthis.reader.rendition.annotations.remove(note.cfi, \"highlight\");\n\t\tthis.update();\n\t}\n\n\tclearNotes() {\n\n\t\tthis.reader.settings.annotations.forEach(note => {\n\t\t\tthis.reader.rendition.annotations.remove(note.cfi, \"highlight\");\n\t\t});\n\t\tthis.notes.clear();\n\t\tthis.reader.settings.annotations = [];\n\t\tthis.update();\n\t}\n}","import { UIPanel, UIDiv, UIInput, UILink, UIList, UIItem, UIBox } from \"../ui.js\";\n\nexport class SearchPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tconst container = new UIDiv().setClass(\"list-container\");\n\t\tconst strings = reader.strings;\n\n\t\tlet searchQuery = undefined;\n\t\tconst search = new UIInput(\"search\").setId(\"nav-q\");\n\t\tsearch.dom.placeholder = strings.get(\"sidebar/search/placeholder\");\n\t\tsearch.dom.onsearch = () => {\n\n\t\t\tconst value = search.getValue();\n\n\t\t\tif (value.length === 0) {\n\t\t\t\tthis.items.clear();\n\t\t\t} else if (searchQuery !== value) {\n\t\t\t\tthis.items.clear();\n\t\t\t\tthis.doSearch(value).then(results => {\n\n\t\t\t\t\tresults.forEach(data => {\n\t\t\t\t\t\tthis.set(data);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\tsearchQuery = value;\n\t\t};\n\n\t\tthis.setId(\"search\");\n\t\tthis.items = new UIList();\n\t\tcontainer.add(this.items);\n\t\tthis.add([new UIBox(search), container]);\n\t\tthis.reader = reader;\n\t\t//\n\t\t// improvement of the highlighting of keywords is required...\n\t\t//\n\t}\n\n\t/**\n\t * Searching the entire book\n\t * @param {*} q Query keyword\n\t * @returns The search result array.\n\t */\n\tasync doSearch(q) {\n\n\t\tconst book = this.reader.book;\n\t\tconst results = await Promise.all(\n\t\t\tbook.spine.spineItems.map(item => item.load(book.load.bind(book))\n\t\t\t\t.then(item.find.bind(item, q)).finally(item.unload.bind(item))));\n\t\treturn await Promise.resolve([].concat.apply([], results));\n\t}\n\n\tset(data) {\n\n\t\tconst link = new UILink(\"#\" + data.cfi, data.excerpt);\n\t\tconst item = new UIItem();\n\t\tlink.dom.onclick = () => {\n\n\t\t\tthis.reader.rendition.display(data.cfi);\n\t\t\treturn false;\n\t\t};\n\t\titem.add(link);\n\t\tthis.items.add(item);\n\t}\n}","import { UIPanel, UIRow, UISelect, UIInput, UILabel, UINumber, UIText, UIBox, UIDiv } from \"../ui.js\";\n\nexport class SettingsPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tsuper.setId(\"settings\");\n\n\t\tconst strings = reader.strings;\n\t\tconst keys = [\n\t\t\t\"sidebar/settings\",\n\t\t\t\"sidebar/settings/language\",\n\t\t\t\"sidebar/settings/fontsize\",\n\t\t\t\"sidebar/settings/layout\",\n\t\t\t\"sidebar/settings/spread\",\n\t\t\t\"sidebar/settings/spread/minwidth\"\n\t\t];\n\t\tconst headerLabel = new UIText(strings.get(keys[0])).setClass(\"label\");\n\t\tthis.add(new UIBox(headerLabel).addClass(\"header\"));\n\n\t\tconst languageLabel = new UILabel(strings.get(keys[1]), \"language-ui\");\n\t\tconst languageRow = new UIRow();\n\t\tconst language = new UISelect().setOptions({\n\t\t\ten: \"English\",\n\t\t\tfr: \"French\",\n\t\t\tja: \"Japanese\",\n\t\t\tru: \"Russian\"\n\t\t});\n\t\tlanguage.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"languagechanged\", e.target.value);\n\t\t};\n\t\tlanguage.setId(\"language-ui\");\n\t\tlanguageRow.add(languageLabel);\n\t\tlanguageRow.add(language);\n\n\t\tconst fontSizeLabel = new UILabel(strings.get(keys[2]), \"fontsize\");\n\t\tconst fontSizeRow = new UIRow();\n\t\tconst fontSize = new UINumber(100, 1);\n\t\tfontSize.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"styleschanged\", {\n\t\t\t\tfontSize: parseInt(e.target.value)\n\t\t\t});\n\t\t};\n\t\tfontSize.setId(\"fontsize\")\n\t\tfontSizeRow.add(fontSizeLabel);\n\t\tfontSizeRow.add(fontSize);\n\n\t\t//-- layout configure --//\n\n\t\tconst layoutLabel = new UILabel(strings.get(keys[3]), \"layout\");\n\t\tconst layoutRow = new UIRow();\n\t\tconst layout = new UISelect().setOptions({\n\t\t\tpaginated: \"Paginated\",\n\t\t\tscrolled: \"Scrolled\"\n\t\t});\n\t\tlayout.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"flowchanged\", e.target.value);\n\n\t\t\tif (e.target.value === \"scrolled\") {\n\t\t\t\treader.emit(\"spreadchanged\", {\n\t\t\t\t\tmod: \"none\",\n\t\t\t\t\tmin: undefined\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treader.emit(\"spreadchanged\", {\n\t\t\t\t\tmod: undefined,\n\t\t\t\t\tmin: undefined\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tlayout.setId(\"layout\");\n\t\tlayoutRow.add(layoutLabel);\n\t\tlayoutRow.add(layout);\n\n\t\t//-- spdead configure --//\n\n\t\tconst minSpreadWidth = new UINumber(800, 1);\n\t\tconst spreadLabel = new UILabel(strings.get(keys[4]), \"spread\");\n\t\tconst spreadRow = new UIRow();\n\t\tconst spread = new UISelect().setOptions({\n\t\t\tnone: \"None\",\n\t\t\tauto: \"Auto\"\n\t\t});\n\t\tspread.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"spreadchanged\", {\n\t\t\t\tmod: e.target.value,\n\t\t\t\tmin: undefined\n\t\t\t});\n\t\t\tminSpreadWidth.dom.disabled = e.target.value === \"none\";\n\t\t};\n\t\tspread.setId(\"spread\");\n\n\t\tspreadRow.add(spreadLabel);\n\t\tspreadRow.add(spread);\n\n\t\tconst minSpreadWidthLabel = new UILabel(strings.get(keys[5]), \"min-spread-width\");\n\t\tconst minSpreadWidthRow = new UIRow();\n\t\tminSpreadWidth.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"spreadchanged\", {\n\t\t\t\tmod: undefined,\n\t\t\t\tmin: parseInt(e.target.value)\n\t\t\t});\n\t\t};\n\t\tminSpreadWidth.setId(\"min-spread-width\");\n\t\tminSpreadWidthRow.add(minSpreadWidthLabel);\n\t\tminSpreadWidthRow.add(minSpreadWidth);\n\n\t\t//-- pagination --//\n\n\t\tconst paginationStr = strings.get(\"sidebar/settings/pagination\");\n\t\tconst paginationRow = new UIRow();\n\t\tconst pagination = new UIInput(\"checkbox\", false, paginationStr[1]);\n\t\tpagination.setId(\"pagination\");\n\t\tpagination.dom.onclick = (e) => {\n\n\t\t\t// not implemented\n\t\t};\n\n\t\tpaginationRow.add(new UILabel(paginationStr[0], \"pagination\"));\n\t\tpaginationRow.add(pagination);\n\n\t\tthis.add(new UIBox([\n\t\t\tlanguageRow,\n\t\t\tfontSizeRow,\n\t\t\tlayoutRow,\n\t\t\tspreadRow,\n\t\t\tminSpreadWidthRow,\n\t\t\t//paginationRow\n\t\t]));\n\n\t\t//-- events --//\n\n\t\treader.on(\"bookready\", (cfg) => {\n\n\t\t\tlanguage.setValue(cfg.language);\n\t\t\tfontSize.setValue(cfg.styles.fontSize);\n\t\t\tlayout.setValue(cfg.flow);\n\t\t\tspread.setValue(cfg.spread.mod);\n\t\t\tminSpreadWidth.setValue(cfg.spread.min);\n\t\t\tminSpreadWidth.dom.disabled = cfg.spread.mod === \"none\";\n\t\t});\n\n\t\treader.on(\"layout\", (props) => {\n\n\t\t\tif (props.flow === \"scrolled\") {\n\t\t\t\tspread.setValue(\"none\");\n\t\t\t\tspread.dom.disabled = true;\n\t\t\t\tminSpreadWidth.dom.disabled = true;\n\t\t\t} else {\n\t\t\t\tspread.dom.disabled = false;\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"languagechanged\", (value) => {\n\n\t\t\theaderLabel.setTextContent(strings.get(keys[0]));\n\t\t\tlanguageLabel.setTextContent(strings.get(keys[1]));\n\t\t\tfontSizeLabel.setTextContent(strings.get(keys[2]));\n\t\t\tlayoutLabel.setTextContent(strings.get(keys[3]));\n\t\t\tspreadLabel.setTextContent(strings.get(keys[4]));\n\t\t\tminSpreadWidthLabel.setTextContent(strings.get(keys[5]));\n\t\t});\n\t}\n}","import { UIBox, UIDiv, UIPanel, UIRow, UIText } from \"../ui.js\";\n\nexport class MetadataPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tconst strings = reader.strings;\n\t\tconst keys = [\n\t\t\t\"sidebar/metadata\",\n\t\t\t\"sidebar/metadata/creator\",\n\t\t\t\"sidebar/metadata/description\",\n\t\t\t\"sidebar/metadata/identifier\",\n\t\t\t\"sidebar/metadata/language\",\n\t\t\t\"sidebar/metadata/pubdate\",\n\t\t\t\"sidebar/metadata/publisher\",\n\t\t\t\"sidebar/metadata/title\"\n\t\t];\n\t\tconst headerLabel = new UIText(strings.get(keys[0])).setClass(\"label\");\n\t\tthis.add(new UIBox(headerLabel).addClass(\"header\"));\n\n\t\tconst creatorLabel = new UIText(strings.get(keys[1])).setClass(\"label\");\n\t\tconst creatorValue = new UIText().setClass(\"value\");\n\t\tconst creatorRow = new UIRow();\n\t\tcreatorRow.add([creatorLabel, creatorValue]);\n\n\t\tconst descriptionLabel = new UIText(strings.get(keys[2])).setClass(\"label\");\n\t\tconst descriptionValue = new UIText().setClass(\"value\");\n\t\tconst descriptionRow = new UIRow();\n\t\tdescriptionRow.add([descriptionLabel, descriptionValue]);\n\n\t\tconst identifierLabel = new UIText(strings.get(keys[3])).setClass(\"label\");\n\t\tconst identifierValue = new UIText().setClass(\"value\");\n\t\tconst identifierRow = new UIRow();\n\t\tidentifierRow.add([identifierLabel, identifierValue]);\n\n\t\tconst languageLabel = new UIText(strings.get(keys[4])).setClass(\"label\");\n\t\tconst languageValue = new UIText().setClass(\"value\");\n\t\tconst languageRow = new UIRow();\n\t\tlanguageRow.add([languageLabel, languageValue]);\n\n\t\tconst pubdateLabel = new UIText(strings.get(keys[5])).setClass(\"label\");\n\t\tconst pubdateValue = new UIText().setClass(\"value\");\n\t\tconst pubdateRow = new UIRow();\n\t\tpubdateRow.add([pubdateLabel, pubdateValue]);\n\n\t\tconst publisherLabel = new UIText(strings.get(keys[6])).setClass(\"label\");\n\t\tconst publisherValue = new UIText().setClass(\"value\");\n\t\tconst publisherRow = new UIRow();\n\t\tpublisherRow.add([publisherLabel, publisherValue]);\n\n\t\tconst titleLabel = new UIText(strings.get(keys[7])).setClass(\"label\");\n\t\tconst titleValue = new UIText().setClass(\"value\");\n\t\tconst titleRow = new UIRow();\n\t\ttitleRow.add([titleLabel, titleValue]);\n\n\t\tthis.setId(\"metadata\");\n\t\tthis.add(new UIBox([\n\t\t\tcreatorRow,\n\t\t\tdescriptionRow,\n\t\t\tidentifierRow,\n\t\t\tlanguageRow,\n\t\t\tpubdateRow,\n\t\t\tpublisherRow,\n\t\t\ttitleRow\n\t\t]));\n\n\t\t//-- events --//\n\n\t\treader.on(\"metadata\", (meta) => {\n\n\t\t\tdocument.title = meta.title;\n\n\t\t\tif (meta.creator) {\n\t\t\t\tcreatorValue.setValue(meta.creator);\n\t\t\t\tcreatorValue.dom.title = meta.creator;\n\t\t\t} else {\n\t\t\t\tcreatorValue.setValue(\"-\");\n\t\t\t}\n\n\t\t\tif (meta.description) {\n\t\t\t\tdescriptionValue.setValue(meta.description);\n\t\t\t\tdescriptionValue.dom.title = meta.description;\n\t\t\t} else {\n\t\t\t\tdescriptionValue.setValue(\"-\");\n\t\t\t}\n\n\t\t\tif (meta.identifier) {\n\t\t\t\tidentifierValue.setValue(meta.identifier);\n\t\t\t\tidentifierValue.dom.title = meta.identifier;\n\t\t\t} else {\n\t\t\t\tidentifierValue.setValue(\"-\");\n\t\t\t}\n\n\t\t\tif (meta.language) {\n\t\t\t\tlanguageValue.setValue(meta.language);\n\t\t\t\tlanguageValue.dom.title = meta.language;\n\t\t\t} else {\n\t\t\t\tlanguageValue.setValue(\"-\");\n\t\t\t}\n\n\t\t\tif (meta.pubdate) {\n\t\t\t\tpubdateValue.setValue(meta.pubdate);\n\t\t\t\tpubdateValue.dom.title = meta.pubdate;\n\t\t\t} else {\n\t\t\t\tpubdateValue.setValue(\"-\");\n\t\t\t}\n\n\t\t\tif (meta.publisher) {\n\t\t\t\tpublisherValue.setValue(meta.publisher);\n\t\t\t\tpublisherValue.dom.title = meta.publisher;\n\t\t\t} else {\n\t\t\t\tpublisherValue.setValue(\"-\");\n\t\t\t}\n\n\t\t\tif (meta.title) {\n\t\t\t\ttitleValue.setValue(meta.title);\n\t\t\t\ttitleValue.dom.title = meta.title;\n\t\t\t} else {\n\t\t\t\ttitleValue.setValue(\"-\");\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"languagechanged\", (value) => {\n\n\t\t\theaderLabel.setValue(strings.get(keys[0]));\n\t\t\tcreatorLabel.setValue(strings.get(keys[1]));\n\t\t\tdescriptionLabel.setValue(strings.get(keys[2]));\n\t\t\tidentifierLabel.setValue(strings.get(keys[3]));\n\t\t\tlanguageLabel.setValue(strings.get(keys[4]));\n\t\t\tpubdateLabel.setValue(strings.get(keys[5]));\n\t\t\tpublisherLabel.setValue(strings.get(keys[6]));\n\t\t\ttitleLabel.setValue(strings.get(keys[7]));\n\t\t});\n\t}\n}","import { UITabbedPanel, UIInput, UIDiv } from \"./ui.js\";\nimport { TocPanel } from \"./sidebar/toc.js\";\nimport { BookmarksPanel } from \"./sidebar/bookmarks.js\";\nimport { AnnotationsPanel } from \"./sidebar/annotations.js\";\nimport { SearchPanel } from \"./sidebar/search.js\";\nimport { SettingsPanel } from \"./sidebar/settings.js\";\nimport { MetadataPanel } from \"./sidebar/metadata.js\";\n\nexport class Sidebar {\n\n\tconstructor(reader) {\n\n\t\tconst strings = reader.strings;\n\t\tconst controls = reader.settings;\n\t\tconst keys = [\n\t\t\t\"sidebar/close\",\n\t\t\t\"sidebar/contents\",\n\t\t\t\"sidebar/bookmarks\",\n\t\t\t\"sidebar/annotations\",\n\t\t\t\"sidebar/search\",\n\t\t\t\"sidebar/settings\",\n\t\t\t\"sidebar/metadata\"\n\t\t];\n\n\t\tconst container = new UITabbedPanel(\"vertical\").setId(\"sidebar\");\n\n\t\tconst openerBox = new UIDiv().setId(\"btn-p\").addClass(\"box\");\n\t\tconst openerBtn = new UIInput(\"button\");\n\t\topenerBtn.setTitle(strings.get(keys[0]));\n\t\topenerBtn.dom.onclick = (e) => {\n\n\t\t\treader.emit(\"sidebaropener\", false);\n\t\t\te.preventDefault();\n\t\t\topenerBtn.dom.blur();\n\t\t};\n\t\topenerBox.add(openerBtn);\n\t\tcontainer.addMenu(openerBox);\n\n\t\tcontainer.addTab(\"btn-t\", strings.get(keys[1]), new TocPanel(reader));\n\t\tif (controls.bookmarks) {\n\t\t\tcontainer.addTab(\"btn-d\", strings.get(keys[2]), new BookmarksPanel(reader));\n\t\t}\n\t\tif (controls.annotations) {\n\t\t\tcontainer.addTab(\"btn-a\", strings.get(keys[3]), new AnnotationsPanel(reader));\n\t\t}\n\t\tcontainer.addTab(\"btn-s\", strings.get(keys[4]), new SearchPanel(reader));\n\t\tcontainer.addTab(\"btn-c\", strings.get(keys[5]), new SettingsPanel(reader));\n\t\tcontainer.addTab(\"btn-i\", strings.get(keys[6]), new MetadataPanel(reader));\n\t\tcontainer.select(\"btn-t\");\n\n\t\tdocument.body.appendChild(container.dom);\n\n\t\t//-- events --//\n\n\t\treader.on(\"sidebaropener\", (value) => {\n\n\t\t\tif (value) {\n\t\t\t\tcontainer.setClass(\"open\");\n\t\t\t} else {\n\t\t\t\tcontainer.removeAttribute(\"class\");\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"languagechanged\", (value) => {\n\n\t\t\topenerBtn.setTitle(strings.get(keys[0]));\n\t\t\tcontainer.setLabel(\"btn-t\", strings.get(keys[1]));\n\t\t\tif (controls.bookmarks) {\n\t\t\t\tcontainer.setLabel(\"btn-d\", strings.get(keys[2]));\n\t\t\t}\n\t\t\tif (controls.annotations) {\n\t\t\t\tcontainer.setLabel(\"btn-a\", strings.get(keys[3]));\n\t\t\t}\n\t\t\tcontainer.setLabel(\"btn-s\", strings.get(keys[4]));\n\t\t\tcontainer.setLabel(\"btn-c\", strings.get(keys[5]));\n\t\t\tcontainer.setLabel(\"btn-i\", strings.get(keys[6]));\n\t\t});\n\t}\n}","import { uuid } from \"./utils.js\";\nimport { UIBox, UIDiv, UIInput, UILabel } from \"./ui.js\";\n\nexport class NoteDlg {\n\n    constructor(reader) {\n\n        const container = new UIDiv().setId(\"notedlg\");\n        const strings = reader.strings;\n        const keys = [\n            \"notedlg/label\",\n            \"notedlg/add\"\n        ];\n        const label = new UILabel(strings.get(keys[0]), \"note-input\");\n        const textBox = new UIInput(\"text\", \"\").setId(\"note-input\");\n        textBox.dom.oninput = (e) => {\n\n            this.update();\n            e.preventDefault();\n        };\n\n        const addBtn = new UIInput(\"button\", strings.get(keys[1]));\n        addBtn.dom.disabled = true;\n        addBtn.dom.onclick = (e) => {\n\n            const note = {\n                cfi: this.cfi,\n                date: new Date(),\n                text: textBox.getValue(),\n                uuid: uuid()\n            };\n            this.range = undefined;\n            reader.settings.annotations.push(note);\n            reader.emit(\"noteadded\", note);\n            container.removeAttribute(\"class\");\n            e.preventDefault();\n            addBtn.dom.blur();\n        };\n\n        this.update = () => {\n\n            addBtn.dom.disabled = !(this.range && textBox.getValue().length > 0);\n        };\n\n        container.add(new UIBox([label, textBox, addBtn]).addClass(\"control\"));\n        document.body.appendChild(container.dom);\n\n        //-- events --//\n\n        reader.on(\"selected\", (cfi, contents) => {\n\n            this.cfi = cfi;\n            this.range = contents.range(cfi);\n            this.update();\n            container.setClass(\"open\");\n            textBox.setValue(\"\");\n        });\n\n        reader.on(\"unselected\", () => {\n\n            this.range = undefined;\n            this.update();\n            container.removeAttribute(\"class\");\n        });\n\n        reader.on(\"languagechanged\", (value) => {\n\n            label.setTextContent(strings.get(keys[0]));\n            addBtn.setValue(strings.get(keys[1]));\n        });\n    }\n}","import EventEmitter from \"event-emitter\";\n\nimport { extend, detectMobile } from \"./utils.js\";\nimport { Strings } from \"./strings.js\";\nimport { Toolbar } from \"./toolbar.js\";\nimport { Content } from \"./content.js\";\nimport { Sidebar } from \"./sidebar.js\";\nimport { NoteDlg } from \"./notedlg.js\";\n\nexport class Reader {\n\n\tconstructor(bookPath, settings) {\n\n\t\tthis.settings = undefined;\n\t\tthis.isMobile = detectMobile();\n\t\tthis.cfgInit(bookPath, settings);\n\n\t\tthis.strings = new Strings(this);\n\t\tthis.toolbar = new Toolbar(this);\n\t\tthis.content = new Content(this);\n\t\tthis.sidebar = new Sidebar(this);\n\t\tif (this.settings.annotations) {\n\t\t\tthis.notedlg = new NoteDlg(this);\n\t\t}\n\n\t\tthis.book = undefined;\n\t\tthis.rendition = undefined;\n\t\tthis.displayed = undefined;\n\n\t\tthis.init();\n\n\t\twindow.onbeforeunload = this.unload.bind(this);\n\t\twindow.onhashchange = this.hashChanged.bind(this);\n\t\twindow.onkeydown = this.keyboardHandler.bind(this);\n\t\twindow.onwheel = (e) => {\n\t\t\tif (e.ctrlKey) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t};\n\t}\n\n\t/**\n\t * Initialize book.\n\t * @param {*} bookPath\n\t * @param {*} settings\n\t */\n\tinit(bookPath, settings) {\n\n\t\tthis.emit(\"viewercleanup\");\n\t\tthis.navItems = {};\n\n\t\tif (arguments.length > 0) {\n\n\t\t\tthis.cfgInit(bookPath, settings);\n\t\t}\n\n\t\tthis.book = ePub(this.settings.bookPath);\n\t\tthis.rendition = this.book.renderTo(\"viewer\", {\n\t\t\tmanager: this.isMobile ? \"continuous\" : \"default\",\n\t\t\tflow: this.settings.flow,\n\t\t\tspread: this.settings.spread.mod,\n\t\t\tminSpreadWidth: this.settings.spread.min,\n\t\t\twidth: \"100%\",\n\t\t\theight: \"100%\",\n\t\t\tsnap: true\n\t\t});\n\n\t\tconst cfi = this.settings.previousLocationCfi;\n\t\tif (cfi) {\n\t\t\tthis.displayed = this.rendition.display(cfi);\n\t\t} else {\n\t\t\tthis.displayed = this.rendition.display();\n\t\t}\n\n\t\tthis.displayed.then((renderer) => {\n\t\t\tthis.emit(\"displayed\", renderer, this.settings);\n\t\t});\n\n\t\tthis.book.ready.then(() => {\n\t\t\tthis.emit(\"bookready\", this.settings);\n\t\t}).then(() => {\n\t\t\tthis.emit(\"bookloaded\");\n\t\t});\n\n\t\tthis.book.loaded.metadata.then((meta) => {\n\t\t\tthis.emit(\"metadata\", meta);\n\t\t});\n\n\t\tthis.book.loaded.navigation.then((toc) => {\n\t\t\tthis.emit(\"navigation\", toc);\n\t\t});\n\n\t\tthis.rendition.on(\"click\", (e) => {\n\t\t\tconst selection = e.view.document.getSelection();\n\t\t\tif (selection.type !== \"Range\") {\n\t\t\t\tthis.emit(\"unselected\");\n\t\t\t}\n\t\t});\n\n\t\tthis.rendition.on(\"layout\", (props) => {\n\t\t\tthis.emit(\"layout\", props);\n\t\t});\n\n\t\tthis.rendition.on(\"selected\", (cfiRange, contents) => {\n\t\t\tthis.setLocation(cfiRange);\n\t\t\tthis.emit(\"selected\", cfiRange, contents);\n\t\t});\n\n\t\tthis.rendition.on(\"relocated\", (location) => {\n\t\t\tthis.setLocation(location.start.cfi);\n\t\t\tthis.emit(\"relocated\", location);\n\t\t});\n\n\t\tthis.rendition.on(\"keydown\", this.keyboardHandler.bind(this));\n\n\t\tthis.on(\"prev\", () => {\n\t\t\tif (this.book.package.metadata.direction === \"rtl\") {\n\t\t\t\tthis.rendition.next();\n\t\t\t} else {\n\t\t\t\tthis.rendition.prev();\n\t\t\t}\n\t\t});\n\n\t\tthis.on(\"next\", () => {\n\t\t\tif (this.book.package.metadata.direction === \"rtl\") {\n\t\t\t\tthis.rendition.prev();\n\t\t\t} else {\n\t\t\t\tthis.rendition.next();\n\t\t\t}\n\t\t});\n\n\t\tthis.on(\"languagechanged\", (value) => {\n\t\t\tthis.settings.language = value;\n\t\t});\n\n\t\tthis.on(\"flowchanged\", (value) => {\n\t\t\tthis.settings.flow = value;\n\t\t\tthis.rendition.flow(value);\n\t\t});\n\t\t\n\t\tthis.on(\"spreadchanged\", (value) => {\n\t\t\tconst mod = value.mod || this.settings.spread.mod;\n\t\t\tconst min = value.min || this.settings.spread.min;\n\t\t\tthis.settings.spread.mod = mod;\n\t\t\tthis.settings.spread.min = min;\n\t\t\tthis.rendition.spread(mod, min);\n\t\t});\n\n\t\tthis.on(\"styleschanged\", (value) => {\n\t\t\tconst fontSize = value.fontSize;\n\t\t\tthis.settings.styles.fontSize = fontSize;\n\t\t\tthis.rendition.themes.fontSize(fontSize + \"%\");\n\t\t});\n\t}\n\n\t/* ------------------------------- Common ------------------------------- */\n\n\tnavItemFromCfi(cfi) {\n\n\t\tconst range = this.rendition.getRange(cfi);\n\t\tconst idref = range.startContainer.parentNode.id;\n\t\tconst location = this.rendition.currentLocation();\n\t\tconst href = location.start.href;\n\t\treturn this.navItems[href + \"#\" + idref] || this.navItems[href];\n\t}\n\n\t/* ------------------------------ Bookmarks ----------------------------- */\n\n\t/**\n\t * Verifying the current page in bookmarks.\n\t * @param {*} cfi\n\t * @returns The index of the bookmark if it exists, or -1 otherwise.\n\t */\n\tisBookmarked(cfi) {\n\n\t\treturn this.settings.bookmarks.indexOf(cfi);\n\t}\n\n\t/* ----------------------------- Annotations ---------------------------- */\n\n\tisAnnotated(note) {\n\n\t\treturn this.settings.annotations.indexOf(note);\n\t}\n\n\t/* ------------------------------ Settings ------------------------------ */\n\n\t/**\n\t * Initialize book settings.\n\t * @param {any} bookPath\n\t * @param {any} settings\n\t */\n\tcfgInit(bookPath, settings) {\n\n\t\tthis.entryKey = md5(bookPath).toString();\n\t\tthis.settings = {\n\t\t\tbookPath: bookPath,\n\t\t\tarrows: this.isMobile ? \"none\" : \"content\", // none | content | toolbar\n\t\t\trestore: true,\n\t\t\thistory: true,\n\t\t\topenbook: true,\n\t\t\tlanguage: \"en\",\n\t\t\tsectionId: undefined,\n\t\t\tbookmarks: [],   // array | false\n\t\t\tannotations: [], // array | false\n\t\t\tflow: \"paginated\", // paginated | scrolled\n\t\t\tspread: {\n\t\t\t\tmod: \"auto\", // auto | none\n\t\t\t\tmin: 800\n\t\t\t},\n\t\t\tstyles: {\n\t\t\t\tfontSize: 100\n\t\t\t},\n\t\t\tpagination: undefined, // not implemented\n\t\t\tfullscreen: document.fullscreenEnabled\n\t\t};\n\n\t\textend(settings || {}, this.settings);\n\n\t\tif (this.settings.restore) {\n\t\t\tthis.applySavedSettings(settings || {});\n\t\t} else {\n\t\t\tthis.removeSavedSettings();\n\t\t}\n\t}\n\n\t/**\n\t * Checks if the book setting can be retrieved from localStorage.\n\t * @returns true if the book key exists, or false otherwise.\n\t */\n\tisSaved() {\n\n\t\treturn localStorage && localStorage.getItem(this.entryKey) !== null;\n\t}\n\n\t/**\n\t * Removing the current book settings from local storage.\n\t * @returns true if the book settings were deleted successfully, or false\n\t * otherwise.\n\t */\n\tremoveSavedSettings() {\n\n\t\tif (!this.isSaved())\n\t\t\treturn false;\n\n\t\tlocalStorage.removeItem(this.entryKey);\n\t\treturn true;\n\t}\n\n\t/**\n\t * Applies saved settings from local storage.\n\t * @param {*} external External settings\n\t * @returns True if the settings were applied successfully, false otherwise.\n\t */\n\tapplySavedSettings(external) {\n\n\t\tif (!this.isSaved())\n\t\t\treturn false;\n\n\t\tlet stored;\n\t\ttry {\n\t\t\tstored = JSON.parse(localStorage.getItem(this.entryKey));\n\t\t} catch (e) {\n\t\t\tconsole.exception(e);\n\t\t}\n\n\t\tif (stored) {\n\t\t\textend(stored, this.settings, external);\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Saving the current book settings in local storage.\n\t */\n\tsaveSettings() {\n\n\t\tthis.settings.previousLocationCfi = this.rendition.location.start.cfi;\n\t\tconst cfg = Object.assign({}, this.settings);\n\t\tdelete cfg.arrows;\n\t\tdelete cfg.history;\n\t\tdelete cfg.restore;\n\t\tdelete cfg.openbook;\n\t\tdelete cfg.pagination;\n\t\tdelete cfg.fullscreen;\n\t\tlocalStorage.setItem(this.entryKey, JSON.stringify(cfg));\n\t}\n\n\tsetLocation(cfi) {\n\n\t\tconst baseUrl = this.book.archived ? undefined : this.book.url;\n\t\tconst url = new URL(window.location, baseUrl);\n\t\turl.hash = \"#\" + cfi;\n\n\t\t// Update the History Location\n\t\tif (this.settings.history && window.location.hash !== url.hash) {\n\t\t\t// Add CFI fragment to the history\n\t\t\twindow.history.pushState({}, \"\", url);\n\t\t\tthis.currentLocationCfi = cfi;\n\t\t}\n\t}\n\n\t//-- event handlers --//\n\n\tunload() {\n\n\t\tif (this.settings.restore && localStorage) {\n\t\t\tthis.saveSettings();\n\t\t}\n\t}\n\n\thashChanged() {\n\n\t\tconst hash = window.location.hash.slice(1);\n\t\tthis.rendition.display(hash);\n\t}\n\n\tkeyboardHandler(e) {\n\n\t\tconst step = 2;\n\t\tlet value = this.settings.styles.fontSize;\n\n\t\tswitch (e.key) {\n\n\t\t\tcase \"=\":\n\t\t\tcase \"+\":\n\t\t\t\tvalue += step;\n\t\t\t\tthis.emit(\"styleschanged\", { fontSize: value });\n\t\t\t\tbreak;\n\t\t\tcase \"-\":\n\t\t\t\tvalue -= step;\n\t\t\t\tthis.emit(\"styleschanged\", { fontSize: value });\n\t\t\t\tbreak;\n\t\t\tcase \"0\":\n\t\t\t\tvalue = 100;\n\t\t\t\tthis.emit(\"styleschanged\", { fontSize: value });\n\t\t\t\tbreak;\n\t\t\tcase \"ArrowLeft\":\n\t\t\t\tthis.emit(\"prev\");\n\t\t\t\tbreak;\n\t\t\tcase \"ArrowRight\":\n\t\t\t\tthis.emit(\"next\");\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nEventEmitter(Reader.prototype);","export class Storage {\n\n\tconstructor() {\n\n\t\tthis.name = 'epubjs-reader';\n\t\tthis.version = 1.0;\n\t\tthis.database;\n\t\tthis.indexedDB = window.indexedDB ||\n\t\t\twindow.webkitIndexedDB ||\n\t\t\twindow.mozIndexedDB ||\n\t\t\twindow.OIndexedDB ||\n\t\t\twindow.msIndexedDB;\n\n\t\tif (this.indexedDB === undefined) {\n\n\t\t\talert('The IndexedDB API not available in your browser.');\n\t\t}\n\t}\n\n\tinit(callback) {\n\n\t\tif (this.indexedDB === undefined) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\n\t\tconst scope = this;\n\t\tconst request = indexedDB.open(this.name, this.version);\n\t\trequest.onupgradeneeded = function (event) {\n\n\t\t\tconst db = event.target.result;\n\t\t\tif (db.objectStoreNames.contains('entries') === false) {\n\n\t\t\t\tdb.createObjectStore(\"entries\");\n\t\t\t}\n\t\t};\n\n\t\trequest.onsuccess = function (event) {\n\n\t\t\tscope.database = event.target.result;\n\t\t\tscope.database.onerror = function (event) {\n\n\t\t\t\tconsole.error('IndexedDB', event);\n\t\t\t};\n\t\t\tcallback();\n\t\t}\n\n\t\trequest.onerror = function (event) {\n\n\t\t\tconsole.error('IndexedDB', event);\n\t\t};\n\t}\n\n\tget(callback) {\n\n\t\tif (this.database === undefined) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\n\t\tconst transaction = this.database.transaction(['entries'], 'readwrite');\n\t\tconst objectStore = transaction.objectStore('entries');\n\t\tconst request = objectStore.get(0);\n\t\trequest.onsuccess = function (event) {\n\n\t\t\tcallback(event.target.result);\n\t\t\tconsole.log('storage.get');\n\t\t};\n\t}\n\n\tset(data, callback) {\n\n\t\tif (this.database === undefined) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\n\t\tconst transaction = this.database.transaction(['entries'], 'readwrite');\n\t\tconst objectStore = transaction.objectStore('entries');\n\t\tconst request = objectStore.put(data, 0);\n\t\trequest.onsuccess = function () {\n\n\t\t\tcallback();\n\t\t\tconsole.log('storage.set');\n\t\t};\n\t}\n\n\tclear() {\n\n\t\tif (this.database === undefined)\n\t\t\treturn;\n\n\t\tconst transaction = this.database.transaction(['entries'], 'readwrite');\n\t\tconst objectStore = transaction.objectStore('entries');\n\t\tconst request = objectStore.clear();\n\t\trequest.onsuccess = function () {\n\n\t\t\tconsole.log('storage.clear');\n\t\t};\n\t}\n}\n","import { Reader } from \"./reader.js\";\nimport { Storage } from \"./storage.js\";\n\n\"use strict\";\n\nwindow.ResizeObserver = undefined;\nwindow.onload = function () {\n\n\tconst storage = new Storage();\n\tconst url = new URL(window.location);\n\tconst path = (window.bookPath !== undefined)\n\t\t? window.bookPath\n\t\t: ((url.search.length > 0) ? url.searchParams.get(\"bookPath\") : \"https://s3.amazonaws.com/moby-dick/\");\n\n\tstorage.init(function () {\n\n\t\tstorage.get(function (data) {\n\n\t\t\tif (data !== undefined && url.search.length === 0) {\n\n\t\t\t\twindow.reader = new Reader(data);\n\n\t\t\t} else {\n\n\t\t\t\twindow.reader = new Reader(path);\n\t\t\t}\n\t\t});\n\t});\n\n\twindow.storage = storage;\n};\n\nexport const main = (path, options) => new Reader(path, options || {});\n"],"names":["isValue","isPlainFunction","assign","normalizeOpts","contains","module","exports","dscr","value","c","e","w","options","desc","arguments","length","call","configurable","enumerable","writable","gs","get","set","undefined","Object","obj","foo","bar","trzy","keys","max","Math","dest","src","error","i","key","forEach","_undefined","val","object","Array","prototype","create","opts1","result","process","fn","TypeError","String","str","indexOf","searchString","this","on","once","off","emit","methods","descriptors","base","d","callable","apply","Function","defineProperty","defineProperties","hasOwnProperty","descriptor","type","listener","self","__eeOnceListener__","data","__ee__","push","listeners","candidate","splice","l","args","slice","o","isPrototype","possibleTypes","isFunction","classRe","functionToString","toString","test","isObject","constructor","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","a","definition","prop","r","Symbol","toStringTag","q","dst","ext","extend","uuid","Date","getTime","replace","random","floor","Strings","reader","language","settings","values","en","fr","ja","ru","ERROR_MSG","UIElement","tag","dom","document","createElement","add","argument","appendChild","isArray","j","element","console","remove","removeChild","Number","isInteger","childNodes","clear","children","lastChild","setId","id","getId","removeAttribute","name","setClass","className","addClass","classList","removeClass","setStyle","style","getTitle","title","setTitle","getTextContent","textContent","setTextContent","text","getBoundingClientRect","UISpan","super","UIDiv","UIRow","UIPanel","UILabel","htmlFor","UILink","href","setHref","url","UIText","getValue","setValue","UISelect","setMultiple","boolean","multiple","setOptions","selected","option","UIInput","onkeydown","stopPropagation","getName","setName","getType","setType","UINumber","step","min","precision","onchange","setPrecision","setRange","setStep","parseFloat","toFixed","UITabbedPanel","align","tabs","panels","selector","menuDiv","tabsDiv","panelsDiv","addMenu","items","addTab","label","tab","UITab","panel","select","transformSelector","display","setLabel","size","rect","width","transform","height","parent","button","onclick","preventDefault","UIList","expanded","expand","collaps","UIItem","unselect","UIBox","Toolbar","strings","container","menu1","openerBox","openerBtn","prevBox","prevBtn","nextBox","nextBtn","arrows","blur","menu2","openbookBtn","bookmarkBox","bookmarkBtn","fullscreenBtn","openbook","onload","storage","target","unload","init","restore","URL","window","location","origin","history","pushState","onerror","openbookBox","accept","files","FileReader","readAsArrayBuffer","alert","bookmarks","cfi","locationCfi","isBookmarked","fullscreen","fullscreenBox","toggleFullScreen","onfullscreenchange","screen","clientWidth","h","clientHeight","body","start","atStart","atEnd","activeElement","fullscreenElement","documentElement","requestFullscreen","exitFullscreen","Content","prev","viewer","next","loader","divider","cfg","flow","props","spread","spreadWidth","setTimeout","TocPanel","toc","generateToc","list","chapter","link","item","tbox","sectionId","rendition","navItems","subitems","subItems","tbtn","BookmarksPanel","headerLabel","clearBtn","clearBookmarks","update","disabled","renderer","setBookmark","appendBookmark","removeBookmark","_cfi","index","btnr","navItem","navItemFromCfi","idref","spineItem","book","spine","AnnotationsPanel","clearNotes","notes","annotations","note","removeNote","SearchPanel","searchQuery","search","placeholder","onsearch","doSearch","then","results","Promise","all","spineItems","map","load","bind","find","finally","resolve","concat","excerpt","SettingsPanel","languageLabel","languageRow","fontSizeLabel","fontSizeRow","fontSize","parseInt","layoutLabel","layoutRow","layout","paginated","scrolled","mod","minSpreadWidth","spreadLabel","spreadRow","none","auto","minSpreadWidthLabel","minSpreadWidthRow","paginationStr","paginationRow","pagination","styles","MetadataPanel","creatorLabel","creatorValue","creatorRow","descriptionLabel","descriptionValue","descriptionRow","identifierLabel","identifierValue","identifierRow","languageValue","pubdateLabel","pubdateValue","pubdateRow","publisherLabel","publisherValue","publisherRow","titleLabel","titleValue","titleRow","meta","creator","description","identifier","pubdate","publisher","Sidebar","controls","NoteDlg","textBox","oninput","addBtn","date","range","contents","Reader","bookPath","isMobile","some","navigator","userAgent","match","cfgInit","toolbar","content","sidebar","notedlg","displayed","onbeforeunload","onhashchange","hashChanged","keyboardHandler","onwheel","ctrlKey","ePub","renderTo","manager","snap","previousLocationCfi","ready","loaded","metadata","navigation","view","getSelection","cfiRange","setLocation","package","direction","themes","getRange","startContainer","parentNode","currentLocation","isAnnotated","entryKey","md5","fullscreenEnabled","applySavedSettings","removeSavedSettings","isSaved","localStorage","getItem","removeItem","external","stored","JSON","parse","exception","saveSettings","setItem","stringify","baseUrl","archived","hash","currentLocationCfi","Storage","version","database","indexedDB","webkitIndexedDB","mozIndexedDB","OIndexedDB","msIndexedDB","callback","scope","request","open","onupgradeneeded","event","db","objectStoreNames","createObjectStore","onsuccess","transaction","objectStore","log","put","ResizeObserver","path","searchParams","main"],"sourceRoot":""}